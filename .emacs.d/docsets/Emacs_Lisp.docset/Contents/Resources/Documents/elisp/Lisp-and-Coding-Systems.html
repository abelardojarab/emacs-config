<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rev="made" href="mailto:webmasters@gnu.org">
<link rel="icon" type="image/png" href="/graphics/gnu-head-mini.png">
<meta name="ICBM" content="42.256233,-71.006581">
<meta name="DC.title" content="gnu.org">

<title>Lisp and Coding Systems</title>
<!--
This is the `GNU Emacs Lisp Reference Manual'
corresponding to Emacs version 24.4.

Copyright (C) 1990--1996, 1998--2014 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with the Invariant Sections being ``GNU General Public
     License,'' with the Front-Cover Texts being ``A GNU Manual,'' and
     with the Back-Cover Texts as in (a) below.  A copy of the license
     is included in the section entitled ``GNU Free Documentation
     License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<style type="text/css">
@import url('/software/emacs/manual.css');
</style>
</head>
<body>
<div class="node" style="background-color:#DDDDFF">
<a name="Lisp-and-Coding-Systems"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="User_002dChosen-Coding-Systems.html#User_002dChosen-Coding-Systems">User-Chosen Coding Systems</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Encoding-and-I_002fO.html#Encoding-and-I_002fO">Encoding and I/O</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Coding-Systems.html#Coding-Systems">Coding Systems</a>

</p></div>

<h4 class="subsection">32.10.3 Coding Systems in Lisp</h4>

<p>Here are the Lisp facilities for working with coding systems:

   </p><p><a name="index-list-all-coding-systems-3269"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Dlist"></a><a name="DASH-1186"></a>— Function: <b>coding-system-list</b><var> &amp;optional base-only<a name="index-coding_002dsystem_002dlist-3270"></a></var><br>
<blockquote><p>This function returns a list of all coding system names (symbols).  If
<var>base-only</var> is non-<code>nil</code>, the value includes only the
base coding systems.  Otherwise, it includes alias and variant coding
systems as well. 
</p></blockquote></div>

<div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Dp"></a><a name="DASH-1187"></a>— Function: <b>coding-system-p</b><var> object<a name="index-coding_002dsystem_002dp-3271"></a></var><br>
<blockquote><p>This function returns <code>t</code> if <var>object</var> is a coding system
name or <code>nil</code>. 
</p></blockquote></div>

   <p><a name="index-validity-of-coding-system-3272"></a><a name="index-coding-system_002c-validity-check-3273"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/check%2Dcoding%2Dsystem"></a><a name="DASH-1188"></a>— Function: <b>check-coding-system</b><var> coding-system<a name="index-check_002dcoding_002dsystem-3274"></a></var><br>
<blockquote><p>This function checks the validity of <var>coding-system</var>.  If that is
valid, it returns <var>coding-system</var>.  If <var>coding-system</var> is
<code>nil</code>, the function return <code>nil</code>.  For any other values, it
signals an error whose <code>error-symbol</code> is <code>coding-system-error</code>
(see <a href="Signaling-Errors.html#Signaling-Errors">signal</a>). 
</p></blockquote></div>

   <p><a name="index-eol-type-of-coding-system-3275"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Deol%2Dtype"></a><a name="DASH-1189"></a>— Function: <b>coding-system-eol-type</b><var> coding-system<a name="index-coding_002dsystem_002deol_002dtype-3276"></a></var><br>
<blockquote><p>This function returns the type of end-of-line (a.k.a. <dfn>eol</dfn>)
conversion used by <var>coding-system</var>.  If <var>coding-system</var>
specifies a certain eol conversion, the return value is an integer 0,
1, or 2, standing for <code>unix</code>, <code>dos</code>, and <code>mac</code>,
respectively.  If <var>coding-system</var> doesn't specify eol conversion
explicitly, the return value is a vector of coding systems, each one
with one of the possible eol conversion types, like this:

     </p><pre class="lisp">          (coding-system-eol-type 'latin-1)
               ⇒ [latin-1-unix latin-1-dos latin-1-mac]
</pre>
        <p class="noindent">If this function returns a vector, Emacs will decide, as part of the
text encoding or decoding process, what eol conversion to use.  For
decoding, the end-of-line format of the text is auto-detected, and the
eol conversion is set to match it (e.g., DOS-style CRLF format will
imply <code>dos</code> eol conversion).  For encoding, the eol conversion is
taken from the appropriate default coding system (e.g.,
default value of <code>buffer-file-coding-system</code> for
<code>buffer-file-coding-system</code>), or from the default eol conversion
appropriate for the underlying platform. 
</p></blockquote></div>

   <p><a name="index-eol-conversion-of-coding-system-3277"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Dchange%2Deol%2Dconversion"></a><a name="DASH-1190"></a>— Function: <b>coding-system-change-eol-conversion</b><var> coding-system eol-type<a name="index-coding_002dsystem_002dchange_002deol_002dconversion-3278"></a></var><br>
<blockquote><p>This function returns a coding system which is like <var>coding-system</var>
except for its eol conversion, which is specified by <code>eol-type</code>. 
<var>eol-type</var> should be <code>unix</code>, <code>dos</code>, <code>mac</code>, or
<code>nil</code>.  If it is <code>nil</code>, the returned coding system determines
the end-of-line conversion from the data.

        </p><p><var>eol-type</var> may also be 0, 1 or 2, standing for <code>unix</code>,
<code>dos</code> and <code>mac</code>, respectively. 
</p></blockquote></div>

   <p><a name="index-text-conversion-of-coding-system-3279"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Dchange%2Dtext%2Dconversion"></a><a name="DASH-1191"></a>— Function: <b>coding-system-change-text-conversion</b><var> eol-coding text-coding<a name="index-coding_002dsystem_002dchange_002dtext_002dconversion-3280"></a></var><br>
<blockquote><p>This function returns a coding system which uses the end-of-line
conversion of <var>eol-coding</var>, and the text conversion of
<var>text-coding</var>.  If <var>text-coding</var> is <code>nil</code>, it returns
<code>undecided</code>, or one of its variants according to <var>eol-coding</var>. 
</p></blockquote></div>

   <p><a name="index-safely-encode-region-3281"></a><a name="index-coding-systems-for-encoding-region-3282"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/find%2Dcoding%2Dsystems%2Dregion"></a><a name="DASH-1192"></a>— Function: <b>find-coding-systems-region</b><var> from to<a name="index-find_002dcoding_002dsystems_002dregion-3283"></a></var><br>
<blockquote><p>This function returns a list of coding systems that could be used to
encode a text between <var>from</var> and <var>to</var>.  All coding systems in
the list can safely encode any multibyte characters in that portion of
the text.

        </p><p>If the text contains no multibyte characters, the function returns the
list <code>(undecided)</code>. 
</p></blockquote></div>

   <p><a name="index-safely-encode-a-string-3284"></a><a name="index-coding-systems-for-encoding-a-string-3285"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/find%2Dcoding%2Dsystems%2Dstring"></a><a name="DASH-1193"></a>— Function: <b>find-coding-systems-string</b><var> string<a name="index-find_002dcoding_002dsystems_002dstring-3286"></a></var><br>
<blockquote><p>This function returns a list of coding systems that could be used to
encode the text of <var>string</var>.  All coding systems in the list can
safely encode any multibyte characters in <var>string</var>.  If the text
contains no multibyte characters, this returns the list
<code>(undecided)</code>. 
</p></blockquote></div>

   <p><a name="index-charset_002c-coding-systems-to-encode-3287"></a><a name="index-safely-encode-characters-in-a-charset-3288"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/find%2Dcoding%2Dsystems%2Dfor%2Dcharsets"></a><a name="DASH-1194"></a>— Function: <b>find-coding-systems-for-charsets</b><var> charsets<a name="index-find_002dcoding_002dsystems_002dfor_002dcharsets-3289"></a></var><br>
<blockquote><p>This function returns a list of coding systems that could be used to
encode all the character sets in the list <var>charsets</var>. 
</p></blockquote></div>

<div class="defun">
<a class="dashAnchor" name="//apple_ref/func/check%2Dcoding%2Dsystems%2Dregion"></a><a name="DASH-1195"></a>— Function: <b>check-coding-systems-region</b><var> start end coding-system-list<a name="index-check_002dcoding_002dsystems_002dregion-3290"></a></var><br>
<blockquote><p>This function checks whether coding systems in the list
<code>coding-system-list</code> can encode all the characters in the region
between <var>start</var> and <var>end</var>.  If all of the coding systems in
the list can encode the specified text, the function returns
<code>nil</code>.  If some coding systems cannot encode some of the
characters, the value is an alist, each element of which has the form
<code>(</code><var>coding-system1</var> <var>pos1</var> <var>pos2</var><code> ...)</code>, meaning
that <var>coding-system1</var> cannot encode characters at buffer positions
<var>pos1</var>, <var>pos2</var>, <small class="enddots">...</small>.

        </p><p><var>start</var> may be a string, in which case <var>end</var> is ignored and
the returned value references string indices instead of buffer
positions. 
</p></blockquote></div>

<div class="defun">
<a class="dashAnchor" name="//apple_ref/func/detect%2Dcoding%2Dregion"></a><a name="DASH-1196"></a>— Function: <b>detect-coding-region</b><var> start end &amp;optional highest<a name="index-detect_002dcoding_002dregion-3291"></a></var><br>
<blockquote><p>This function chooses a plausible coding system for decoding the text
from <var>start</var> to <var>end</var>.  This text should be a byte sequence,
i.e., unibyte text or multibyte text with only <acronym>ASCII</acronym> and
eight-bit characters (see <a href="Explicit-Encoding.html#Explicit-Encoding">Explicit Encoding</a>).

        </p><p>Normally this function returns a list of coding systems that could
handle decoding the text that was scanned.  They are listed in order of
decreasing priority.  But if <var>highest</var> is non-<code>nil</code>, then the
return value is just one coding system, the one that is highest in
priority.

        </p><p>If the region contains only <acronym>ASCII</acronym> characters except for such
ISO-2022 control characters ISO-2022 as <code>ESC</code>, the value is
<code>undecided</code> or <code>(undecided)</code>, or a variant specifying
end-of-line conversion, if that can be deduced from the text.

        </p><p>If the region contains null bytes, the value is <code>no-conversion</code>,
even if the region contains text encoded in some coding system. 
</p></blockquote></div>

<div class="defun">
<a class="dashAnchor" name="//apple_ref/func/detect%2Dcoding%2Dstring"></a><a name="DASH-1197"></a>— Function: <b>detect-coding-string</b><var> string &amp;optional highest<a name="index-detect_002dcoding_002dstring-3292"></a></var><br>
<blockquote><p>This function is like <code>detect-coding-region</code> except that it
operates on the contents of <var>string</var> instead of bytes in the buffer. 
</p></blockquote></div>

   <p><a name="index-null-bytes_002c-and-decoding-text-3293"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/Variable/inhibit%2Dnull%2Dbyte%2Ddetection"></a><a name="DASH-1198"></a>— Variable: <b>inhibit-null-byte-detection</b><var><a name="index-inhibit_002dnull_002dbyte_002ddetection-3294"></a></var><br>
<blockquote><p>If this variable has a non-<code>nil</code> value, null bytes are ignored
when detecting the encoding of a region or a string.  This allows to
correctly detect the encoding of text that contains null bytes, such
as Info files with Index nodes. 
</p></blockquote></div>

<div class="defun">
<a class="dashAnchor" name="//apple_ref/Variable/inhibit%2Diso%2Descape%2Ddetection"></a><a name="DASH-1199"></a>— Variable: <b>inhibit-iso-escape-detection</b><var><a name="index-inhibit_002diso_002descape_002ddetection-3295"></a></var><br>
<blockquote><p>If this variable has a non-<code>nil</code> value, ISO-2022 escape sequences
are ignored when detecting the encoding of a region or a string.  The
result is that no text is ever detected as encoded in some ISO-2022
encoding, and all escape sequences become visible in a buffer. 
<strong>Warning:</strong> <em>Use this variable with extreme caution,
because many files in the Emacs distribution use ISO-2022 encoding.</em>
</p></blockquote></div>

   <p><a name="index-charsets-supported-by-a-coding-system-3296"></a>

</p><div class="defun">
<a class="dashAnchor" name="//apple_ref/func/coding%2Dsystem%2Dcharset%2Dlist"></a><a name="DASH-1200"></a>— Function: <b>coding-system-charset-list</b><var> coding-system<a name="index-coding_002dsystem_002dcharset_002dlist-3297"></a></var><br>
<blockquote><p>This function returns the list of character sets (see <a href="Character-Sets.html#Character-Sets">Character Sets</a>) supported by <var>coding-system</var>.  Some coding systems that
support too many character sets to list them all yield special values:
          </p><ul>
<li>If <var>coding-system</var> supports all Emacs characters, the value is
<code>(emacs)</code>. 
</li><li>If <var>coding-system</var> supports all Unicode characters, the value is
<code>(unicode)</code>. 
</li><li>If <var>coding-system</var> supports all ISO-2022 charsets, the value is
<code>iso-2022</code>. 
</li><li>If <var>coding-system</var> supports all the characters in the internal
coding system used by Emacs version 21 (prior to the implementation of
internal Unicode support), the value is <code>emacs-mule</code>. 
</li></ul>
        <p></p></blockquote></div>

   <p>See <a href="Coding-systems-for-a-subprocess.html#Coding-systems-for-a-subprocess">Process Information</a>, in
particular the description of the functions
<code>process-coding-system</code> and <code>set-process-coding-system</code>, for
how to examine or set the coding systems used for I/O to a subprocess.

   

</p></body></html>