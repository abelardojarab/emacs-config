<!DOCTYPE html>
<html>

<!-- Mirrored from lxr.mozilla.org/mozilla/source/toolkit/components/exthelper/extApplication.js by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 May 2016 20:00:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta name="GENERATOR" content="lxr-1998-06-10: http://lxr.linux.no">
<link rel="icon" href="../../../../../mxr.png" type="image/png">
<title>mozilla mozilla/toolkit/components/exthelper/extApplication.js</title>
<link rel='stylesheet' title='' href='../../../../../../mxr.mozilla.org/mozilla/style/style.css' type='text/css'>
<link rel='alternate stylesheet' title='Alt-1' href='../../../../../../mxr.mozilla.org/mozilla/style/alt1-js.css' type='text/css'>

<script src='../../../../../../mxr.mozilla.org/coloration.js'></script>
<script src='../../../../../../mxr.mozilla.org/script.js'></script>
</head>

<body   bgcolor="#FFFFFF" text="#000000"
	link="#0000EE" vlink="#551A8B" alink="#FF0000">

<table class=banner bgcolor="#000000" width="100%" border=0 cellpadding=0 cellspacing=0>
<tr><td><a class="logo" href="http://www.mozilla.org/"><img
 src="../../../../../../www.mozilla.org/images/mozilla-banner.gif" alt=""
 border=0 width=600 height=58></a></td></tr></table>

<table class=header border=0 cellpadding=12 cellspacing=0 width="100%">
 <tr>
  <td align=left valign=middle>
   <nobr><font size="+2"><b><a href="http://mxr.mozilla.org/">Mozilla Cross-Reference</a></b>
</nobr><i><a href="http://mxr.mozilla.org/mozilla">mozilla</a></i>
</font>
   <br><b><a href="http://lxr.mozilla.org/mozilla/source/">mozilla</a>/ <a href="http://lxr.mozilla.org/mozilla/source/toolkit/">toolkit</a>/ <a href="http://lxr.mozilla.org/mozilla/source/toolkit/components/">components</a>/ <a href="http://lxr.mozilla.org/mozilla/source/toolkit/components/exthelper/">exthelper</a>/ <a href="extApplication.html">extApplication.js</a> </b>
  </TD>

  <td align=right valign=top width="1%">
   <table border cellpadding=12 cellspacing=0>
    <tr>
     <td nowrap bgcolor="#FAFAFA">

      <a href="http://bonsai.mozilla.org/cvslog.cgi?file=mozilla/toolkit/components/exthelper/extApplication.js&amp;rev=HEAD&amp;mark=1.3"
>CVS Log</a><br>
      <a href="http://bonsai.mozilla.org/cvsblame.cgi?file=mozilla/toolkit/components/exthelper/extApplication.js&amp;rev=1.3"
onfocus='updateBonsaiBlameHash(this, event)'
onmouseover='updateBonsaiBlameHash(this, event)'
>CVS Blame</a><br>
      <a href="http://bonsai.mozilla.org/cvsgraph.cgi?file=mozilla/toolkit/components/exthelper/extApplication.js&amp;rev=1.3"
>CVS Graph</a><br>

      <a href="../../../../../../mxr.mozilla.org/mozilla/diffd8c7.html?file=/toolkit/components/exthelper/extApplication.js">Diff file</a><br>
      <a href="../../../../../../mxr.mozilla.org/mozilla/source/toolkit/components/exthelper/extApplication2af1.js?raw=1">Raw file</a><br>
     </TD>
    </TR>
   </table>
  </TD>

  <td align=right valign=top width="1%">
   <table border cellpadding=6 cellspacing=0>
    <tr>
     <td bgcolor="#FAFAFA">
      <table border=0 cellpadding=6 cellspacing=0>
       <tr>
        <td nowrap align=left>
         changes to<br>this file in<br>the last:
        </TD>
        <td nowrap>
         <a href="http://bonsai.mozilla.org/cvsquery.cgi?branch=HEAD&amp;file=mozilla/toolkit/components/exthelper/extApplication.js&amp;date=day">day</a><br>
         <a href="http://bonsai.mozilla.org/cvsquery.cgi?branch=HEAD&amp;file=mozilla/toolkit/components/exthelper/extApplication.js&amp;date=week">week</a><br>
         <a href="http://bonsai.mozilla.org/cvsquery.cgi?branch=HEAD&amp;file=mozilla/toolkit/components/exthelper/extApplication.js&amp;date=month">month</a><br>
        </TD>
       </TR>
      </table>
     </TD>
    </TR>
   </table>
  </TD>

 </TR>
</table>

<form name='source' id='source' class='beforecontent'
>view using tree:
<select name='tree' id='tree' onchange='changetarget("http://mxr.mozilla.org/mozilla/", "http://lxr.mozilla.org/mozilla/source/toolkit/components/exthelper/mozilla/")'>
<option value="classic">classic</option>
<option value="firefox">firefox</option>
<option value="js">js</option>
<option value="mozilla" selected=1>mozilla</option>
<option value="mozilla-aurora">mozilla-aurora</option>
<option value="mozilla-b2g28_v1_3">mozilla-b2g28_v1_3</option>
<option value="mozilla-b2g28_v1_3t">mozilla-b2g28_v1_3t</option>
<option value="mozilla-b2g30_v1_4">mozilla-b2g30_v1_4</option>
<option value="mozilla-b2g32_v2_0">mozilla-b2g32_v2_0</option>
<option value="mozilla-b2g34_v2_1">mozilla-b2g34_v2_1</option>
<option value="mozilla-b2g37_v2_2">mozilla-b2g37_v2_2</option>
<option value="mozilla-beta">mozilla-beta</option>
<option value="mozilla-central">mozilla-central</option>
<option value="mozilla-esr10">mozilla-esr10</option>
<option value="mozilla-esr17">mozilla-esr17</option>
<option value="mozilla-esr24">mozilla-esr24</option>
<option value="mozilla-esr31">mozilla-esr31</option>
<option value="mozilla-esr38">mozilla-esr38</option>
<option value="mozilla-esr45">mozilla-esr45</option>
<option value="mozilla-release">mozilla-release</option>
<option value="mozilla1.9.1">mozilla1.9.1</option>
<option value="mozilla1.9.2">mozilla1.9.2</option>
<option value="mozilla2.0">mozilla2.0</option>
<option value="nspr-cvs">nspr-cvs</option>
<option value="seamonkey">seamonkey</option>
<option value="security">security</option>

</select></form>

<pre lang='en'><style>.d2:before{content:' '} .d1:before{content:'  '} .d0:before{content:'   '} </style><span id='the-code'><a class='l d0' name=1 href="#1">1</a> <span class='c'>/* ***** BEGIN LICENSE BLOCK *****</span>
<a class='l d0' name=2 href="#2">2</a> <span class='c'> * Version: MPL 1.1/GPL 2.0/LGPL 2.1</span>
<a class='l d0' name=3 href="#3">3</a> <span class='c'> *</span>
<a class='l d0' name=4 href="#4">4</a> <span class='c'> * The contents of this file are subject to the Mozilla Public License Version</span>
<a class='l d0' name=5 href="#5">5</a> <span class='c'> * 1.1 (the "License"); you may not use this file except in compliance with</span>
<a class='l d0' name=6 href="#6">6</a> <span class='c'> * the License. You may obtain a copy of the License at</span>
<a class='l d0' name=7 href="#7">7</a> <span class='c'> * <a href="http://www.mozilla.org/MPL/">http://www.mozilla.org/MPL/</a></span>
<a class='l d0' name=8 href="#8">8</a> <span class='c'> *</span>
<a class='l d0' name=9 href="#9">9</a> <span class='c'> * Software distributed under the License is distributed on an "AS IS" basis,</span>
<a class='l d1' name=10 href="#10">10</a> <span class='c'> * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License</span>
<a class='l d1' name=11 href="#11">11</a> <span class='c'> * for the specific language governing rights and limitations under the</span>
<a class='l d1' name=12 href="#12">12</a> <span class='c'> * License.</span>
<a class='l d1' name=13 href="#13">13</a> <span class='c'> *</span>
<a class='l d1' name=14 href="#14">14</a> <span class='c'> * The Original Code is FUEL.</span>
<a class='l d1' name=15 href="#15">15</a> <span class='c'> *</span>
<a class='l d1' name=16 href="#16">16</a> <span class='c'> * The Initial Developer of the Original Code is Mozilla Corporation.</span>
<a class='l d1' name=17 href="#17">17</a> <span class='c'> * Portions created by the Initial Developer are Copyright (C) 2006</span>
<a class='l d1' name=18 href="#18">18</a> <span class='c'> * the Initial Developer. All Rights Reserved.</span>
<a class='l d1' name=19 href="#19">19</a> <span class='c'> *</span>
<a class='l d1' name=20 href="#20">20</a> <span class='c'> * Contributor(s):</span>
<a class='l d1' name=21 href="#21">21</a> <span class='c'> *  Mark Finkle <a href="mailto:mfinkle@mozilla.com">&lt;mfinkle@mozilla.com&gt;</a> (Original Author)</span>
<a class='l d1' name=22 href="#22">22</a> <span class='c'> *  John Resig  <a href="mailto:jresig@mozilla.com">&lt;jresig@mozilla.com&gt;</a> (Original Author)</span>
<a class='l d1' name=23 href="#23">23</a> <span class='c'> *</span>
<a class='l d1' name=24 href="#24">24</a> <span class='c'> * Alternatively, the contents of this file may be used under the terms of</span>
<a class='l d1' name=25 href="#25">25</a> <span class='c'> * either the GNU General Public License Version 2 or later (the "GPL"), or</span>
<a class='l d1' name=26 href="#26">26</a> <span class='c'> * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),</span>
<a class='l d1' name=27 href="#27">27</a> <span class='c'> * in which case the provisions of the GPL or the LGPL are applicable instead</span>
<a class='l d1' name=28 href="#28">28</a> <span class='c'> * of those above. If you wish to allow use of your version of this file only</span>
<a class='l d1' name=29 href="#29">29</a> <span class='c'> * under the terms of either the GPL or the LGPL, and not to allow others to</span>
<a class='l d1' name=30 href="#30">30</a> <span class='c'> * use your version of this file under the terms of the MPL, indicate your</span>
<a class='l d1' name=31 href="#31">31</a> <span class='c'> * decision by deleting the provisions above and replace them with the notice</span>
<a class='l d1' name=32 href="#32">32</a> <span class='c'> * and other provisions required by the GPL or the LGPL. If you do not delete</span>
<a class='l d1' name=33 href="#33">33</a> <span class='c'> * the provisions above, a recipient may use your version of this file under</span>
<a class='l d1' name=34 href="#34">34</a> <span class='c'> * the terms of any one of the MPL, the GPL or the LGPL.</span>
<a class='l d1' name=35 href="#35">35</a> <span class='c'> *</span>
<a class='l d1' name=36 href="#36">36</a> <span class='c'> * ***** END LICENSE BLOCK ***** */</span>
<a class='l d1' name=37 href="#37">37</a> 
<a class='l d1' name=38 href="#38">38</a> <span class='c'>//=================================================</span>
<a class='l d1' name=39 href="#39">39</a> <span class='c'></span><span class='c'>// Shutdown - used to store cleanup functions which will</span>
<a class='l d1' name=40 href="#40">40</a> <span class='c'></span><span class='c'>//            be called on Application shutdown</span>
<a class='l d1' name=41 href="#41">41</a> <span class='c'></span><span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a> = [];
<a class='l d1' name=42 href="#42">42</a> 
<a class='l d1' name=43 href="#43">43</a> <span class='c'>//=================================================</span>
<a class='l d1' name=44 href="#44">44</a> <span class='c'></span><span class='c'>// Console constructor</span>
<a class='l d1' name=45 href="#45">45</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Console">Console</a>() {
<a class='l d1' name=46 href="#46">46</a>   <span class='v'>this.</span><span class='a'>_console</span> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/consoleservice;1"</span>]
<a class='l d1' name=47 href="#47">47</a>     .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIConsoleService">nsIConsoleService</a>);
<a class='l d1' name=48 href="#48">48</a> }
<a class='l d1' name=49 href="#49">49</a> 
<a class='l d1' name=50 href="#50">50</a> <span class='c'>//=================================================</span>
<a class='l d1' name=51 href="#51">51</a> <span class='c'></span><span class='c'>// Console implementation</span>
<a class='l d1' name=52 href="#52">52</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Console">Console</a>.<span class='v'>prototype </span>= {
<a class='l d1' name=53 href="#53">53</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=log">log</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=cs_log">cs_log</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aMsg">aMsg</a>) {
<a class='l d1' name=54 href="#54">54</a>     <span class='v'>this.</span><span class='a'>_console</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=logStringMessage">logStringMessage</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aMsg">aMsg</a>);
<a class='l d1' name=55 href="#55">55</a>   },
<a class='l d1' name=56 href="#56">56</a> 
<a class='l d1' name=57 href="#57">57</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=open">open</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=cs_open">cs_open</a>() {
<a class='l d1' name=58 href="#58">58</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=wMediator">wMediator</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/appshell/window-mediator;1"</span>]
<a class='l d1' name=59 href="#59">59</a>                               .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIWindowMediator">nsIWindowMediator</a>);
<a class='l d1' name=60 href="#60">60</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=console">console</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=wMediator">wMediator</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getMostRecentWindow">getMostRecentWindow</a>(<span class='s'>"global:console"</span>);
<a class='l d1' name=61 href="#61">61</a>     <span class='v'>if </span>(!<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=console">console</a>) {
<a class='l d1' name=62 href="#62">62</a>       <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=wWatch">wWatch</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/embedcomp/window-watcher;1"</span>]
<a class='l d1' name=63 href="#63">63</a>                              .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIWindowWatcher">nsIWindowWatcher</a>);
<a class='l d1' name=64 href="#64">64</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=wWatch">wWatch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=openWindow">openWindow</a>(<span class='v'>null,</span> <span class='s'>"chrome://global/content/console.xul"</span>, <span class='s'>"_blank"</span>,
<a class='l d1' name=65 href="#65">65</a>                         <span class='s'>"chrome,dialog=no,all"</span>, <span class='v'>null)</span>;
<a class='l d1' name=66 href="#66">66</a>     } <span class='v'>else </span>{
<a class='l d1' name=67 href="#67">67</a>       <span class='c'>// console was already open</span>
<a class='l d1' name=68 href="#68">68</a> <span class='c'></span>      <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=console">console</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=focus">focus</a>();
<a class='l d1' name=69 href="#69">69</a>     }
<a class='l d1' name=70 href="#70">70</a>   },
<a class='l d1' name=71 href="#71">71</a> 
<a class='l d1' name=72 href="#72">72</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIConsole">extIConsole</a>])
<a class='l d1' name=73 href="#73">73</a> };
<a class='l d1' name=74 href="#74">74</a> 
<a class='l d1' name=75 href="#75">75</a> 
<a class='l d1' name=76 href="#76">76</a> <span class='c'>//=================================================</span>
<a class='l d1' name=77 href="#77">77</a> <span class='c'></span><span class='c'>// EventItem constructor</span>
<a class='l d1' name=78 href="#78">78</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=EventItem">EventItem</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aType">aType</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>) {
<a class='l d1' name=79 href="#79">79</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_type">_type</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aType">aType</a>;
<a class='l d1' name=80 href="#80">80</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_data">_data</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>;
<a class='l d1' name=81 href="#81">81</a> }
<a class='l d1' name=82 href="#82">82</a> 
<a class='l d1' name=83 href="#83">83</a> <span class='c'>//=================================================</span>
<a class='l d1' name=84 href="#84">84</a> <span class='c'></span><span class='c'>// EventItem implementation</span>
<a class='l d1' name=85 href="#85">85</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=EventItem">EventItem</a>.<span class='v'>prototype </span>= {
<a class='l d1' name=86 href="#86">86</a>   <span class='a'>_cancel</span> : <span class='v'>false,
<a class='l d1' name=87 href="#87">87</a> </span>
<a class='l d1' name=88 href="#88">88</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>() {
<a class='l d1' name=89 href="#89">89</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_type">_type</a>;
<a class='l d1' name=90 href="#90">90</a>   },
<a class='l d1' name=91 href="#91">91</a> 
<a class='l d1' name=92 href="#92">92</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a>() {
<a class='l d1' name=93 href="#93">93</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_data">_data</a>;
<a class='l d1' name=94 href="#94">94</a>   },
<a class='l d1' name=95 href="#95">95</a> 
<a class='l d1' name=96 href="#96">96</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=preventDefault">preventDefault</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ei_pd">ei_pd</a>() {
<a class='l d1' name=97 href="#97">97</a>     <span class='v'>this.</span><span class='a'>_cancel</span> = <span class='v'>true;</span>
<a class='l d1' name=98 href="#98">98</a>   },
<a class='l d1' name=99 href="#99">99</a> 
<a class='l d2' name=100 href="#100">100</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIEventItem">extIEventItem</a>])
<a class='l d2' name=101 href="#101">101</a> };
<a class='l d2' name=102 href="#102">102</a> 
<a class='l d2' name=103 href="#103">103</a> 
<a class='l d2' name=104 href="#104">104</a> <span class='c'>//=================================================</span>
<a class='l d2' name=105 href="#105">105</a> <span class='c'></span><span class='c'>// Events constructor</span>
<a class='l d2' name=106 href="#106">106</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>() {
<a class='l d2' name=107 href="#107">107</a>   <span class='v'>this.</span><span class='a'>_listeners</span> = [];
<a class='l d2' name=108 href="#108">108</a> }
<a class='l d2' name=109 href="#109">109</a> 
<a class='l d2' name=110 href="#110">110</a> <span class='c'>//=================================================</span>
<a class='l d2' name=111 href="#111">111</a> <span class='c'></span><span class='c'>// Events implementation</span>
<a class='l d2' name=112 href="#112">112</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=113 href="#113">113</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addListener">addListener</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=evts_al">evts_al</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aListener">aListener</a>) {
<a class='l d2' name=114 href="#114">114</a>     <span class='v'>if </span>(<span class='v'>this.</span><span class='a'>_listeners</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=some">some</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasFilter">hasFilter</a>))
<a class='l d2' name=115 href="#115">115</a>       <span class='v'>return;</span>
<a class='l d2' name=116 href="#116">116</a> 
<a class='l d2' name=117 href="#117">117</a>     <span class='v'>this.</span><span class='a'>_listeners</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>({
<a class='l d2' name=118 href="#118">118</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=event">event</a>: <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>,
<a class='l d2' name=119 href="#119">119</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a>: <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aListener">aListener</a>
<a class='l d2' name=120 href="#120">120</a>     });
<a class='l d2' name=121 href="#121">121</a> 
<a class='l d2' name=122 href="#122">122</a>     <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasFilter">hasFilter</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>) {
<a class='l d2' name=123 href="#123">123</a>       <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=event">event</a> == <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a> &amp;&amp; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a> == <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aListener">aListener</a>;
<a class='l d2' name=124 href="#124">124</a>     }
<a class='l d2' name=125 href="#125">125</a>   },
<a class='l d2' name=126 href="#126">126</a> 
<a class='l d2' name=127 href="#127">127</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeListener">removeListener</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=evts_rl">evts_rl</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aListener">aListener</a>) {
<a class='l d2' name=128 href="#128">128</a>     <span class='v'>this.</span><span class='a'>_listeners</span> = <span class='v'>this.</span><span class='a'>_listeners</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=filter">filter</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasFilter">hasFilter</a>);
<a class='l d2' name=129 href="#129">129</a> 
<a class='l d2' name=130 href="#130">130</a>     <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasFilter">hasFilter</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>) {
<a class='l d2' name=131 href="#131">131</a>       <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=event">event</a> != <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a> &amp;&amp; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=element">element</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a> != <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aListener">aListener</a>;
<a class='l d2' name=132 href="#132">132</a>     }
<a class='l d2' name=133 href="#133">133</a>   },
<a class='l d2' name=134 href="#134">134</a> 
<a class='l d2' name=135 href="#135">135</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=evts_dispatch">evts_dispatch</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>, <span class='a'>aEventItem</span>) {
<a class='l d2' name=136 href="#136">136</a>     <span class='a'>eventItem</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=EventItem">EventItem</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>, <span class='a'>aEventItem</span>);
<a class='l d2' name=137 href="#137">137</a> 
<a class='l d2' name=138 href="#138">138</a>     <span class='v'>this.</span><span class='a'>_listeners</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=forEach">forEach</a>(<span class='v'>function(</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=key">key</a>){
<a class='l d2' name=139 href="#139">139</a>       <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=key">key</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=event">event</a> == <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>) {
<a class='l d2' name=140 href="#140">140</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=key">key</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=handleEvent">handleEvent</a> ?
<a class='l d2' name=141 href="#141">141</a>           <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=key">key</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=handleEvent">handleEvent</a>(<span class='a'>eventItem</span>) :
<a class='l d2' name=142 href="#142">142</a>           <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=key">key</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=listener">listener</a>(<span class='a'>eventItem</span>);
<a class='l d2' name=143 href="#143">143</a>       }
<a class='l d2' name=144 href="#144">144</a>     });
<a class='l d2' name=145 href="#145">145</a> 
<a class='l d2' name=146 href="#146">146</a>     <span class='v'>return </span>!<span class='a'>eventItem</span>.<span class='a'>_cancel</span>;
<a class='l d2' name=147 href="#147">147</a>   },
<a class='l d2' name=148 href="#148">148</a> 
<a class='l d2' name=149 href="#149">149</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIEvents">extIEvents</a>])
<a class='l d2' name=150 href="#150">150</a> };
<a class='l d2' name=151 href="#151">151</a> 
<a class='l d2' name=152 href="#152">152</a> 
<a class='l d2' name=153 href="#153">153</a> <span class='c'>//=================================================</span>
<a class='l d2' name=154 href="#154">154</a> <span class='c'></span><span class='c'>// PreferenceBranch constructor</span>
<a class='l d2' name=155 href="#155">155</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PreferenceBranch">PreferenceBranch</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>) {
<a class='l d2' name=156 href="#156">156</a>   <span class='v'>if </span>(!<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>)
<a class='l d2' name=157 href="#157">157</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a> = <span class='s'>""</span>;
<a class='l d2' name=158 href="#158">158</a> 
<a class='l d2' name=159 href="#159">159</a>   <span class='v'>this.</span><span class='a'>_root</span> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>;
<a class='l d2' name=160 href="#160">160</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/preferences-service;1"</span>]
<a class='l d2' name=161 href="#161">161</a>                           .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefService">nsIPrefService</a>);
<a class='l d2' name=162 href="#162">162</a> 
<a class='l d2' name=163 href="#163">163</a>   <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>)
<a class='l d2' name=164 href="#164">164</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getBranch">getBranch</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>);
<a class='l d2' name=165 href="#165">165</a> 
<a class='l d2' name=166 href="#166">166</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch">nsIPrefBranch</a>);
<a class='l d2' name=167 href="#167">167</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>);
<a class='l d2' name=168 href="#168">168</a> 
<a class='l d2' name=169 href="#169">169</a>   <span class='c'>// we want to listen to "all" changes for this branch, so pass in a blank domain</span>
<a class='l d2' name=170 href="#170">170</a> <span class='c'></span>  <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addObserver">addObserver</a>(<span class='s'>""</span>, <span class='v'>this,</span> <span class='v'>true)</span>;
<a class='l d2' name=171 href="#171">171</a>   <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>();
<a class='l d2' name=172 href="#172">172</a> 
<a class='l d2' name=173 href="#173">173</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a> = <span class='v'>this;</span>
<a class='l d2' name=174 href="#174">174</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>(<span class='v'>function(</span>) { <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a>(); });
<a class='l d2' name=175 href="#175">175</a> }
<a class='l d2' name=176 href="#176">176</a> 
<a class='l d2' name=177 href="#177">177</a> <span class='c'>//=================================================</span>
<a class='l d2' name=178 href="#178">178</a> <span class='c'></span><span class='c'>// PreferenceBranch implementation</span>
<a class='l d2' name=179 href="#179">179</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PreferenceBranch">PreferenceBranch</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=180 href="#180">180</a>   <span class='c'>// cleanup observer so we don't leak</span>
<a class='l d2' name=181 href="#181">181</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_shutdown">prefs_shutdown</a>() {
<a class='l d2' name=182 href="#182">182</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeObserver">removeObserver</a>(<span class='v'>this.</span><span class='a'>_root</span>, <span class='v'>this)</span>;
<a class='l d2' name=183 href="#183">183</a> 
<a class='l d2' name=184 href="#184">184</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>null;
<a class='l d2' name=185 href="#185">185</a> </span>    <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>null;
<a class='l d2' name=186 href="#186">186</a> </span>  },
<a class='l d2' name=187 href="#187">187</a> 
<a class='l d2' name=188 href="#188">188</a>   <span class='c'>// for nsIObserver</span>
<a class='l d2' name=189 href="#189">189</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=observe">observe</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_observe">prefs_observe</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>) {
<a class='l d2' name=190 href="#190">190</a>     <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a> == <span class='s'>"nsPref:changed"</span>)
<a class='l d2' name=191 href="#191">191</a>       <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"change"</span>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>);
<a class='l d2' name=192 href="#192">192</a>   },
<a class='l d2' name=193 href="#193">193</a> 
<a class='l d2' name=194 href="#194">194</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=root">root</a>() {
<a class='l d2' name=195 href="#195">195</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_root</span>;
<a class='l d2' name=196 href="#196">196</a>   },
<a class='l d2' name=197 href="#197">197</a> 
<a class='l d2' name=198 href="#198">198</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=all">all</a>() {
<a class='l d2' name=199 href="#199">199</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=find">find</a>({});
<a class='l d2' name=200 href="#200">200</a>   },
<a class='l d2' name=201 href="#201">201</a> 
<a class='l d2' name=202 href="#202">202</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>() {
<a class='l d2' name=203 href="#203">203</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_events</span>;
<a class='l d2' name=204 href="#204">204</a>   },
<a class='l d2' name=205 href="#205">205</a> 
<a class='l d2' name=206 href="#206">206</a>   <span class='c'>// XXX: Disabled until we can figure out the wrapped object issues</span>
<a class='l d2' name=207 href="#207">207</a> <span class='c'></span>  <span class='c'>// name: "name" or /name/</span>
<a class='l d2' name=208 href="#208">208</a> <span class='c'></span>  <span class='c'>// path: "foo.bar." or "" or /fo+\.bar/</span>
<a class='l d2' name=209 href="#209">209</a> <span class='c'></span>  <span class='c'>// type: Boolean, Number, String (getPrefType)</span>
<a class='l d2' name=210 href="#210">210</a> <span class='c'></span>  <span class='c'>// locked: true, false (prefIsLocked)</span>
<a class='l d2' name=211 href="#211">211</a> <span class='c'></span>  <span class='c'>// modified: true, false (prefHasUserValue)</span>
<a class='l d2' name=212 href="#212">212</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=find">find</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_find">prefs_find</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aOptions">aOptions</a>) {
<a class='l d2' name=213 href="#213">213</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a> = [];
<a class='l d2' name=214 href="#214">214</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getChildList">getChildList</a>(<span class='s'>""</span>, []);
<a class='l d2' name=215 href="#215">215</a> 
<a class='l d2' name=216 href="#216">216</a>     <span class='v'>for </span>(<span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a> = 0; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a> &lt; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=length">length</a>; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a>++) {
<a class='l d2' name=217 href="#217">217</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>(<span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Preference">Preference</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a>], <span class='v'>this)</span>);
<a class='l d2' name=218 href="#218">218</a>     }
<a class='l d2' name=219 href="#219">219</a> 
<a class='l d2' name=220 href="#220">220</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a>;
<a class='l d2' name=221 href="#221">221</a>   },
<a class='l d2' name=222 href="#222">222</a> 
<a class='l d2' name=223 href="#223">223</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_has">prefs_has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) {
<a class='l d2' name=224 href="#224">224</a>     <span class='v'>return </span>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getPrefType">getPrefType</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) != <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch">nsIPrefBranch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_INVALID">PREF_INVALID</a>);
<a class='l d2' name=225 href="#225">225</a>   },
<a class='l d2' name=226 href="#226">226</a> 
<a class='l d2' name=227 href="#227">227</a>   <span class='v'>get </span>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_get">prefs_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) {
<a class='l d2' name=228 href="#228">228</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) ? <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Preference">Preference</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <span class='v'>this)</span> : <span class='v'>null;
<a class='l d2' name=229 href="#229">229</a> </span>  },
<a class='l d2' name=230 href="#230">230</a> 
<a class='l d2' name=231 href="#231">231</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getValue">getValue</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_gv">prefs_gv</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>) {
<a class='l d2' name=232 href="#232">232</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getPrefType">getPrefType</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>);
<a class='l d2' name=233 href="#233">233</a> 
<a class='l d2' name=234 href="#234">234</a>     <span class='v'>switch </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>) {
<a class='l d2' name=235 href="#235">235</a>       <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_STRING">PREF_STRING</a>:
<a class='l d2' name=236 href="#236">236</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getComplexValue">getComplexValue</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsISupportsString">nsISupportsString</a>).<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a>;
<a class='l d2' name=237 href="#237">237</a>         <span class='v'>break;
<a class='l d2' name=238 href="#238">238</a> </span>      <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_BOOL">PREF_BOOL</a>:
<a class='l d2' name=239 href="#239">239</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getBoolPref">getBoolPref</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>);
<a class='l d2' name=240 href="#240">240</a>         <span class='v'>break;
<a class='l d2' name=241 href="#241">241</a> </span>      <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_INT">PREF_INT</a>:
<a class='l d2' name=242 href="#242">242</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getIntPref">getIntPref</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>);
<a class='l d2' name=243 href="#243">243</a>         <span class='v'>break;
<a class='l d2' name=244 href="#244">244</a> </span>    }
<a class='l d2' name=245 href="#245">245</a> 
<a class='l d2' name=246 href="#246">246</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>;
<a class='l d2' name=247 href="#247">247</a>   },
<a class='l d2' name=248 href="#248">248</a> 
<a class='l d2' name=249 href="#249">249</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setValue">setValue</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_sv">prefs_sv</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>) {
<a class='l d2' name=250 href="#250">250</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a> != <span class='v'>null </span>? <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=constructor">constructor</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a> : <span class='s'>""</span>;
<a class='l d2' name=251 href="#251">251</a> 
<a class='l d2' name=252 href="#252">252</a>     <span class='v'>switch </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>) {
<a class='l d2' name=253 href="#253">253</a>       <span class='v'>case </span><span class='s'>"String"</span>:
<a class='l d2' name=254 href="#254">254</a>         <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=str">str</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/supports-string;1"</span>]
<a class='l d2' name=255 href="#255">255</a>                             .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=createInstance">createInstance</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsISupportsString">nsISupportsString</a>);
<a class='l d2' name=256 href="#256">256</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=str">str</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>;
<a class='l d2' name=257 href="#257">257</a>         <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setComplexValue">setComplexValue</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsISupportsString">nsISupportsString</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=str">str</a>);
<a class='l d2' name=258 href="#258">258</a>         <span class='v'>break;
<a class='l d2' name=259 href="#259">259</a> </span>      <span class='v'>case </span><span class='s'>"Boolean"</span>:
<a class='l d2' name=260 href="#260">260</a>         <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setBoolPref">setBoolPref</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>);
<a class='l d2' name=261 href="#261">261</a>         <span class='v'>break;
<a class='l d2' name=262 href="#262">262</a> </span>      <span class='v'>case </span><span class='s'>"Number"</span>:
<a class='l d2' name=263 href="#263">263</a>         <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setIntPref">setIntPref</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>);
<a class='l d2' name=264 href="#264">264</a>         <span class='v'>break;
<a class='l d2' name=265 href="#265">265</a> </span>      <span class='v'>default:
<a class='l d2' name=266 href="#266">266</a> </span>        <span class='v'>throw(</span><span class='s'>"Unknown preference value specified."</span>);
<a class='l d2' name=267 href="#267">267</a>     }
<a class='l d2' name=268 href="#268">268</a>   },
<a class='l d2' name=269 href="#269">269</a> 
<a class='l d2' name=270 href="#270">270</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=reset">reset</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs_reset">prefs_reset</a>() {
<a class='l d2' name=271 href="#271">271</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=resetBranch">resetBranch</a>(<span class='s'>""</span>);
<a class='l d2' name=272 href="#272">272</a>   },
<a class='l d2' name=273 href="#273">273</a> 
<a class='l d2' name=274 href="#274">274</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIPreferenceBranch">extIPreferenceBranch</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsISupportsWeakReference">nsISupportsWeakReference</a>])
<a class='l d2' name=275 href="#275">275</a> };
<a class='l d2' name=276 href="#276">276</a> 
<a class='l d2' name=277 href="#277">277</a> 
<a class='l d2' name=278 href="#278">278</a> <span class='c'>//=================================================</span>
<a class='l d2' name=279 href="#279">279</a> <span class='c'></span><span class='c'>// Preference constructor</span>
<a class='l d2' name=280 href="#280">280</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Preference">Preference</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>) {
<a class='l d2' name=281 href="#281">281</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_name">_name</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>;
<a class='l d2' name=282 href="#282">282</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_branch">_branch</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aBranch">aBranch</a>;
<a class='l d2' name=283 href="#283">283</a>   <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>();
<a class='l d2' name=284 href="#284">284</a> 
<a class='l d2' name=285 href="#285">285</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a> = <span class='v'>this;</span>
<a class='l d2' name=286 href="#286">286</a> 
<a class='l d2' name=287 href="#287">287</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addListener">addListener</a>(<span class='s'>"change"</span>, <span class='v'>function(</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>){
<a class='l d2' name=288 href="#288">288</a>     <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a> == <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>)
<a class='l d2' name=289 href="#289">289</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aEvent">aEvent</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a>);
<a class='l d2' name=290 href="#290">290</a>   });
<a class='l d2' name=291 href="#291">291</a> }
<a class='l d2' name=292 href="#292">292</a> 
<a class='l d2' name=293 href="#293">293</a> <span class='c'>//=================================================</span>
<a class='l d2' name=294 href="#294">294</a> <span class='c'></span><span class='c'>// Preference implementation</span>
<a class='l d2' name=295 href="#295">295</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Preference">Preference</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=296 href="#296">296</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>() {
<a class='l d2' name=297 href="#297">297</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_name">_name</a>;
<a class='l d2' name=298 href="#298">298</a>   },
<a class='l d2' name=299 href="#299">299</a> 
<a class='l d2' name=300 href="#300">300</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>() {
<a class='l d2' name=301 href="#301">301</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a> = <span class='s'>""</span>;
<a class='l d2' name=302 href="#302">302</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a> = <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getPrefType">getPrefType</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_name">_name</a>);
<a class='l d2' name=303 href="#303">303</a> 
<a class='l d2' name=304 href="#304">304</a>     <span class='v'>switch </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=type">type</a>) {
<a class='l d2' name=305 href="#305">305</a>       <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_STRING">PREF_STRING</a>:
<a class='l d2' name=306 href="#306">306</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a> = <span class='s'>"String"</span>;
<a class='l d2' name=307 href="#307">307</a>         <span class='v'>break;
<a class='l d2' name=308 href="#308">308</a> </span>      <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_BOOL">PREF_BOOL</a>:
<a class='l d2' name=309 href="#309">309</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a> = <span class='s'>"Boolean"</span>;
<a class='l d2' name=310 href="#310">310</a>         <span class='v'>break;
<a class='l d2' name=311 href="#311">311</a> </span>      <span class='v'>case </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIPrefBranch2">nsIPrefBranch2</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREF_INT">PREF_INT</a>:
<a class='l d2' name=312 href="#312">312</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a> = <span class='s'>"Number"</span>;
<a class='l d2' name=313 href="#313">313</a>         <span class='v'>break;
<a class='l d2' name=314 href="#314">314</a> </span>    }
<a class='l d2' name=315 href="#315">315</a> 
<a class='l d2' name=316 href="#316">316</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a>;
<a class='l d2' name=317 href="#317">317</a>   },
<a class='l d2' name=318 href="#318">318</a> 
<a class='l d2' name=319 href="#319">319</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a>() {
<a class='l d2' name=320 href="#320">320</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getValue">getValue</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_name">_name</a>, <span class='v'>null)</span>;
<a class='l d2' name=321 href="#321">321</a>   },
<a class='l d2' name=322 href="#322">322</a> 
<a class='l d2' name=323 href="#323">323</a>   <span class='v'>set </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>) {
<a class='l d2' name=324 href="#324">324</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setValue">setValue</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_name">_name</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>);
<a class='l d2' name=325 href="#325">325</a>   },
<a class='l d2' name=326 href="#326">326</a> 
<a class='l d2' name=327 href="#327">327</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=locked">locked</a>() {
<a class='l d2' name=328 href="#328">328</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefIsLocked">prefIsLocked</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>);
<a class='l d2' name=329 href="#329">329</a>   },
<a class='l d2' name=330 href="#330">330</a> 
<a class='l d2' name=331 href="#331">331</a>   <span class='v'>set </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=locked">locked</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>) {
<a class='l d2' name=332 href="#332">332</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>[ <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a> ? <span class='s'>"lockPref"</span> : <span class='s'>"unlockPref"</span> ](<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>);
<a class='l d2' name=333 href="#333">333</a>   },
<a class='l d2' name=334 href="#334">334</a> 
<a class='l d2' name=335 href="#335">335</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=modified">modified</a>() {
<a class='l d2' name=336 href="#336">336</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefHasUserValue">prefHasUserValue</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>);
<a class='l d2' name=337 href="#337">337</a>   },
<a class='l d2' name=338 href="#338">338</a> 
<a class='l d2' name=339 href="#339">339</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>() {
<a class='l d2' name=340 href="#340">340</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_branch">_branch</a>;
<a class='l d2' name=341 href="#341">341</a>   },
<a class='l d2' name=342 href="#342">342</a> 
<a class='l d2' name=343 href="#343">343</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>() {
<a class='l d2' name=344 href="#344">344</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_events</span>;
<a class='l d2' name=345 href="#345">345</a>   },
<a class='l d2' name=346 href="#346">346</a> 
<a class='l d2' name=347 href="#347">347</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=reset">reset</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=pref_reset">pref_reset</a>() {
<a class='l d2' name=348 href="#348">348</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=branch">branch</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=clearUserPref">clearUserPref</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>);
<a class='l d2' name=349 href="#349">349</a>   },
<a class='l d2' name=350 href="#350">350</a> 
<a class='l d2' name=351 href="#351">351</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIPreference">extIPreference</a>])
<a class='l d2' name=352 href="#352">352</a> };
<a class='l d2' name=353 href="#353">353</a> 
<a class='l d2' name=354 href="#354">354</a> 
<a class='l d2' name=355 href="#355">355</a> <span class='c'>//=================================================</span>
<a class='l d2' name=356 href="#356">356</a> <span class='c'></span><span class='c'>// SessionStorage constructor</span>
<a class='l d2' name=357 href="#357">357</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=SessionStorage">SessionStorage</a>() {
<a class='l d2' name=358 href="#358">358</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = {};
<a class='l d2' name=359 href="#359">359</a>   <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>();
<a class='l d2' name=360 href="#360">360</a> }
<a class='l d2' name=361 href="#361">361</a> 
<a class='l d2' name=362 href="#362">362</a> <span class='c'>//=================================================</span>
<a class='l d2' name=363 href="#363">363</a> <span class='c'></span><span class='c'>// SessionStorage implementation</span>
<a class='l d2' name=364 href="#364">364</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=SessionStorage">SessionStorage</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=365 href="#365">365</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>() {
<a class='l d2' name=366 href="#366">366</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_events</span>;
<a class='l d2' name=367 href="#367">367</a>   },
<a class='l d2' name=368 href="#368">368</a> 
<a class='l d2' name=369 href="#369">369</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ss_has">ss_has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) {
<a class='l d2' name=370 href="#370">370</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasOwnProperty">hasOwnProperty</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>);
<a class='l d2' name=371 href="#371">371</a>   },
<a class='l d2' name=372 href="#372">372</a> 
<a class='l d2' name=373 href="#373">373</a>   <span class='v'>set </span>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ss_set">ss_set</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>) {
<a class='l d2' name=374 href="#374">374</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>] = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aValue">aValue</a>;
<a class='l d2' name=375 href="#375">375</a>     <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"change"</span>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>);
<a class='l d2' name=376 href="#376">376</a>   },
<a class='l d2' name=377 href="#377">377</a> 
<a class='l d2' name=378 href="#378">378</a>   <span class='v'>get </span>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ss_get">ss_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aDefaultValue">aDefaultValue</a>) {
<a class='l d2' name=379 href="#379">379</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>) ? <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aName">aName</a>] : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aDefaultValue">aDefaultValue</a>;
<a class='l d2' name=380 href="#380">380</a>   },
<a class='l d2' name=381 href="#381">381</a> 
<a class='l d2' name=382 href="#382">382</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extISessionStorage">extISessionStorage</a>])
<a class='l d2' name=383 href="#383">383</a> };
<a class='l d2' name=384 href="#384">384</a> 
<a class='l d2' name=385 href="#385">385</a> 
<a class='l d2' name=386 href="#386">386</a> <span class='c'>//=================================================</span>
<a class='l d2' name=387 href="#387">387</a> <span class='c'></span><span class='c'>// Extension constructor</span>
<a class='l d2' name=388 href="#388">388</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extension">Extension</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aItem">aItem</a>) {
<a class='l d2' name=389 href="#389">389</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aItem">aItem</a>;
<a class='l d2' name=390 href="#390">390</a>   <span class='v'>this.</span><span class='a'>_firstRun</span> = <span class='v'>false;</span>
<a class='l d2' name=391 href="#391">391</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PreferenceBranch">PreferenceBranch</a>(<span class='s'>"extensions."</span> + <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a> + <span class='s'>"."</span>);
<a class='l d2' name=392 href="#392">392</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=SessionStorage">SessionStorage</a>();
<a class='l d2' name=393 href="#393">393</a>   <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>();
<a class='l d2' name=394 href="#394">394</a> 
<a class='l d2' name=395 href="#395">395</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=installPref">installPref</a> = <span class='s'>"install-event-fired"</span>;
<a class='l d2' name=396 href="#396">396</a>   <span class='v'>if </span>(!<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=installPref">installPref</a>)) {
<a class='l d2' name=397 href="#397">397</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=setValue">setValue</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=installPref">installPref</a>, <span class='v'>true)</span>;
<a class='l d2' name=398 href="#398">398</a>     <span class='v'>this.</span><span class='a'>_firstRun</span> = <span class='v'>true;</span>
<a class='l d2' name=399 href="#399">399</a>   }
<a class='l d2' name=400 href="#400">400</a> 
<a class='l d2' name=401 href="#401">401</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_enabled">_enabled</a> = <span class='v'>false;</span>
<a class='l d2' name=402 href="#402">402</a>   <span class='a'>const</span> <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREFIX_ITEM_URI">PREFIX_ITEM_URI</a> = <span class='s'>"urn:mozilla:item:"</span>;
<a class='l d2' name=403 href="#403">403</a>   <span class='a'>const</span> <span class='a'>PREFIX_NS_EM</span> = <span class='s'>"http://www.mozilla.org/2004/em-rdf#"</span>;
<a class='l d2' name=404 href="#404">404</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=rdf">rdf</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Cc">Cc</a>[<span class='s'>"@mozilla.org/rdf/rdf-service;1"</span>].<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIRDFService">nsIRDFService</a>);
<a class='l d2' name=405 href="#405">405</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=itemResource">itemResource</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=rdf">rdf</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=GetResource">GetResource</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PREFIX_ITEM_URI">PREFIX_ITEM_URI</a> + <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=406 href="#406">406</a>   <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=itemResource">itemResource</a>) {
<a class='l d2' name=407 href="#407">407</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extmgr">extmgr</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Cc">Cc</a>[<span class='s'>"@mozilla.org/extensions/manager;1"</span>].<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIExtensionManager">nsIExtensionManager</a>);
<a class='l d2' name=408 href="#408">408</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ds">ds</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extmgr">extmgr</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=datasource">datasource</a>;
<a class='l d2' name=409 href="#409">409</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=target">target</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ds">ds</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=GetTarget">GetTarget</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=itemResource">itemResource</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=rdf">rdf</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=GetResource">GetResource</a>(<span class='a'>PREFIX_NS_EM</span> + <span class='s'>"isDisabled"</span>), <span class='v'>true)</span>;
<a class='l d2' name=410 href="#410">410</a>     <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=target">target</a> &amp;&amp; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=target">target</a> <span class='v'>instanceof </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIRDFLiteral">nsIRDFLiteral</a>)
<a class='l d2' name=411 href="#411">411</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_enabled">_enabled</a> = (<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=target">target</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Value">Value</a> != <span class='s'>"true"</span>);
<a class='l d2' name=412 href="#412">412</a>   }
<a class='l d2' name=413 href="#413">413</a> 
<a class='l d2' name=414 href="#414">414</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/observer-service;1"</span>]
<a class='l d2' name=415 href="#415">415</a>                      .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIObserverService">nsIObserverService</a>);
<a class='l d2' name=416 href="#416">416</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addObserver">addObserver</a>(<span class='v'>this,</span> <span class='s'>"em-action-requested"</span>, <span class='v'>false)</span>;
<a class='l d2' name=417 href="#417">417</a> 
<a class='l d2' name=418 href="#418">418</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a> = <span class='v'>this;</span>
<a class='l d2' name=419 href="#419">419</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>(<span class='v'>function(</span>){ <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a>(); });
<a class='l d2' name=420 href="#420">420</a> }
<a class='l d2' name=421 href="#421">421</a> 
<a class='l d2' name=422 href="#422">422</a> <span class='c'>//=================================================</span>
<a class='l d2' name=423 href="#423">423</a> <span class='c'></span><span class='c'>// Extension implementation</span>
<a class='l d2' name=424 href="#424">424</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extension">Extension</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=425 href="#425">425</a>   <span class='c'>// cleanup observer so we don't leak</span>
<a class='l d2' name=426 href="#426">426</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ext_shutdown">ext_shutdown</a>() {
<a class='l d2' name=427 href="#427">427</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/observer-service;1"</span>]
<a class='l d2' name=428 href="#428">428</a>                        .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIObserverService">nsIObserverService</a>);
<a class='l d2' name=429 href="#429">429</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeObserver">removeObserver</a>(<span class='v'>this,</span> <span class='s'>"em-action-requested"</span>);
<a class='l d2' name=430 href="#430">430</a> 
<a class='l d2' name=431 href="#431">431</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>null;
<a class='l d2' name=432 href="#432">432</a> </span>    <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = <span class='v'>null;
<a class='l d2' name=433 href="#433">433</a> </span>    <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>null;
<a class='l d2' name=434 href="#434">434</a> </span>  },
<a class='l d2' name=435 href="#435">435</a> 
<a class='l d2' name=436 href="#436">436</a>   <span class='c'>// for nsIObserver</span>
<a class='l d2' name=437 href="#437">437</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=observe">observe</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ext_observe">ext_observe</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>)
<a class='l d2' name=438 href="#438">438</a>   {
<a class='l d2' name=439 href="#439">439</a>     <span class='v'>if </span>((<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a> <span class='v'>instanceof </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIUpdateItem">nsIUpdateItem</a>) &amp;&amp; (<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a> == <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>))
<a class='l d2' name=440 href="#440">440</a>     {
<a class='l d2' name=441 href="#441">441</a>       <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a> == <span class='s'>"item-uninstalled"</span>)
<a class='l d2' name=442 href="#442">442</a>         <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"uninstall"</span>, <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=443 href="#443">443</a>       <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a> == <span class='s'>"item-disabled"</span>)
<a class='l d2' name=444 href="#444">444</a>         <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"disable"</span>, <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=445 href="#445">445</a>       <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a> == <span class='s'>"item-enabled"</span>)
<a class='l d2' name=446 href="#446">446</a>         <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"enable"</span>, <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=447 href="#447">447</a>       <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a> == <span class='s'>"item-cancel-action"</span>)
<a class='l d2' name=448 href="#448">448</a>         <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"cancel"</span>, <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=449 href="#449">449</a>       <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a> == <span class='s'>"item-upgraded"</span>)
<a class='l d2' name=450 href="#450">450</a>         <span class='v'>this.</span><span class='a'>_events</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"upgrade"</span>, <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>);
<a class='l d2' name=451 href="#451">451</a>     }
<a class='l d2' name=452 href="#452">452</a>   },
<a class='l d2' name=453 href="#453">453</a> 
<a class='l d2' name=454 href="#454">454</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>() {
<a class='l d2' name=455 href="#455">455</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>;
<a class='l d2' name=456 href="#456">456</a>   },
<a class='l d2' name=457 href="#457">457</a> 
<a class='l d2' name=458 href="#458">458</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>() {
<a class='l d2' name=459 href="#459">459</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>;
<a class='l d2' name=460 href="#460">460</a>   },
<a class='l d2' name=461 href="#461">461</a> 
<a class='l d2' name=462 href="#462">462</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=enabled">enabled</a>() {
<a class='l d2' name=463 href="#463">463</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_enabled">_enabled</a>;
<a class='l d2' name=464 href="#464">464</a>   },
<a class='l d2' name=465 href="#465">465</a> 
<a class='l d2' name=466 href="#466">466</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=version">version</a>() {
<a class='l d2' name=467 href="#467">467</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_item">_item</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=version">version</a>;
<a class='l d2' name=468 href="#468">468</a>   },
<a class='l d2' name=469 href="#469">469</a> 
<a class='l d2' name=470 href="#470">470</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=firstRun">firstRun</a>() {
<a class='l d2' name=471 href="#471">471</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_firstRun</span>;
<a class='l d2' name=472 href="#472">472</a>   },
<a class='l d2' name=473 href="#473">473</a> 
<a class='l d2' name=474 href="#474">474</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=storage">storage</a>() {
<a class='l d2' name=475 href="#475">475</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a>;
<a class='l d2' name=476 href="#476">476</a>   },
<a class='l d2' name=477 href="#477">477</a> 
<a class='l d2' name=478 href="#478">478</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs">prefs</a>() {
<a class='l d2' name=479 href="#479">479</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>;
<a class='l d2' name=480 href="#480">480</a>   },
<a class='l d2' name=481 href="#481">481</a> 
<a class='l d2' name=482 href="#482">482</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>() {
<a class='l d2' name=483 href="#483">483</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_events</span>;
<a class='l d2' name=484 href="#484">484</a>   },
<a class='l d2' name=485 href="#485">485</a> 
<a class='l d2' name=486 href="#486">486</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIExtension">extIExtension</a>])
<a class='l d2' name=487 href="#487">487</a> };
<a class='l d2' name=488 href="#488">488</a> 
<a class='l d2' name=489 href="#489">489</a> 
<a class='l d2' name=490 href="#490">490</a> <span class='c'>//=================================================</span>
<a class='l d2' name=491 href="#491">491</a> <span class='c'></span><span class='c'>// Extensions constructor</span>
<a class='l d2' name=492 href="#492">492</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extensions">Extensions</a>() {
<a class='l d2' name=493 href="#493">493</a>   <span class='v'>this.</span><span class='a'>_extmgr</span> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/extensions/manager;1"</span>]
<a class='l d2' name=494 href="#494">494</a>                            .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIExtensionManager">nsIExtensionManager</a>);
<a class='l d2' name=495 href="#495">495</a> 
<a class='l d2' name=496 href="#496">496</a>   <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_cache">_cache</a> = {};
<a class='l d2' name=497 href="#497">497</a> 
<a class='l d2' name=498 href="#498">498</a>   <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a> = <span class='v'>this;</span>
<a class='l d2' name=499 href="#499">499</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>(<span class='v'>function(</span>) { <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=self">self</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a>(); });
<a class='l d2' name=500 href="#500">500</a> }
<a class='l d2' name=501 href="#501">501</a> 
<a class='l d2' name=502 href="#502">502</a> <span class='c'>//=================================================</span>
<a class='l d2' name=503 href="#503">503</a> <span class='c'></span><span class='c'>// Extensions implementation</span>
<a class='l d2' name=504 href="#504">504</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extensions">Extensions</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=505 href="#505">505</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_shutdown">_shutdown</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=exts_shutdown">exts_shutdown</a>() {
<a class='l d2' name=506 href="#506">506</a>     <span class='v'>this.</span><span class='a'>_extmgr</span> = <span class='v'>null;
<a class='l d2' name=507 href="#507">507</a> </span>    <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_cache">_cache</a> = <span class='v'>null;
<a class='l d2' name=508 href="#508">508</a> </span>  },
<a class='l d2' name=509 href="#509">509</a> 
<a class='l d2' name=510 href="#510">510</a>   <span class='c'>/*</span>
<a class='l d2' name=511 href="#511">511</a> <span class='c'>   * Helper method to check cache before creating a new extension</span>
<a class='l d2' name=512 href="#512">512</a> <span class='c'>   */</span>
<a class='l d2' name=513 href="#513">513</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_get">_get</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=exts_get">exts_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) {
<a class='l d2' name=514 href="#514">514</a>     <span class='v'>if </span>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_cache">_cache</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=hasOwnProperty">hasOwnProperty</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>))
<a class='l d2' name=515 href="#515">515</a>       <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_cache">_cache</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>];
<a class='l d2' name=516 href="#516">516</a> 
<a class='l d2' name=517 href="#517">517</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=newExt">newExt</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extension">Extension</a>(<span class='v'>this.</span><span class='a'>_extmgr</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getItemForID">getItemForID</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>));
<a class='l d2' name=518 href="#518">518</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_cache">_cache</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>] = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=newExt">newExt</a>;
<a class='l d2' name=519 href="#519">519</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=newExt">newExt</a>;
<a class='l d2' name=520 href="#520">520</a>   },
<a class='l d2' name=521 href="#521">521</a> 
<a class='l d2' name=522 href="#522">522</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=all">all</a>() {
<a class='l d2' name=523 href="#523">523</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=find">find</a>({});
<a class='l d2' name=524 href="#524">524</a>   },
<a class='l d2' name=525 href="#525">525</a> 
<a class='l d2' name=526 href="#526">526</a>   <span class='c'>// XXX: Disabled until we can figure out the wrapped object issues</span>
<a class='l d2' name=527 href="#527">527</a> <span class='c'></span>  <span class='c'>// id: "some@id" or /id/</span>
<a class='l d2' name=528 href="#528">528</a> <span class='c'></span>  <span class='c'>// name: "name" or /name/</span>
<a class='l d2' name=529 href="#529">529</a> <span class='c'></span>  <span class='c'>// version: "1.0.1"</span>
<a class='l d2' name=530 href="#530">530</a> <span class='c'></span>  <span class='c'>// minVersion: "1.0"</span>
<a class='l d2' name=531 href="#531">531</a> <span class='c'></span>  <span class='c'>// maxVersion: "2.0"</span>
<a class='l d2' name=532 href="#532">532</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=find">find</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=exts_find">exts_find</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aOptions">aOptions</a>) {
<a class='l d2' name=533 href="#533">533</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a> = [];
<a class='l d2' name=534 href="#534">534</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a> = <span class='v'>this.</span><span class='a'>_extmgr</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getItemList">getItemList</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIUpdateItem">nsIUpdateItem</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=TYPE_EXTENSION">TYPE_EXTENSION</a>, {});
<a class='l d2' name=535 href="#535">535</a> 
<a class='l d2' name=536 href="#536">536</a>     <span class='v'>for </span>(<span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a> = 0; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a> &lt; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=length">length</a>; <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a>++) {
<a class='l d2' name=537 href="#537">537</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=push">push</a>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_get">_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=items">items</a>[<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=i">i</a>].<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>));
<a class='l d2' name=538 href="#538">538</a>     }
<a class='l d2' name=539 href="#539">539</a> 
<a class='l d2' name=540 href="#540">540</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=retVal">retVal</a>;
<a class='l d2' name=541 href="#541">541</a>   },
<a class='l d2' name=542 href="#542">542</a> 
<a class='l d2' name=543 href="#543">543</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=exts_has">exts_has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) {
<a class='l d2' name=544 href="#544">544</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_extmgr</span>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getItemForID">getItemForID</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) != <span class='v'>null;
<a class='l d2' name=545 href="#545">545</a> </span>  },
<a class='l d2' name=546 href="#546">546</a> 
<a class='l d2' name=547 href="#547">547</a>   <span class='v'>get </span>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=exts_get">exts_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) {
<a class='l d2' name=548 href="#548">548</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=has">has</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) ? <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_get">_get</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aId">aId</a>) : <span class='v'>null;
<a class='l d2' name=549 href="#549">549</a> </span>  },
<a class='l d2' name=550 href="#550">550</a> 
<a class='l d2' name=551 href="#551">551</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIExtensions">extIExtensions</a>])
<a class='l d2' name=552 href="#552">552</a> };
<a class='l d2' name=553 href="#553">553</a> 
<a class='l d2' name=554 href="#554">554</a> <span class='c'>//=================================================</span>
<a class='l d2' name=555 href="#555">555</a> <span class='c'></span><span class='c'>// extApplication constructor</span>
<a class='l d2' name=556 href="#556">556</a> <span class='c'></span><span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extApplication">extApplication</a>() {
<a class='l d2' name=557 href="#557">557</a> }
<a class='l d2' name=558 href="#558">558</a> 
<a class='l d2' name=559 href="#559">559</a> <span class='c'>//=================================================</span>
<a class='l d2' name=560 href="#560">560</a> <span class='c'></span><span class='c'>// extApplication implementation</span>
<a class='l d2' name=561 href="#561">561</a> <span class='c'></span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extApplication">extApplication</a>.<span class='v'>prototype </span>= {
<a class='l d2' name=562 href="#562">562</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=initToolkitHelpers">initToolkitHelpers</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extApp_initToolkitHelpers">extApp_initToolkitHelpers</a>() {
<a class='l d2' name=563 href="#563">563</a>     <span class='v'>this.</span><span class='a'>_console</span> = <span class='v'>null;
<a class='l d2' name=564 href="#564">564</a> </span>    <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = <span class='v'>null;
<a class='l d2' name=565 href="#565">565</a> </span>    <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>null;
<a class='l d2' name=566 href="#566">566</a> </span>    <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_extensions">_extensions</a> = <span class='v'>null;
<a class='l d2' name=567 href="#567">567</a> </span>    <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>null;
<a class='l d2' name=568 href="#568">568</a> </span>
<a class='l d2' name=569 href="#569">569</a>     <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_info">_info</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/xre/app-info;1"</span>]
<a class='l d2' name=570 href="#570">570</a>                            .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIXULAppInfo">nsIXULAppInfo</a>);
<a class='l d2' name=571 href="#571">571</a> 
<a class='l d2' name=572 href="#572">572</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/observer-service;1"</span>]
<a class='l d2' name=573 href="#573">573</a>                        .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIObserverService">nsIObserverService</a>);
<a class='l d2' name=574 href="#574">574</a> 
<a class='l d2' name=575 href="#575">575</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addObserver">addObserver</a>(<span class='v'>this,</span> <span class='s'>"final-ui-startup"</span>, <span class='v'>false)</span>;
<a class='l d2' name=576 href="#576">576</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addObserver">addObserver</a>(<span class='v'>this,</span> <span class='s'>"quit-application-requested"</span>, <span class='v'>false)</span>;
<a class='l d2' name=577 href="#577">577</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=addObserver">addObserver</a>(<span class='v'>this,</span> <span class='s'>"xpcom-shutdown"</span>, <span class='v'>false)</span>;
<a class='l d2' name=578 href="#578">578</a>   },
<a class='l d2' name=579 href="#579">579</a> 
<a class='l d2' name=580 href="#580">580</a>   <span class='c'>// get this contractID registered for certain categories via XPCOMUtils</span>
<a class='l d2' name=581 href="#581">581</a> <span class='c'></span>  <span class='a'>_xpcom_categories</span>: [
<a class='l d2' name=582 href="#582">582</a>     <span class='c'>// make Application a startup observer</span>
<a class='l d2' name=583 href="#583">583</a> <span class='c'></span>    { <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=category">category</a>: <span class='s'>"app-startup"</span>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=service">service</a>: <span class='v'>true </span>},
<a class='l d2' name=584 href="#584">584</a> 
<a class='l d2' name=585 href="#585">585</a>     <span class='c'>// add Application as a global property for easy access</span>
<a class='l d2' name=586 href="#586">586</a> <span class='c'></span>    { <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=category">category</a>: <span class='s'>"JavaScript global privileged property"</span> }
<a class='l d2' name=587 href="#587">587</a>   ],
<a class='l d2' name=588 href="#588">588</a> 
<a class='l d2' name=589 href="#589">589</a>   <span class='c'>// for nsIClassInfo</span>
<a class='l d2' name=590 href="#590">590</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=flags">flags</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIClassInfo">nsIClassInfo</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=SINGLETON">SINGLETON</a>,
<a class='l d2' name=591 href="#591">591</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=implementationLanguage">implementationLanguage</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIProgrammingLanguage">nsIProgrammingLanguage</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=JAVASCRIPT">JAVASCRIPT</a>,
<a class='l d2' name=592 href="#592">592</a> 
<a class='l d2' name=593 href="#593">593</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getInterfaces">getInterfaces</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=app_gi">app_gi</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aCount">aCount</a>) {
<a class='l d2' name=594 href="#594">594</a>     <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=interfaces">interfaces</a> = [<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIApplication">extIApplication</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIObserver">nsIObserver</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIClassInfo">nsIClassInfo</a>];
<a class='l d2' name=595 href="#595">595</a>     <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aCount">aCount</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=value">value</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=interfaces">interfaces</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=length">length</a>;
<a class='l d2' name=596 href="#596">596</a>     <span class='v'>return </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=interfaces">interfaces</a>;
<a class='l d2' name=597 href="#597">597</a>   },
<a class='l d2' name=598 href="#598">598</a> 
<a class='l d2' name=599 href="#599">599</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getHelperForLanguage">getHelperForLanguage</a> : <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=app_ghfl">app_ghfl</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aCount">aCount</a>) {
<a class='l d2' name=600 href="#600">600</a>     <span class='v'>return </span><span class='v'>null;
<a class='l d2' name=601 href="#601">601</a> </span>  },
<a class='l d2' name=602 href="#602">602</a> 
<a class='l d2' name=603 href="#603">603</a>   <span class='c'>// extIApplication</span>
<a class='l d2' name=604 href="#604">604</a> <span class='c'></span>  <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=id">id</a>() {
<a class='l d2' name=605 href="#605">605</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_info">_info</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=ID">ID</a>;
<a class='l d2' name=606 href="#606">606</a>   },
<a class='l d2' name=607 href="#607">607</a> 
<a class='l d2' name=608 href="#608">608</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>() {
<a class='l d2' name=609 href="#609">609</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_info">_info</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=name">name</a>;
<a class='l d2' name=610 href="#610">610</a>   },
<a class='l d2' name=611 href="#611">611</a> 
<a class='l d2' name=612 href="#612">612</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=version">version</a>() {
<a class='l d2' name=613 href="#613">613</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_info">_info</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=version">version</a>;
<a class='l d2' name=614 href="#614">614</a>   },
<a class='l d2' name=615 href="#615">615</a> 
<a class='l d2' name=616 href="#616">616</a>   <span class='c'>// for nsIObserver</span>
<a class='l d2' name=617 href="#617">617</a> <span class='c'></span>  <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=observe">observe</a>: <span class='v'>function </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=app_observe">app_observe</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aData">aData</a>) {
<a class='l d2' name=618 href="#618">618</a>     <span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a> == <span class='s'>"app-startup"</span>) {
<a class='l d2' name=619 href="#619">619</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_extensions">_extensions</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Extensions">Extensions</a>();
<a class='l d2' name=620 href="#620">620</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"load"</span>, <span class='s'>"application"</span>);
<a class='l d2' name=621 href="#621">621</a>     }
<a class='l d2' name=622 href="#622">622</a>     <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a> == <span class='s'>"final-ui-startup"</span>) {
<a class='l d2' name=623 href="#623">623</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"ready"</span>, <span class='s'>"application"</span>);
<a class='l d2' name=624 href="#624">624</a>     }
<a class='l d2' name=625 href="#625">625</a>     <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a> == <span class='s'>"quit-application-requested"</span>) {
<a class='l d2' name=626 href="#626">626</a>       <span class='c'>// we can stop the quit by checking the return value</span>
<a class='l d2' name=627 href="#627">627</a> <span class='c'></span>      <span class='v'>if </span>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"quit"</span>, <span class='s'>"application"</span>) == <span class='v'>false)</span>
<a class='l d2' name=628 href="#628">628</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aSubject">aSubject</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=data">data</a> = <span class='v'>true;</span>
<a class='l d2' name=629 href="#629">629</a>     }
<a class='l d2' name=630 href="#630">630</a>     <span class='v'>else </span><span class='v'>if </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=aTopic">aTopic</a> == <span class='s'>"xpcom-shutdown"</span>) {
<a class='l d2' name=631 href="#631">631</a> 
<a class='l d2' name=632 href="#632">632</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=dispatch">dispatch</a>(<span class='s'>"unload"</span>, <span class='s'>"application"</span>);
<a class='l d2' name=633 href="#633">633</a> 
<a class='l d2' name=634 href="#634">634</a>       <span class='c'>// call the cleanup functions and empty the array</span>
<a class='l d2' name=635 href="#635">635</a> <span class='c'></span>      <span class='v'>while </span>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=length">length</a>) {
<a class='l d2' name=636 href="#636">636</a>         <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=gShutdown">gShutdown</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=shift">shift</a>()();
<a class='l d2' name=637 href="#637">637</a>       }
<a class='l d2' name=638 href="#638">638</a> 
<a class='l d2' name=639 href="#639">639</a>       <span class='c'>// release our observers</span>
<a class='l d2' name=640 href="#640">640</a> <span class='c'></span>      <span class='v'>var </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a> = <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Components">Components</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=classes">classes</a>[<span class='s'>"@mozilla.org/observer-service;1"</span>]
<a class='l d2' name=641 href="#641">641</a>                          .<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=getService">getService</a>(<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsIObserverService">nsIObserverService</a>);
<a class='l d2' name=642 href="#642">642</a> 
<a class='l d2' name=643 href="#643">643</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeObserver">removeObserver</a>(<span class='v'>this,</span> <span class='s'>"final-ui-startup"</span>);
<a class='l d2' name=644 href="#644">644</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeObserver">removeObserver</a>(<span class='v'>this,</span> <span class='s'>"quit-application-requested"</span>);
<a class='l d2' name=645 href="#645">645</a>       <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=os">os</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=removeObserver">removeObserver</a>(<span class='v'>this,</span> <span class='s'>"xpcom-shutdown"</span>);
<a class='l d2' name=646 href="#646">646</a> 
<a class='l d2' name=647 href="#647">647</a>       <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_info">_info</a> = <span class='v'>null;
<a class='l d2' name=648 href="#648">648</a> </span>      <span class='v'>this.</span><span class='a'>_console</span> = <span class='v'>null;
<a class='l d2' name=649 href="#649">649</a> </span>      <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>null;
<a class='l d2' name=650 href="#650">650</a> </span>      <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = <span class='v'>null;
<a class='l d2' name=651 href="#651">651</a> </span>      <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>null;
<a class='l d2' name=652 href="#652">652</a> </span>      <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_extensions">_extensions</a> = <span class='v'>null;
<a class='l d2' name=653 href="#653">653</a> </span>    }
<a class='l d2' name=654 href="#654">654</a>   },
<a class='l d2' name=655 href="#655">655</a> 
<a class='l d2' name=656 href="#656">656</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=console">console</a>() {
<a class='l d2' name=657 href="#657">657</a>     <span class='v'>if </span>(<span class='v'>this.</span><span class='a'>_console</span> == <span class='v'>null)</span>
<a class='l d2' name=658 href="#658">658</a>         <span class='v'>this.</span><span class='a'>_console</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Console">Console</a>();
<a class='l d2' name=659 href="#659">659</a> 
<a class='l d2' name=660 href="#660">660</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_console</span>;
<a class='l d2' name=661 href="#661">661</a>   },
<a class='l d2' name=662 href="#662">662</a> 
<a class='l d2' name=663 href="#663">663</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=storage">storage</a>() {
<a class='l d2' name=664 href="#664">664</a>     <span class='v'>if </span>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> == <span class='v'>null)</span>
<a class='l d2' name=665 href="#665">665</a>         <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=SessionStorage">SessionStorage</a>();
<a class='l d2' name=666 href="#666">666</a> 
<a class='l d2' name=667 href="#667">667</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_storage">_storage</a>;
<a class='l d2' name=668 href="#668">668</a>   },
<a class='l d2' name=669 href="#669">669</a> 
<a class='l d2' name=670 href="#670">670</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=prefs">prefs</a>() {
<a class='l d2' name=671 href="#671">671</a>     <span class='v'>if </span>(<span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> == <span class='v'>null)</span>
<a class='l d2' name=672 href="#672">672</a>         <span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=PreferenceBranch">PreferenceBranch</a>(<span class='s'>""</span>);
<a class='l d2' name=673 href="#673">673</a> 
<a class='l d2' name=674 href="#674">674</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_prefs">_prefs</a>;
<a class='l d2' name=675 href="#675">675</a>   },
<a class='l d2' name=676 href="#676">676</a> 
<a class='l d2' name=677 href="#677">677</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extensions">extensions</a>() {
<a class='l d2' name=678 href="#678">678</a>     <span class='v'>return </span><span class='v'>this.</span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=_extensions">_extensions</a>;
<a class='l d2' name=679 href="#679">679</a>   },
<a class='l d2' name=680 href="#680">680</a> 
<a class='l d2' name=681 href="#681">681</a>   <span class='v'>get </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=events">events</a>() {
<a class='l d2' name=682 href="#682">682</a>     <span class='v'>if </span>(<span class='v'>this.</span><span class='a'>_events</span> == <span class='v'>null)</span>
<a class='l d2' name=683 href="#683">683</a>         <span class='v'>this.</span><span class='a'>_events</span> = <span class='v'>new </span><a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Events">Events</a>();
<a class='l d2' name=684 href="#684">684</a> 
<a class='l d2' name=685 href="#685">685</a>     <span class='v'>return </span><span class='v'>this.</span><span class='a'>_events</span>;
<a class='l d2' name=686 href="#686">686</a>   },
<a class='l d2' name=687 href="#687">687</a> 
<a class='l d2' name=688 href="#688">688</a>   <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=QueryInterface">QueryInterface</a> : <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=XPCOMUtils">XPCOMUtils</a>.<span class='a'>generateQI</span>([<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=extIApplication">extIApplication</a>, <a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=Ci">Ci</a>.<a class="d" href="http://lxr.mozilla.org/mozilla/ident?i=nsISupportsWeakReference">nsISupportsWeakReference</a>])
<a class='l d2' name=689 href="#689">689</a> };
<a class='l d2' name=690 href="#690">690</a> </span></pre>

<!-- Mirrored from lxr.mozilla.org/mozilla/source/toolkit/components/exthelper/extApplication.js by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 May 2016 20:00:12 GMT -->
</html>
