<html><!-- Mirrored from mdn.mozillademos.org/es/docs/Web/JavaScript/Referencia/Objetos_globales/Promesa$samples/Creando_una_Promesa?revision=902227 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 01 Oct 2015 17:48:48 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->

        <link rel="stylesheet" type="text/css" href="../../../../../../../../developer.mozilla.org/en-US/docs/Template_CustomSampleCSS2af1.css?raw=1">
            </head>
    <body>
                            <script type="text/javascript">
                'use strict';

// A-> la función $http se implementa con el fin de seguir el modelo de Adapter estándar
function $http(url){
 
  // Un pequeño ejemplo de objeto
  var core = {

    // Método que realiza la petición AJAX
    ajax : function (method, url, args) {

      // Creando una promesa.
      var promise = new Promise( function (resolve, reject) {

        // Instancia XMLHttpRequest
        var client = new XMLHttpRequest();
        var uri = url;

        if (args && (method === 'POST' || method === 'PUT')) {
          uri += '?';
          var argcount = 0;
          for (var key in args) {
            if (args.hasOwnProperty(key)) {
              if (argcount++) {
                uri += '&';
              }
              uri += encodeURIComponent(key) + '=' + encodeURIComponent(args[key]);
            }
          }
        }

        client.open(method, uri);
        client.send();

        client.onload = function () {
          if (this.status == 200) {
            // Realiza la función "resolver" cuando this.status es igual a 200
            resolve(this.response);
          } else {
            // Realiza la función "rechazar" when this.status es diferente de 200
            reject(this.statusText);
          }
        };
        client.onerror = function () {
          reject(this.statusText);
        };
      });

      // Return the promise
      return promise;
    }
  };

  // Patrón Adapter
  return {
    'get' : function(args) {
      return core.ajax('GET', url, args);
    },
    'post' : function(args) {
      return core.ajax('POST', url, args);
    },
    'put' : function(args) {
      return core.ajax('PUT', url, args);
    },
    'delete' : function(args) {
      return core.ajax('DELETE', url, args);
    }
  };
};
// Fin A

// B-> Aquí se definen sus funciones y su playload
var mdnAPI = 'https://developer.mozilla.org/en-US/search.json';
var payload = {
  'topic' : 'js',
  'q'     : 'Promise'
};

var callback = {
  success : function(data){
     console.log(1, 'success', JSON.parse(data));
  },
  error : function(data){
     console.log(2, 'error', JSON.parse(data));
  }
};
// Fin B

// Ejecutra la llamada al método
$http(mdnAPI)
  .get(payload)
  .then(callback.success)
  .catch(callback.error);
            </script>
            

<!-- Mirrored from mdn.mozillademos.org/es/docs/Web/JavaScript/Referencia/Objetos_globales/Promesa$samples/Creando_una_Promesa?revision=902227 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 01 Oct 2015 17:48:48 GMT -->
</body></html>