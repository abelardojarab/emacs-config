<html><!-- Mirrored from stat.ethz.ch/R-manual/R-patched/RHOME/library/mgcv/html/ziP.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 17 Aug 2015 05:32:39 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><!-- /Added by HTTrack -->
<title>GAM zero-inflated Poisson regression family</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">
</head><body>

<table width="100%" summary="page for ziP {mgcv}"><tbody><tr><td>ziP {mgcv}</td><td style="text-align: right;">R Documentation</td></tr></tbody></table>

<h2>GAM zero-inflated Poisson regression family</h2>

<h3>Description</h3>

<p>Family for use with <code><a href="gam.html">gam</a></code>, implementing regression for zero inflated Poisson data
when the complinetart log log of the zero probability is linearly dependent on the log of the Poisson parameter. Use with care, 
noting that simply having many zero response observations is not an indication of zero inflation: the question is whether you have too many zeroes given the specified model.  
</p>


<h3>Usage</h3>

<pre>ziP(theta = NULL, link = "identity")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tbody><tr valign="top"><td><code>theta</code></td>
<td>
<p>the 2 parameters controlling the slope and intercept of the 
linear transform of the mean controlling the zero inflation rate. If supplied (and second element is positive) 
then treated as fixed parameters (<i>theta_1</i> and <i>exp(theta_2)</i>), otherwise estimated. If supplied and second element is negative then treated as starting values (with sign of second element reversed).</p>
</td></tr>
<tr valign="top"><td><code>link</code></td>
<td>
<p>The link function: only the <code>"identity"</code> is currently supported.</p>
</td></tr>
</tbody></table>


<h3>Details</h3>

<p>The probability of a zero count is given by <i>1- p</i>, whereas the probability of
count <i>y&gt;0</i> is given by the truncated Poisson probability function <i>(pmu^y/((exp(mu)-1)y!)</i>. The linear predictor 
gives <i>log(mu)</i>, while <i>eta=log(-log(1-p))</i> and <i>eta = theta_1 + exp(theta_2) log(mu)</i>. The <code>theta</code> parameters are estimated alongside the smoothing parameters.
</p>
<p>Note that the fitted values for this model are the log of the Poisson parameter. Use the <code>predict</code> function with <code>type=="response"</code> to get the predicted expected response.
</p>


<h3>Value</h3>

<p>An object of class <code>extended.family</code>.
</p>


<h3>WARNINGS </h3>

<p>Zero inflated models are often over-used. Having lots of zeroes in the data does not in itself imply zero inflation. Having too many zeroes *given the model mean* may imply zero inflation. 
</p>


<h3>Author(s)</h3>

<p> Simon N. Wood simon.wood@r-project.org
</p>


<h3>See Also</h3>

<p><code><a href="ziplss.html">ziplss</a></code></p>


<h3>Examples</h3>

<pre>
rzip &lt;- function(gamma,theta= c(-2,.3)) {
## generate zero inflated Poisson random variables, where 
## lambda = exp(gamma), eta = theta[1] + exp(theta[2])*gamma
## and 1-p = exp(-exp(eta)).
   y &lt;- gamma; n &lt;- length(y)
   lambda &lt;- exp(gamma)
   eta &lt;- theta[1] + exp(theta[2])*gamma
   p &lt;- 1- exp(-exp(eta))
   ind &lt;- p &gt; runif(n)
   y[!ind] &lt;- 0
   np &lt;- sum(ind)
   ## generate from zero truncated Poisson, given presence...
   y[ind] &lt;- qpois(runif(np,dpois(0,lambda[ind]),1),lambda[ind])
   y
} 

library(mgcv)
## Simulate some beta data...
set.seed(1);n&lt;-400
dat &lt;- gamSim(1,n=n)
dat$y &lt;- rzip(dat$f/4-1)

b &lt;- gam(y~s(x0)+s(x1)+s(x2)+s(x3),family=ziP(),data=dat)
b$outer.info ## check convergence!!
b
plot(b,pages=1)
## plot deviance residuals against expected response
plot(predict(b,type="response"),residuals(b))

</pre>

<hr><div style="text-align: center;">[Package <em>mgcv</em> version 1.8-7 <a href="00Index.html">Index</a>]</div>

<!-- Mirrored from stat.ethz.ch/R-manual/R-patched/RHOME/library/mgcv/html/ziP.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 17 Aug 2015 05:32:39 GMT -->

</body></html>