<html><head>
    <meta charset="utf-8">
    
    <title>scipy.stats.binned_statistic</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.16.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="top" title="SciPy v0.16.0 Reference Guide" href="../index.html">
    <link rel="up" title="Statistical functions (scipy.stats)" href="../stats.html">
    <link rel="next" title="scipy.stats.binned_statistic_2d" href="scipy.stats.binned_statistic_2d.html">
    <link rel="prev" title="scipy.stats.relfreq" href="scipy.stats.relfreq.html"> 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v0.16.0 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" accesskey="U">Statistical functions (<tt class="docutils literal"><span class="pre">scipy.stats</span></tt>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index" accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index">modules</a>
      </li>
      <li class="active">
        <a href="../scipy-optimize-modindex.html" title="Python Module Index">modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.binned_statistic_2d.html" title="scipy.stats.binned_statistic_2d" accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.relfreq.html" title="scipy.stats.relfreq" accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.relfreq.html" title="previous chapter">scipy.stats.relfreq</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.binned_statistic_2d.html" title="next chapter">scipy.stats.binned_statistic_2d</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-binned-statistic">
<h1>scipy.stats.binned_statistic<a class="headerlink" href="#scipy-stats-binned-statistic" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<a class="dashAnchor" name="//apple_ref/Function/scipy.stats.binned_statistic"></a><dt id="scipy.stats.binned_statistic">
<tt class="descclassname">scipy.stats.</tt><tt class="descname">binned_statistic</tt><big>(</big><em>x</em>, <em>values</em>, <em>statistic='mean'</em>, <em>bins=10</em>, <em>range=None</em><big>)</big><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.16.0/scipy/stats/_binned_statistic.py#L9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.stats.binned_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a binned statistic for a set of data.</p>
<p>This is a generalization of a histogram function.  A histogram divides
the space into bins, and returns the count of the number of points in
each bin.  This function allows the computation of the sum, mean, median,
or other statistic of the values within each bin.</p>
<table class="docutils field-list" frame="void" rules="none">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>A sequence of values to be binned.</p>
</div></blockquote>
<p><strong>values</strong> : array_like</p>
<blockquote>
<div><p>The values on which the statistic will be computed.  This must be
the same shape as <em class="xref py py-obj">x</em>.</p>
</div></blockquote>
<p><strong>statistic</strong> : string or callable, optional</p>
<blockquote>
<div><p>The statistic to compute (default is ‘mean’).
The following statistics are available:</p>
<blockquote>
<div><ul class="simple">
<li>‘mean’ : compute the mean of values for points within each bin.
Empty bins will be represented by NaN.</li>
<li>‘median’ : compute the median of values for points within each
bin. Empty bins will be represented by NaN.</li>
<li>‘count’ : compute the count of points within each bin.  This is
identical to an unweighted histogram.  <em class="xref py py-obj">values</em> array is not
referenced.</li>
<li>‘sum’ : compute the sum of values for points within each bin.
This is identical to a weighted histogram.</li>
<li>function : a user-defined function which takes a 1D array of
values, and outputs a single numerical statistic. This function
will be called on the values in each bin.  Empty bins will be
represented by function([]), or NaN if this returns an error.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>bins</strong> : int or sequence of scalars, optional</p>
<blockquote>
<div><p>If <em class="xref py py-obj">bins</em> is an int, it defines the number of equal-width bins in the
given range (10 by default).  If <em class="xref py py-obj">bins</em> is a sequence, it defines the
bin edges, including the rightmost edge, allowing for non-uniform bin
widths.  Values in <em class="xref py py-obj">x</em> that are smaller than lowest bin edge are
assigned to bin number 0, values beyond the highest bin are assigned to
<tt class="docutils literal"><span class="pre">bins[-1]</span></tt>.</p>
</div></blockquote>
<p><strong>range</strong> : (float, float) or [(float, float)], optional</p>
<blockquote>
<div><p>The lower and upper range of the bins.  If not provided, range
is simply <tt class="docutils literal"><span class="pre">(x.min(),</span> <span class="pre">x.max())</span></tt>.  Values outside the range are
ignored.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>statistic</strong> : array</p>
<blockquote>
<div><p>The values of the selected statistic in each bin.</p>
</div></blockquote>
<p><strong>bin_edges</strong> : array of dtype float</p>
<blockquote>
<div><p>Return the bin edges <tt class="docutils literal"><span class="pre">(length(statistic)+1)</span></tt>.</p>
</div></blockquote>
<p><strong>binnumber</strong> : 1-D ndarray of ints</p>
<blockquote class="last">
<div><p>This assigns to each observation an integer that represents the bin
in which this observation falls. Array has the same length as values.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html#numpy.histogram" title="(in NumPy v1.9)"><tt class="xref py py-obj docutils literal"><span class="pre">numpy.histogram</span></tt></a>, <a class="reference internal" href="scipy.stats.binned_statistic_2d.html#scipy.stats.binned_statistic_2d" title="scipy.stats.binned_statistic_2d"><tt class="xref py py-obj docutils literal"><span class="pre">binned_statistic_2d</span></tt></a>, <a class="reference internal" href="scipy.stats.binned_statistic_dd.html#scipy.stats.binned_statistic_dd" title="scipy.stats.binned_statistic_dd"><tt class="xref py py-obj docutils literal"><span class="pre">binned_statistic_dd</span></tt></a></p>
</div>
<p class="rubric">Notes</p>
<p>All but the last (righthand-most) bin is half-open.  In other words, if
<em class="xref py py-obj">bins</em> is <tt class="docutils literal"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4]</span></tt>, then the first bin is <tt class="docutils literal"><span class="pre">[1,</span> <span class="pre">2)</span></tt> (including 1,
but excluding 2) and the second <tt class="docutils literal"><span class="pre">[2,</span> <span class="pre">3)</span></tt>.  The last bin, however, is
<tt class="docutils literal"><span class="pre">[3,</span> <span class="pre">4]</span></tt>, which <em>includes</em> 4.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>First a basic example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">bins</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(array([ 1.,  2.,  4.]), array([ 1.,  2.,  3.,  4.]), array([1, 2, 1, 2, 3]))</span>
</pre></div>
</div>
<p>As a second example, we now generate some random data of sailing boat speed
as a function of wind speed, and then determine how fast our boat is for
certain wind speeds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">windspeed</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boatspeed</span> <span class="o">=</span> <span class="o">.</span><span class="mi">3</span> <span class="o">*</span> <span class="n">windspeed</span><span class="o">**.</span><span class="mi">5</span> <span class="o">+</span> <span class="o">.</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bin_means</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">binnumber</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic</span><span class="p">(</span><span class="n">windspeed</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">boatspeed</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'median'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">windspeed</span><span class="p">,</span> <span class="n">boatspeed</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'raw data'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">bin_means</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">colors</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">label</span><span class="o">=</span><span class="s">'binned statistic of data'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we can use <tt class="docutils literal"><span class="pre">binnumber</span></tt> to select all datapoints with a windspeed
below 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">low_boatspeed</span> <span class="o">=</span> <span class="n">boatspeed</span><span class="p">[</span><span class="n">binnumber</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>As a final example, we will use <tt class="docutils literal"><span class="pre">bin_edges</span></tt> and <tt class="docutils literal"><span class="pre">binnumber</span></tt> to make a
plot of a distribution that shows the mean and distribution around that
mean per bin, on top of a regular histogram and the probability
distribution function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_pdf</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">maxwell</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">maxwell</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bin_means</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">binnumber</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binned_statistic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_pdf</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">statistic</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bin_width</span> <span class="o">=</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bin_centers</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">bin_width</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">'stepfilled'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">label</span><span class="o">=</span><span class="s">'histogram of data'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_pdf</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'analytical pdf'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">bin_means</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">colors</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">label</span><span class="o">=</span><span class="s">'binned statistic of data'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">binnumber</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">bin_width</span><span class="p">,</span> <span class="n">x_pdf</span><span class="p">,</span> <span class="s">'g.'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../generated/scipy-stats-binned_statistic-1.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/scipy-stats-binned_statistic-1_00.png" src="../_images/scipy-stats-binned_statistic-1_00.png">
</div>
<div class="figure">
<img alt="../_images/scipy-stats-binned_statistic-1_01.png" src="../_images/scipy-stats-binned_statistic-1_01.png">
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        © Copyright 2008-2014, The Scipy community.
      </li>
      <li>
      Last updated on Jul 24, 2015.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  
</body></html>