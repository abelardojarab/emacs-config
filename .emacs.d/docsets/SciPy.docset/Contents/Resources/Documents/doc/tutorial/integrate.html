<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Integration (scipy.integrate)</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.16.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="top" title="SciPy v0.16.0 Reference Guide" href="../index.html" >
    <link rel="up" title="SciPy Tutorial" href="index.html" >
    <link rel="next" title="Optimization (scipy.optimize)" href="optimize.html" >
    <link rel="prev" title="Special functions (scipy.special)" href="special.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v0.16.0 Reference Guide</a></li>
	
          <li class="active"><a href="index.html" accesskey="U">SciPy Tutorial</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="../scipy-optimize-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="optimize.html" title="Optimization (scipy.optimize)"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="special.html" title="Special functions (scipy.special)"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Integration (<tt class="docutils literal"><span class="pre">scipy.integrate</span></tt>)</a><ul>
<li><a class="reference internal" href="#general-integration-quad">General integration (<tt class="docutils literal"><span class="pre">quad</span></tt>)</a></li>
<li><a class="reference internal" href="#general-multiple-integration-dblquad-tplquad-nquad">General multiple integration (<tt class="docutils literal"><span class="pre">dblquad</span></tt>, <tt class="docutils literal"><span class="pre">tplquad</span></tt>, <tt class="docutils literal"><span class="pre">nquad</span></tt>)</a></li>
<li><a class="reference internal" href="#gaussian-quadrature">Gaussian quadrature</a></li>
<li><a class="reference internal" href="#romberg-integration">Romberg Integration</a></li>
<li><a class="reference internal" href="#integrating-using-samples">Integrating using Samples</a></li>
<li><a class="reference internal" href="#faster-integration-using-ctypes">Faster integration using Ctypes</a></li>
<li><a class="reference internal" href="#ordinary-differential-equations-odeint">Ordinary differential equations (<tt class="docutils literal"><span class="pre">odeint</span></tt>)</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="special.html"
                        title="previous chapter">Special functions (<tt class="docutils literal"><span class="pre">scipy.special</span></tt>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="optimize.html"
                        title="next chapter">Optimization (<tt class="docutils literal"><span class="pre">scipy.optimize</span></tt>)</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="integration-scipy-integrate">
<h1>Integration (<a class="reference internal" href="../integrate.html#module-scipy.integrate" title="scipy.integrate"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a>)<a class="headerlink" href="#integration-scipy-integrate" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="../integrate.html#module-scipy.integrate" title="scipy.integrate"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.integrate</span></tt></a> sub-package provides several integration
techniques including an ordinary differential equation integrator. An
overview of the module is provided by the help command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">integrate</span><span class="p">)</span>
<span class="go"> Methods for Integrating Functions given function object.</span>

<span class="go">   quad          -- General purpose integration.</span>
<span class="go">   dblquad       -- General purpose double integration.</span>
<span class="go">   tplquad       -- General purpose triple integration.</span>
<span class="go">   fixed_quad    -- Integrate func(x) using Gaussian quadrature of order n.</span>
<span class="go">   quadrature    -- Integrate with given tolerance using Gaussian quadrature.</span>
<span class="go">   romberg       -- Integrate func using Romberg integration.</span>

<span class="go"> Methods for Integrating Functions given fixed samples.</span>

<span class="go">   trapz         -- Use trapezoidal rule to compute integral from samples.</span>
<span class="go">   cumtrapz      -- Use trapezoidal rule to cumulatively compute integral.</span>
<span class="go">   simps         -- Use Simpson&#39;s rule to compute integral from samples.</span>
<span class="go">   romb          -- Use Romberg Integration to compute integral from</span>
<span class="go">                    (2**k + 1) evenly-spaced samples.</span>

<span class="go">   See the special module&#39;s orthogonal polynomials (special) for Gaussian</span>
<span class="go">      quadrature roots and weights for other weighting factors and regions.</span>

<span class="go"> Interface to numerical integrators of ODE systems.</span>

<span class="go">   odeint        -- General integration of ordinary differential equations.</span>
<span class="go">   ode           -- Integrate ODE using VODE and ZVODE routines.</span>
</pre></div>
</div>
<div class="section" id="general-integration-quad">
<h2>General integration (<a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-func docutils literal"><span class="pre">quad</span></tt></a>)<a class="headerlink" href="#general-integration-quad" title="Permalink to this headline">¶</a></h2>
<p>The function <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a> is provided to integrate a function of one
variable between two points. The points can be <span class="math">\(\pm\infty\)</span>
(<span class="math">\(\pm\)</span> <tt class="docutils literal"><span class="pre">inf</span></tt>) to indicate infinite limits. For example,
suppose you wish to integrate a bessel function <tt class="docutils literal"><span class="pre">jv(2.5,x)</span></tt> along
the interval <span class="math">\([0,4.5].\)</span></p>
<div class="math">
\[I=\int_{0}^{4.5}J_{2.5}\left(x\right)\, dx.\]</div>
<p>This could be computed using <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">special</span><span class="o">.</span><span class="n">jv</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">result</span>
<span class="go">(1.1178179380783249, 7.8663172481899801e-09)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">18.0</span><span class="o">/</span><span class="mi">27</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span><span class="o">-</span><span class="mf">4.0</span><span class="o">/</span><span class="mi">27</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mf">4.5</span><span class="p">)</span><span class="o">+</span>
<span class="go">    sqrt(2*pi)*special.fresnel(3/sqrt(pi))[0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I</span>
<span class="go">1.117817938088701</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">I</span><span class="p">)</span>
<span class="go">1.03761443881e-11</span>
</pre></div>
</div>
<p>The first argument to quad is a &#8220;callable&#8221; Python object (<em>i.e</em> a
function, method, or class instance). Notice the use of a lambda-
function in this case as the argument. The next two arguments are the
limits of integration. The return value is a tuple, with the first
element holding the estimated value of the integral and the second
element holding an upper bound on the error. Notice, that in this
case, the true value of this integral is</p>
<div class="math">
\[I=\sqrt{\frac{2}{\pi}}\left(\frac{18}{27}\sqrt{2}\cos\left(4.5\right)-\frac{4}{27}\sqrt{2}\sin\left(4.5\right)+\sqrt{2\pi}\textrm{Si}\left(\frac{3}{\sqrt{\pi}}\right)\right),\]</div>
<p>where</p>
<div class="math">
\[\textrm{Si}\left(x\right)=\int_{0}^{x}\sin\left(\frac{\pi}{2}t^{2}\right)\, dt.\]</div>
<p>is the Fresnel sine integral. Note that the numerically-computed integral is
within <span class="math">\(1.04\times10^{-11}\)</span> of the exact result &#8212; well below the
reported error bound.</p>
<p>If the function to integrate takes additional parameters, the can be provided
in the <em class="xref py py-obj">args</em> argument. Suppose that the following integral shall be calculated:</p>
<div class="math">
\[I(a,b)=\int_{0}^{1} ax^2+b \, dx.\]</div>
<p>This integral can be evaluated by using the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.220446049250313e-14</span><span class="p">)</span>
</pre></div>
</div>
<p>Infinite inputs are also allowed in <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a> by using <span class="math">\(\pm\)</span>
<tt class="docutils literal"><span class="pre">inf</span></tt> as one of the arguments. For example, suppose that a numerical
value for the exponential integral:</p>
<div class="math">
\[E_{n}\left(x\right)=\int_{1}^{\infty}\frac{e^{-xt}}{t^{n}}\, dt.\]</div>
<p>is desired (and the fact that this integral can be computed as
<tt class="docutils literal"><span class="pre">special.expn(n,x)</span></tt> is forgotten). The functionality of the function
<tt class="xref py py-obj docutils literal"><span class="pre">special.expn</span></tt> can be replicated by defining a new function
<tt class="xref py py-obj docutils literal"><span class="pre">vec_expint</span></tt> based on the routine <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">integrand</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">t</span><span class="o">**</span><span class="n">n</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">expint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Inf</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_expint</span> <span class="o">=</span> <span class="n">vectorize</span><span class="p">(</span><span class="n">expint</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_expint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([ 0.1097,  0.0567,  0.0301,  0.0163,  0.0089,  0.0049])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">special</span><span class="o">.</span><span class="n">expn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([ 0.1097,  0.0567,  0.0301,  0.0163,  0.0089,  0.0049])</span>
</pre></div>
</div>
<p>The function which is integrated can even use the quad argument (though the
error bound may underestimate the error due to possible numerical error in the
integrand from the use of <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a> ). The integral in this case is</p>
<div class="math">
\[I_{n}=\int_{0}^{\infty}\int_{1}^{\infty}\frac{e^{-xt}}{t^{n}}\, dt\, dx=\frac{1}{n}.\]</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">expint</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">result</span>
<span class="go">(0.33333333324560266, 2.8548934485373678e-09)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">I3</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I3</span>
<span class="go">0.333333333333</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I3</span> <span class="o">-</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">8.77306560731e-11</span>
</pre></div>
</div>
<p>This last example shows that multiple integration can be handled using
repeated calls to <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-func docutils literal"><span class="pre">quad</span></tt></a>.</p>
</div>
<div class="section" id="general-multiple-integration-dblquad-tplquad-nquad">
<h2>General multiple integration (<a class="reference internal" href="../generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad" title="scipy.integrate.dblquad"><tt class="xref py py-func docutils literal"><span class="pre">dblquad</span></tt></a>, <a class="reference internal" href="../generated/scipy.integrate.tplquad.html#scipy.integrate.tplquad" title="scipy.integrate.tplquad"><tt class="xref py py-func docutils literal"><span class="pre">tplquad</span></tt></a>, <a class="reference internal" href="../generated/scipy.integrate.nquad.html#scipy.integrate.nquad" title="scipy.integrate.nquad"><tt class="xref py py-func docutils literal"><span class="pre">nquad</span></tt></a>)<a class="headerlink" href="#general-multiple-integration-dblquad-tplquad-nquad" title="Permalink to this headline">¶</a></h2>
<p>The mechanics for double and triple integration have been wrapped up into the
functions <a class="reference internal" href="../generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad" title="scipy.integrate.dblquad"><tt class="xref py py-obj docutils literal"><span class="pre">dblquad</span></tt></a> and <a class="reference internal" href="../generated/scipy.integrate.tplquad.html#scipy.integrate.tplquad" title="scipy.integrate.tplquad"><tt class="xref py py-obj docutils literal"><span class="pre">tplquad</span></tt></a>. These functions take the function
to  integrate and four, or six arguments, respecively. The limits of all
inner integrals need to be defined as functions.</p>
<p>An example of using double integration to compute several values of
<span class="math">\(I_{n}\)</span> is shown below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span><span class="p">,</span> <span class="n">dblquad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">I</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">dblquad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">t</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Inf</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Inf</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(0.25000000000435768, 1.0518245707751597e-09)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(0.33333333325010883, 2.8604069919261191e-09)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">I</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0.49999999999857514, 1.8855523253868967e-09)</span>
</pre></div>
</div>
<p>As example for non-constant limits consider the integral</p>
<div class="math">
\[I=\int_{y=0}^{1/2}\int_{x=0}^{1-2y} x y \, dx\, dy=\frac{1}{96}.\]</div>
<p>This integral can be evaluated using the expression below (Note the use of the
non-constant lambda functions for the upper limit of the inner integral):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">dblquad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="n">dblquad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">(0.010416666666666668, 1.1564823173178715e-16)</span>
</pre></div>
</div>
<p>For n-fold integration, scipy provides the function <a class="reference internal" href="../generated/scipy.integrate.nquad.html#scipy.integrate.nquad" title="scipy.integrate.nquad"><tt class="xref py py-obj docutils literal"><span class="pre">nquad</span></tt></a>. The
integration bounds are an iterable object: either a list of constant bounds,
or a list of functions for the non-constant integration bounds. The order of
integration (and therefore the bounds) is from the innermost integral to the
outermost one.</p>
<p>The integral from above</p>
<div class="math">
\[I_{n}=\int_{0}^{\infty}\int_{1}^{\infty}\frac{e^{-xt}}{t^{n}}\, dt\, dx=\frac{1}{n}\]</div>
<p>can be calculated as</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">t</span><span class="o">**</span><span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="o">.</span><span class="n">nquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]])</span>
<span class="go">(0.20000000000002294, 1.2239614263187945e-08)</span>
</pre></div>
</div>
<p>Note that the order of arguments for <em class="xref py py-obj">f</em> must match the order of the
integration bounds; i.e. the inner integral with respect to <span class="math">\(t\)</span> is on
the interval <span class="math">\([1, \infty]\)</span> and the outer integral with respect to
<span class="math">\(x\)</span> is on the interval <span class="math">\([0, \infty]\)</span>.</p>
<p>Non-constant integration bounds can be treated in a similar manner; the
example from above</p>
<div class="math">
\[I=\int_{y=0}^{1/2}\int_{x=0}^{1-2y} x y \, dx\, dy=\frac{1}{96}.\]</div>
<p>can be evaluated by means of</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">bounds_y</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">bounds_x</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="o">.</span><span class="n">nquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">bounds_x</span><span class="p">,</span> <span class="n">bounds_y</span><span class="p">])</span>
<span class="go">(0.010416666666666668, 4.101620128472366e-16)</span>
</pre></div>
</div>
<p>which is the same result as before.</p>
</div>
<div class="section" id="gaussian-quadrature">
<h2>Gaussian quadrature<a class="headerlink" href="#gaussian-quadrature" title="Permalink to this headline">¶</a></h2>
<p>A few functions are also provided in order to perform simple Gaussian
quadrature over a fixed interval. The first is <a class="reference internal" href="../generated/scipy.integrate.fixed_quad.html#scipy.integrate.fixed_quad" title="scipy.integrate.fixed_quad"><tt class="xref py py-obj docutils literal"><span class="pre">fixed_quad</span></tt></a> which
performs fixed-order Gaussian quadrature. The second function is
<a class="reference internal" href="../generated/scipy.integrate.quadrature.html#scipy.integrate.quadrature" title="scipy.integrate.quadrature"><tt class="xref py py-obj docutils literal"><span class="pre">quadrature</span></tt></a> which performs Gaussian quadrature of multiple
orders until the difference in the integral estimate is beneath some
tolerance supplied by the user. These functions both use the module
<tt class="xref py py-mod docutils literal"><span class="pre">special.orthogonal</span></tt> which can calculate the roots and quadrature
weights of a large variety of orthogonal polynomials (the polynomials
themselves are available as special functions returning instances of
the polynomial class &#8212; e.g. <a class="reference internal" href="../generated/scipy.special.legendre.html#scipy.special.legendre" title="scipy.special.legendre"><tt class="xref py py-obj docutils literal"><span class="pre">special.legendre</span></tt></a>).</p>
</div>
<div class="section" id="romberg-integration">
<h2>Romberg Integration<a class="headerlink" href="#romberg-integration" title="Permalink to this headline">¶</a></h2>
<p>Romberg&#8217;s method <a class="reference internal" href="#wpr" id="id1">[WPR]</a> is another method for numerically evaluating an
integral. See the help function for <a class="reference internal" href="../generated/scipy.integrate.romberg.html#scipy.integrate.romberg" title="scipy.integrate.romberg"><tt class="xref py py-func docutils literal"><span class="pre">romberg</span></tt></a> for further details.</p>
</div>
<div class="section" id="integrating-using-samples">
<h2>Integrating using Samples<a class="headerlink" href="#integrating-using-samples" title="Permalink to this headline">¶</a></h2>
<p>If the samples are equally-spaced and the number of samples available
is <span class="math">\(2^{k}+1\)</span> for some integer <span class="math">\(k\)</span>, then Romberg <a class="reference internal" href="../generated/scipy.integrate.romb.html#scipy.integrate.romb" title="scipy.integrate.romb"><tt class="xref py py-obj docutils literal"><span class="pre">romb</span></tt></a>
integration can be used to obtain high-precision estimates of the
integral using the available samples. Romberg integration uses the
trapezoid rule at step-sizes related by a power of two and then
performs Richardson extrapolation on these estimates to approximate
the integral with a higher-degree of accuracy.</p>
<p>In case of arbitrary spaced samples, the two functions trapz (defined in numpy
<a class="reference internal" href="#npt" id="id2">[NPT]</a>) and <a class="reference internal" href="../generated/scipy.integrate.simps.html#scipy.integrate.simps" title="scipy.integrate.simps"><tt class="xref py py-obj docutils literal"><span class="pre">simps</span></tt></a> are available. They are using Newton-Coates formulas
of order 1 and 2 respectively to perform integration. The trapezoidal rule
approximates the function as a straight line between adjacent points, while
Simpson&#8217;s rule approximates the function between three adjacent points as a
parabola.</p>
<p>For an odd number of samples that are equally spaced Simpson&#8217;s rule is exact
if the function is a polynomial of order 3 or less. If the samples are not
equally spaced, then the result is exact only if the function is a polynomial
of order 2 or less.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I1</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span>
<span class="go">21.0</span>
</pre></div>
</div>
<p>This corresponds exactly to</p>
<div class="math">
\[\int_{1}^{4} x^2 \, dx = 21,\]</div>
<p>whereas integrating the second function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I2</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">I2</span><span class="p">)</span>
<span class="go">61.5</span>
</pre></div>
</div>
<p>does not correspond to</p>
<div class="math">
\[\int_{1}^{4} x^3 \, dx = 63.75\]</div>
<p>because the order of the polynomial in f2 is larger than two.</p>
</div>
<div class="section" id="faster-integration-using-ctypes">
<h2>Faster integration using Ctypes<a class="headerlink" href="#faster-integration-using-ctypes" title="Permalink to this headline">¶</a></h2>
<p>A user desiring reduced integration times may pass a C function pointer through
<a class="reference external" href="http://docs.python.org/dev/library/ctypes.html#module-ctypes" title="(in Python v3.6)"><tt class="xref py py-obj docutils literal"><span class="pre">ctypes</span></tt></a> to <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a>, <a class="reference internal" href="../generated/scipy.integrate.dblquad.html#scipy.integrate.dblquad" title="scipy.integrate.dblquad"><tt class="xref py py-obj docutils literal"><span class="pre">dblquad</span></tt></a>, <a class="reference internal" href="../generated/scipy.integrate.tplquad.html#scipy.integrate.tplquad" title="scipy.integrate.tplquad"><tt class="xref py py-obj docutils literal"><span class="pre">tplquad</span></tt></a> or <a class="reference internal" href="../generated/scipy.integrate.nquad.html#scipy.integrate.nquad" title="scipy.integrate.nquad"><tt class="xref py py-obj docutils literal"><span class="pre">nquad</span></tt></a> and it will be integrated
and return a result in Python.  The performance increase here arises from two
factors.  The primary improvement is faster function evaluation, which is
provided by compilation.  This can also be achieved using a library like Cython
or F2Py that compiles Python.  Additionally we have a speedup provided by the
removal of function calls between C and Python in <a class="reference internal" href="../generated/scipy.integrate.quad.html#scipy.integrate.quad" title="scipy.integrate.quad"><tt class="xref py py-obj docutils literal"><span class="pre">quad</span></tt></a> - this cannot be
achieved through Cython or F2Py.  This method will provide a speed increase of
~2x for trivial functions such as sine but can produce a much more noticeable
increase (10x+) for more complex functions.  This feature then, is geared
towards a user with numerically intensive integrations willing to write a
little C to reduce computation time significantly.</p>
<p><a class="reference external" href="http://docs.python.org/dev/library/ctypes.html#module-ctypes" title="(in Python v3.6)"><tt class="xref py py-obj docutils literal"><span class="pre">ctypes</span></tt></a> integration can be done in a few simple steps:</p>
<p>1.) Write an integrand function in C with the function signature
<tt class="docutils literal"><span class="pre">double</span> <span class="pre">f(int</span> <span class="pre">n,</span> <span class="pre">double</span> <span class="pre">args[n])</span></tt>, where <tt class="docutils literal"><span class="pre">args</span></tt> is an array containing the
arguments of the function f.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="c1">//testlib.c</span>
<span class="kt">double</span> <span class="nf">f</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">double</span> <span class="n">args</span><span class="p">[</span><span class="n">n</span><span class="p">]){</span>
    <span class="k">return</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="c1">//corresponds to x0 - x1 * x2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>2.) Now compile this file to a shared/dynamic library (a quick search will help
with this as it is OS-dependent). The user must link any math libraries,
etc. used.  On linux this looks like:</p>
<div class="highlight-python"><div class="highlight"><pre>$ gcc -shared -o testlib.so -fPIC testlib.c
</pre></div>
</div>
<p>The output library will be referred to as <tt class="docutils literal"><span class="pre">testlib.so</span></tt>, but it may have a
different file extension. A library has now been created that can be loaded
into Python with <a class="reference external" href="http://docs.python.org/dev/library/ctypes.html#module-ctypes" title="(in Python v3.6)"><tt class="xref py py-obj docutils literal"><span class="pre">ctypes</span></tt></a>.</p>
<p>3.) Load shared library into Python using <a class="reference external" href="http://docs.python.org/dev/library/ctypes.html#module-ctypes" title="(in Python v3.6)"><tt class="xref py py-obj docutils literal"><span class="pre">ctypes</span></tt></a> and set <tt class="docutils literal"><span class="pre">restypes</span></tt> and
<tt class="docutils literal"><span class="pre">argtypes</span></tt> - this allows Scipy to interpret the function correctly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ctypes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lib</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">CDLL</span><span class="p">(</span><span class="s">&#39;/**/testlib.so&#39;</span><span class="p">)</span> <span class="c"># Use absolute path to testlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">f</span> <span class="c"># Assign specific function to name func (for simplicity)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="o">.</span><span class="n">restype</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="o">.</span><span class="n">argtypes</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the <tt class="docutils literal"><span class="pre">argtypes</span></tt> will always be <tt class="docutils literal"><span class="pre">(ctypes.c_int,</span> <span class="pre">ctypes.c_double)</span></tt>
regardless of the number of parameters, and <tt class="docutils literal"><span class="pre">restype</span></tt> will always be
<tt class="docutils literal"><span class="pre">ctypes.c_double</span></tt>.</p>
<p>4.) Now integrate the library function as normally, here using <a class="reference internal" href="../generated/scipy.integrate.nquad.html#scipy.integrate.nquad" title="scipy.integrate.nquad"><tt class="xref py py-obj docutils literal"><span class="pre">nquad</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">integrate</span><span class="o">.</span><span class="n">nquad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="go">(1000.0, 1.1102230246251565e-11)</span>
</pre></div>
</div>
<p>And the Python tuple is returned as expected in a reduced amount of time.  All
optional parameters can be used with this method including specifying
singularities, infinite bounds, etc.</p>
</div>
<div class="section" id="ordinary-differential-equations-odeint">
<h2>Ordinary differential equations (<a class="reference internal" href="../generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="scipy.integrate.odeint"><tt class="xref py py-func docutils literal"><span class="pre">odeint</span></tt></a>)<a class="headerlink" href="#ordinary-differential-equations-odeint" title="Permalink to this headline">¶</a></h2>
<p>Integrating a set of ordinary differential equations (ODEs) given
initial conditions is another useful example. The function
<a class="reference internal" href="../generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="scipy.integrate.odeint"><tt class="xref py py-obj docutils literal"><span class="pre">odeint</span></tt></a> is available in SciPy for integrating a first-order
vector differential equation:</p>
<div class="math">
\[\frac{d\mathbf{y}}{dt}=\mathbf{f}\left(\mathbf{y},t\right),\]</div>
<p>given initial conditions <span class="math">\(\mathbf{y}\left(0\right)=y_{0}\)</span>, where
<span class="math">\(\mathbf{y}\)</span> is a length <span class="math">\(N\)</span> vector and <span class="math">\(\mathbf{f}\)</span>
is a mapping from <span class="math">\(\mathcal{R}^{N}\)</span> to <span class="math">\(\mathcal{R}^{N}.\)</span>
A higher-order ordinary differential equation can always be reduced to
a differential equation of this type by introducing intermediate
derivatives into the <span class="math">\(\mathbf{y}\)</span> vector.</p>
<p>For example suppose it is desired to find the solution to the
following second-order differential equation:</p>
<div class="math">
\[\frac{d^{2}w}{dz^{2}}-zw(z)=0\]</div>
<p>with initial conditions <span class="math">\(w\left(0\right)=\frac{1}{\sqrt[3]{3^{2}}\Gamma\left(\frac{2}{3}\right)}\)</span> and <span class="math">\(\left.\frac{dw}{dz}\right|_{z=0}=-\frac{1}{\sqrt[3]{3}\Gamma\left(\frac{1}{3}\right)}.\)</span> It is known that the solution to this differential equation with these
boundary conditions is the Airy function</p>
<div class="math">
\[w=\textrm{Ai}\left(z\right),\]</div>
<p>which gives a means to check the integrator using <a class="reference internal" href="../generated/scipy.special.airy.html#scipy.special.airy" title="scipy.special.airy"><tt class="xref py py-func docutils literal"><span class="pre">special.airy</span></tt></a>.</p>
<p>First, convert this ODE into standard form by setting
<span class="math">\(\mathbf{y}=\left[\frac{dw}{dz},w\right]\)</span> and <span class="math">\(t=z\)</span>. Thus,
the differential equation becomes</p>
<div class="math">
\[\begin{split}\frac{d\mathbf{y}}{dt}=\left[\begin{array}{c} ty_{1}\\ y_{0}\end{array}\right]=\left[\begin{array}{cc} 0 &amp; t\\ 1 &amp; 0\end{array}\right]\left[\begin{array}{c} y_{0}\\ y_{1}\end{array}\right]=\left[\begin{array}{cc} 0 &amp; t\\ 1 &amp; 0\end{array}\right]\mathbf{y}.\end{split}\]</div>
<p>In other words,</p>
<div class="math">
\[\mathbf{f}\left(\mathbf{y},t\right)=\mathbf{A}\left(t\right)\mathbf{y}.\]</div>
<p>As an interesting reminder, if <span class="math">\(\mathbf{A}\left(t\right)\)</span>
commutes with <span class="math">\(\int_{0}^{t}\mathbf{A}\left(\tau\right)\, d\tau\)</span>
under matrix multiplication, then this linear differential equation
has an exact solution using the matrix exponential:</p>
<div class="math">
\[\mathbf{y}\left(t\right)=\exp\left(\int_{0}^{t}\mathbf{A}\left(\tau\right)d\tau\right)\mathbf{y}\left(0\right),\]</div>
<p>However, in this case, <span class="math">\(\mathbf{A}\left(t\right)\)</span> and its integral do not commute.</p>
<p>There are many optional inputs and outputs available when using odeint
which can help tune the solver. These additional inputs and outputs
are not needed much of the time, however, and the three required input
arguments and the output solution suffice. The required inputs are the
function defining the derivative, <em>fprime</em>, the initial conditions
vector, <em>y0</em>, and the time points to obtain a solution, <em>t</em>, (with
the initial value point as the first element of this sequence).  The
output to <a class="reference internal" href="../generated/scipy.integrate.odeint.html#scipy.integrate.odeint" title="scipy.integrate.odeint"><tt class="xref py py-obj docutils literal"><span class="pre">odeint</span></tt></a> is a matrix where each row contains the
solution vector at each requested time point (thus, the initial
conditions are given in the first output row).</p>
<p>The following example illustrates the use of odeint including the
usage of the <em>Dfun</em> option which allows the user to specify a gradient
(with respect to <span class="math">\(\mathbf{y}\)</span> ) of the function,
<span class="math">\(\mathbf{f}\left(\mathbf{y},t\right)\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">airy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1_0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y0_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0_0</span><span class="p">,</span> <span class="n">y1_0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ychk</span> <span class="o">=</span> <span class="n">airy</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">Dfun</span><span class="o">=</span><span class="n">gradient</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ychk</span><span class="p">[:</span><span class="mi">36</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="go">[ 0.355028  0.339511  0.324068  0.308763  0.293658  0.278806]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">y</span><span class="p">[:</span><span class="mi">36</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[ 0.355028  0.339511  0.324067  0.308763  0.293658  0.278806]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">y2</span><span class="p">[:</span><span class="mi">36</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[ 0.355028  0.339511  0.324067  0.308763  0.293658  0.278806]</span>
</pre></div>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<table class="docutils citation" frame="void" id="wpr" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[WPR]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Romberg's_method">http://en.wikipedia.org/wiki/Romberg&#8217;s_method</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="npt" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[NPT]</a></td><td><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.trapz.html</a></td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2014, The Scipy community.
      </li>
      <li>
      Last updated on Jul 24, 2015.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>