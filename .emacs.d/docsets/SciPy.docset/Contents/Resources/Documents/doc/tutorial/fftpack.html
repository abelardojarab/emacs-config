<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Fourier Transforms (scipy.fftpack)</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.16.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="top" title="SciPy v0.16.0 Reference Guide" href="../index.html" >
    <link rel="up" title="SciPy Tutorial" href="index.html" >
    <link rel="next" title="Signal Processing (scipy.signal)" href="signal.html" >
    <link rel="prev" title="Interpolation (scipy.interpolate)" href="interpolate.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SciPy v0.16.0 Reference Guide</a></li>
	
          <li class="active"><a href="index.html" accesskey="U">SciPy Tutorial</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="../scipy-optimize-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="signal.html" title="Signal Processing (scipy.signal)"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="interpolate.html" title="Interpolation (scipy.interpolate)"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo">
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Fourier Transforms (<tt class="docutils literal"><span class="pre">scipy.fftpack</span></tt>)</a><ul>
<li><a class="reference internal" href="#fast-fourier-transforms">Fast Fourier transforms</a><ul>
<li><a class="reference internal" href="#one-dimensional-discrete-fourier-transforms">One dimensional discrete Fourier transforms</a></li>
<li><a class="reference internal" href="#two-and-n-dimensional-discrete-fourier-transforms">Two and n-dimensional discrete Fourier transforms</a></li>
<li><a class="reference internal" href="#fft-convolution">FFT convolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-cosine-transforms">Discrete Cosine Transforms</a><ul>
<li><a class="reference internal" href="#type-i-dct">Type I DCT</a></li>
<li><a class="reference internal" href="#type-ii-dct">Type II DCT</a></li>
<li><a class="reference internal" href="#type-iii-dct">Type III DCT</a></li>
<li><a class="reference internal" href="#dct-and-idct">DCT and IDCT</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-sine-transforms">Discrete Sine Transforms</a><ul>
<li><a class="reference internal" href="#type-i-dst">Type I DST</a></li>
<li><a class="reference internal" href="#type-ii-dst">Type II DST</a></li>
<li><a class="reference internal" href="#type-iii-dst">Type III DST</a></li>
<li><a class="reference internal" href="#dst-and-idst">DST and IDST</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache-destruction">Cache Destruction</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="interpolate.html"
                        title="previous chapter">Interpolation (<tt class="docutils literal"><span class="pre">scipy.interpolate</span></tt>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="signal.html"
                        title="next chapter">Signal Processing (<tt class="docutils literal"><span class="pre">scipy.signal</span></tt>)</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="fourier-transforms-scipy-fftpack">
<h1><a class="toc-backref" href="#id8">Fourier Transforms (<a class="reference internal" href="../fftpack.html#module-scipy.fftpack" title="scipy.fftpack"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a>)</a><a class="headerlink" href="#fourier-transforms-scipy-fftpack" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#fourier-transforms-scipy-fftpack" id="id8">Fourier Transforms (<a class="reference internal" href="../fftpack.html#module-scipy.fftpack" title="scipy.fftpack"><tt class="xref py py-mod docutils literal"><span class="pre">scipy.fftpack</span></tt></a>)</a><ul>
<li><a class="reference internal" href="#fast-fourier-transforms" id="id9">Fast Fourier transforms</a><ul>
<li><a class="reference internal" href="#one-dimensional-discrete-fourier-transforms" id="id10">One dimensional discrete Fourier transforms</a></li>
<li><a class="reference internal" href="#two-and-n-dimensional-discrete-fourier-transforms" id="id11">Two and n-dimensional discrete Fourier transforms</a></li>
<li><a class="reference internal" href="#fft-convolution" id="id12">FFT convolution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-cosine-transforms" id="id13">Discrete Cosine Transforms</a><ul>
<li><a class="reference internal" href="#type-i-dct" id="id14">Type I DCT</a></li>
<li><a class="reference internal" href="#type-ii-dct" id="id15">Type II DCT</a></li>
<li><a class="reference internal" href="#type-iii-dct" id="id16">Type III DCT</a></li>
<li><a class="reference internal" href="#dct-and-idct" id="id17">DCT and IDCT</a></li>
<li><a class="reference internal" href="#example" id="id18">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-sine-transforms" id="id19">Discrete Sine Transforms</a><ul>
<li><a class="reference internal" href="#type-i-dst" id="id20">Type I DST</a></li>
<li><a class="reference internal" href="#type-ii-dst" id="id21">Type II DST</a></li>
<li><a class="reference internal" href="#type-iii-dst" id="id22">Type III DST</a></li>
<li><a class="reference internal" href="#dst-and-idst" id="id23">DST and IDST</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache-destruction" id="id24">Cache Destruction</a></li>
<li><a class="reference internal" href="#references" id="id25">References</a></li>
</ul>
</li>
</ul>
</div>
<p>Fourier analysis is a method for expressing a function as a sum of periodic
components, and for recovering the signal from those components.  When both
the function and its Fourier transform are replaced with discretized
counterparts, it is called the discrete Fourier transform (DFT).  The DFT has
become a mainstay of numerical computing in part because of a very fast
algorithm for computing it, called the Fast Fourier Transform (FFT), which was
known to Gauss (1805) and was brought to light in its current form by Cooley
and Tukey <a class="reference internal" href="#ct65" id="id1">[CT65]</a>.  Press et al. <a class="reference internal" href="#nr" id="id2">[NR]</a> provide an accessible introduction to
Fourier analysis and its applications.</p>
<div class="section" id="fast-fourier-transforms">
<h2><a class="toc-backref" href="#id9">Fast Fourier transforms</a><a class="headerlink" href="#fast-fourier-transforms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="one-dimensional-discrete-fourier-transforms">
<h3><a class="toc-backref" href="#id10">One dimensional discrete Fourier transforms</a><a class="headerlink" href="#one-dimensional-discrete-fourier-transforms" title="Permalink to this headline">¶</a></h3>
<p>The FFT <em class="xref py py-obj">y[k]</em> of length <span class="math">\(N\)</span> of the length-<span class="math">\(N\)</span> sequence <em class="xref py py-obj">x[n]</em> is
defined as</p>
<div class="math">
\[y[k] = \sum_{n=0}^{N-1} e^{-2 \pi j \frac{k n}{N} } x[n] \, ,\]</div>
<p>and the inverse transform is defined as follows</p>
<div class="math">
\[x[n] = \frac{1}{N} \sum_{n=0}^{N-1} e^{2 \pi j \frac{k n}{N} } y[k] \, .\]</div>
<p>These transforms can be calculated by means of <a class="reference internal" href="../generated/scipy.fftpack.fft.html#scipy.fftpack.fft" title="scipy.fftpack.fft"><tt class="xref py py-func docutils literal"><span class="pre">fft</span></tt></a> and <a class="reference internal" href="../generated/scipy.fftpack.ifft.html#scipy.fftpack.ifft" title="scipy.fftpack.ifft"><tt class="xref py py-func docutils literal"><span class="pre">ifft</span></tt></a>,
respectively as shown in the following example.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">ifft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">[ 4.50000000+0.j          2.08155948-1.65109876j -1.83155948+1.60822041j</span>
<span class="go"> -1.83155948-1.60822041j  2.08155948+1.65109876j]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yinv</span> <span class="o">=</span> <span class="n">ifft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yinv</span>
<span class="go">[ 1.0+0.j  2.0+0.j  1.0+0.j -1.0+0.j  1.5+0.j]</span>
</pre></div>
</div>
<p>From the definition of the FFT it can be seen that</p>
<div class="math">
\[y[0] = \sum_{n=0}^{N-1} x[n] \, .\]</div>
<p>In the example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">4.5</span>
</pre></div>
</div>
<p>which corresponds to <span class="math">\(y[0]\)</span>. For N even, the elements
<span class="math">\(y[1]...y[N/2-1]\)</span> contain the positive-frequency terms, and the elements
<span class="math">\(y[N/2]...y[N-1]\)</span> contain the negative-frequency terms, in order of
decreasingly negative frequency. For N odd, the elements
<span class="math">\(y[1]...y[(N-1)/2]\)</span> contain the positive- frequency terms, and the
elements <span class="math">\(y[(N+1)/2]...y[N-1]\)</span> contain the negative- frequency terms, in
order of decreasingly negative frequency.</p>
<p>In case the sequence x is real-valued, the values of <span class="math">\(y[n]\)</span> for positive
frequencies is the conjugate of the values <span class="math">\(y[n]\)</span> for negative
frequencies (because the spectrum is symmetric). Typically, only the FFT
corresponding to positive frequencies is plotted.</p>
<p>The example plots the FFT of the sum of two sines.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Number of samplepoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># sample spacing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">800.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">50.0</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">80.0</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yf</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">T</span><span class="p">),</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../tutorial/fftpack-1.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/fftpack-1.png" src="../_images/fftpack-1.png" />
</div>
<p>The FFT input signal is inherently truncated. This truncation can be modelled
as multiplication of an inifinte signal with a rectangular window function. In
the spectral domain this multiplication becomes convolution of the signal
spectrum with the window function spectrum, being of form <span class="math">\(sin(x)/x\)</span>.
This convolution is the cause of an effect called spectral leakage (see
<a class="reference internal" href="#wpw" id="id3">[WPW]</a>). Windowing the signal with a dedicated window function helps mitigate
spectral leakage. The example below uses a Blackman window from scipy.signal
and shows the effect of windowing (the zero component of the FFT has been
truncated illustrative purposes).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Number of samplepoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># sample spacing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">800.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">50.0</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">80.0</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yf</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">blackman</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">blackman</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ywf</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">T</span><span class="p">),</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">xf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&#39;-b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">xf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="mf">2.0</span><span class="o">/</span><span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ywf</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">]),</span> <span class="s">&#39;-r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&#39;FFT&#39;</span><span class="p">,</span> <span class="s">&#39;FFT w. window&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../tutorial/fftpack-2.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/fftpack-2.png" src="../_images/fftpack-2.png" />
</div>
<p>In case the sequence x is complex-valued, the spectrum is no longer symmetric.
To simplify working wit the FFT functions, scipy provides the following two
helper functions.</p>
<p>The function <a class="reference internal" href="../generated/scipy.fftpack.fftfreq.html#scipy.fftpack.fftfreq" title="scipy.fftpack.fftfreq"><tt class="xref py py-func docutils literal"><span class="pre">fftfreq</span></tt></a> returns the FFT sample frequency points.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fftfreq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="go">[ 0.  1.  2.  3. -4. -3. -2. -1.]</span>
</pre></div>
</div>
<p>In a similar spirit, the function <a class="reference internal" href="../generated/scipy.fftpack.fftshift.html#scipy.fftpack.fftshift" title="scipy.fftpack.fftshift"><tt class="xref py py-func docutils literal"><span class="pre">fftshift</span></tt></a> allows swapping the lower
and upper halves of a vector, so that it becomes suitable for display.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fftfreq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sf</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[4 5 6 7 0 1 2 3]</span>
</pre></div>
</div>
<p>The example below plots the FFT of two complex exponentials; note the
asymmetric spectrum.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">fftfreq</span><span class="p">,</span> <span class="n">fftshift</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># number of signal points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">400</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># sample spacing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">800.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">N</span><span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">50.0</span> <span class="o">*</span> <span class="mf">1.j</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">80.0</span> <span class="o">*</span> <span class="mf">1.j</span> <span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yf</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">fftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yplot</span> <span class="o">=</span> <span class="n">fftshift</span><span class="p">(</span><span class="n">yf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yplot</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../tutorial/fftpack-3.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/fftpack-3.png" src="../_images/fftpack-3.png" />
</div>
<p>The function <a class="reference internal" href="../generated/scipy.fftpack.rfft.html#scipy.fftpack.rfft" title="scipy.fftpack.rfft"><tt class="xref py py-func docutils literal"><span class="pre">rfft</span></tt></a> calculates the FFT of a real sequence and outputs
the FFT coefficients <span class="math">\(y[n]\)</span> with separate real and imaginary parts. In
case of N being even: <span class="math">\([y[0], Re(y[1]), Im(y[1]),..., Re(y[N/2])]\)</span>; in
case N being odd <span class="math">\([y[0], Re(y[1]),Im(y[1]),..., Re(y[N/2]),
Im(y[N/2])]\)</span>.</p>
<p>The corresponding function <a class="reference internal" href="../generated/scipy.fftpack.irfft.html#scipy.fftpack.irfft" title="scipy.fftpack.irfft"><tt class="xref py py-func docutils literal"><span class="pre">irfft</span></tt></a> calculates the IFFT of the FFT
coefficients with this special ordering.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span><span class="p">,</span> <span class="n">rfft</span><span class="p">,</span> <span class="n">irfft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 5.50+0.j          2.25-0.4330127j  -2.75-1.29903811j  1.50+0.j</span>
<span class="go"> -2.75+1.29903811j  2.25+0.4330127j ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yr</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 5.5         2.25       -0.4330127  -2.75       -1.29903811  1.5       ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">irfft</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span>
<span class="go">[ 1.   2.   1.  -1.   1.5  1. ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 4.50000000+0.j          2.08155948-1.65109876j -1.83155948+1.60822041j</span>
<span class="go"> -1.83155948-1.60822041j  2.08155948+1.65109876j]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yr</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[ 4.5         2.08155948 -1.65109876 -1.83155948  1.60822041]</span>
</pre></div>
</div>
</div>
<div class="section" id="two-and-n-dimensional-discrete-fourier-transforms">
<h3><a class="toc-backref" href="#id11">Two and n-dimensional discrete Fourier transforms</a><a class="headerlink" href="#two-and-n-dimensional-discrete-fourier-transforms" title="Permalink to this headline">¶</a></h3>
<p>The functions <a class="reference internal" href="../generated/scipy.fftpack.fft2.html#scipy.fftpack.fft2" title="scipy.fftpack.fft2"><tt class="xref py py-func docutils literal"><span class="pre">fft2</span></tt></a> and <a class="reference internal" href="../generated/scipy.fftpack.ifft2.html#scipy.fftpack.ifft2" title="scipy.fftpack.ifft2"><tt class="xref py py-func docutils literal"><span class="pre">ifft2</span></tt></a> provide 2-dimensional FFT, and
IFFT, respectively. Similar, <a class="reference internal" href="../generated/scipy.fftpack.fftn.html#scipy.fftpack.fftn" title="scipy.fftpack.fftn"><tt class="xref py py-func docutils literal"><span class="pre">fftn</span></tt></a> and <a class="reference internal" href="../generated/scipy.fftpack.ifftn.html#scipy.fftpack.ifftn" title="scipy.fftpack.ifftn"><tt class="xref py py-func docutils literal"><span class="pre">ifftn</span></tt></a> provide
n-dimensional FFT, and IFFT, respectively.</p>
<p>The example below demonstrates a 2-dimensional IFFT and plots the resulting
(2-dimensional) time-domain signals.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">ifftn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="p">((</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">),</span> <span class="p">(</span><span class="n">ax4</span><span class="p">,</span> <span class="n">ax5</span><span class="p">,</span> <span class="n">ax6</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s">&#39;row&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">ifftn</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax4</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">ifftn</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax5</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xf</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">ifftn</span><span class="p">(</span><span class="n">xf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Reds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax6</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Z</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../tutorial/fftpack-4.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/fftpack-4.png" src="../_images/fftpack-4.png" />
</div>
</div>
<div class="section" id="fft-convolution">
<h3><a class="toc-backref" href="#id12">FFT convolution</a><a class="headerlink" href="#fft-convolution" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../fftpack.html#module-scipy.fftpack.convolve" title="scipy.fftpack.convolve"><tt class="xref py py-obj docutils literal"><span class="pre">scipy.fftpack.convolve</span></tt></a> performs a convolution of two one-dimensional
arrays in frequency domain.</p>
</div>
</div>
<div class="section" id="discrete-cosine-transforms">
<h2><a class="toc-backref" href="#id13">Discrete Cosine Transforms</a><a class="headerlink" href="#discrete-cosine-transforms" title="Permalink to this headline">¶</a></h2>
<p>Scipy provides a DCT with the function <a class="reference internal" href="../generated/scipy.fftpack.dct.html#scipy.fftpack.dct" title="scipy.fftpack.dct"><tt class="xref py py-func docutils literal"><span class="pre">dct</span></tt></a> and a corresponding IDCT
with the function <a class="reference internal" href="../generated/scipy.fftpack.idct.html#scipy.fftpack.idct" title="scipy.fftpack.idct"><tt class="xref py py-func docutils literal"><span class="pre">idct</span></tt></a>. There are 8 types of the DCT <a class="reference internal" href="#wpc" id="id4">[WPC]</a>, <a class="reference internal" href="#mak" id="id5">[Mak]</a>;
however, only the first 3 types are implemented in scipy. &#8220;The&#8221; DCT generally
refers to DCT type 2, and &#8220;the&#8221; Inverse DCT generally refers to DCT type 3. In
addition, the DCT coefficients can be normalized differently (for most types,
scipy provides <tt class="docutils literal"><span class="pre">None</span></tt> and <tt class="docutils literal"><span class="pre">ortho</span></tt>). Two parameters of the dct/idct
function calls allow setting the DCT type and coefficient normalization.</p>
<p>For a single dimension array x, dct(x, norm=&#8217;ortho&#8217;) is equal to
MATLAB dct(x).</p>
<div class="section" id="type-i-dct">
<h3><a class="toc-backref" href="#id14">Type I DCT</a><a class="headerlink" href="#type-i-dct" title="Permalink to this headline">¶</a></h3>
<p>Scipy uses the following definition of the unnormalized DCT-I
(<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = x_0 + (-1)^k x_{N-1} + 2\sum_{n=1}^{N-2} x[n]
\cos\left({\pi nk\over N-1}\right),
\qquad 0 \le k &lt; N.\end{split}\]</div>
<p>Only <tt class="docutils literal"><span class="pre">None</span></tt> is supported as normalization mode for DCT-I. Note also that the
DCT-I is only supported for input size &gt; 1</p>
</div>
<div class="section" id="type-ii-dct">
<h3><a class="toc-backref" href="#id15">Type II DCT</a><a class="headerlink" href="#type-ii-dct" title="Permalink to this headline">¶</a></h3>
<p>Scipy uses the following definition of the unnormalized DCT-II
(<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = 2 \sum_{n=0}^{N-1} x[n] \cos \left({\pi(2n+1)k \over 2N} \right)
\qquad 0 \le k &lt; N.\end{split}\]</div>
<p>In case of the normalized DCT (<tt class="docutils literal"><span class="pre">norm='ortho'</span></tt>), the DCT coefficients
<span class="math">\(y[k]\)</span> are multiplied by a scaling factor <em class="xref py py-obj">f</em>:</p>
<div class="math">
\[\begin{split}f = \begin{cases} \sqrt{1/(4N)}, &amp; \text{if $k = 0$} \\    \sqrt{1/(2N)},
&amp; \text{otherwise} \end{cases} \, .\end{split}\]</div>
<p>In this case, the DCT &#8220;base functions&#8221; <span class="math">\(\phi_k[n] = 2 f \cos
\left({\pi(2n+1)k \over 2N} \right)\)</span> become orthonormal:</p>
<div class="math">
\[\sum_{n=0}^{N-1} \phi_k[n] \phi_l[n] = \delta_{lk}\]</div>
</div>
<div class="section" id="type-iii-dct">
<h3><a class="toc-backref" href="#id16">Type III DCT</a><a class="headerlink" href="#type-iii-dct" title="Permalink to this headline">¶</a></h3>
<p>Scipy uses the following definition of the unnormalized DCT-III
(<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = x_0 + 2 \sum_{n=1}^{N-1} x[n] \cos\left({\pi n(2k+1) \over 2N}\right)
\qquad 0 \le k &lt; N,\end{split}\]</div>
<p>or, for <tt class="docutils literal"><span class="pre">norm='ortho'</span></tt>:</p>
<div class="math">
\[\begin{split}y[k] = {x_0\over\sqrt{N}} + {2\over\sqrt{N}} \sum_{n=1}^{N-1} x[n]
\cos\left({\pi n(2k+1) \over 2N}\right) \qquad 0 \le k &lt; N.\end{split}\]</div>
</div>
<div class="section" id="dct-and-idct">
<h3><a class="toc-backref" href="#id17">DCT and IDCT</a><a class="headerlink" href="#dct-and-idct" title="Permalink to this headline">¶</a></h3>
<p>The (unnormalized) DCT-III is the inverse of the (unnormalized) DCT-II, up to
a factor <em class="xref py py-obj">2N</em>. The orthonormalized DCT-III is exactly the inverse of the orthonormalized DCT-
II. The function <a class="reference internal" href="../generated/scipy.fftpack.idct.html#scipy.fftpack.idct" title="scipy.fftpack.idct"><tt class="xref py py-func docutils literal"><span class="pre">idct</span></tt></a> performs the mappings between the DCT and IDCT types.</p>
<p>The example below shows the relation between DCT and IDCT for different types
and normalizations.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">dct</span><span class="p">,</span> <span class="n">idct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="go">[1.0, 2.0, 1.0, -1.0, 1.5]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*N = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 10.  20.  10. -10.  15.]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># no scaling factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="go">[ 1.   2.   1.  -1.   1.5]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*N = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[ 10.  20.  10. -10.  15.]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># no scaling factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="go">[ 1.   2.   1.  -1.   1.5]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*(N-1) = 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idct</span><span class="p">(</span><span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[  8.  16.   8.  -8.  12.]</span>
</pre></div>
</div>
</div>
<div class="section" id="example">
<h3><a class="toc-backref" href="#id18">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The DCT exhibits the &#8220;energy compaction property&#8221;, meaning that for many
signals only the first few DCT coefficients have significant magnitude.
Zeroing out the other coefficients leads to a small reconstruction error, a
fact which is exploited in lossy signal compression (e.g. JPEG compression).</p>
<p>The example below shows a signal x and two reconstructions (<span class="math">\(x_{20}\)</span> and
<span class="math">\(x_{15}\)</span>)from the signal&#8217;s DCT coefficients. The signal <span class="math">\(x_{20}\)</span>
is reconstructed from the first 20 DCT coefficients, <span class="math">\(x_{15}\)</span> is
reconstructed from the first 15 DCT coefficients. It can be seen that the
relative error of using 20 coefficients is still very small (~0.1%), but
provides a five-fold compression rate.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">dct</span><span class="p">,</span> <span class="n">idct</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">dct</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yr</span> <span class="o">=</span> <span class="n">idct</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">window</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">yr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.0010901402257</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;-bx&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yr</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yr</span> <span class="o">=</span> <span class="n">idct</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">window</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">yr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.0718818065008</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yr</span><span class="p">,</span> <span class="s">&#39;g+&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;$x_{20}$&#39;</span><span class="p">,</span> <span class="s">&#39;$x_{15}$&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../tutorial/fftpack-5.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/fftpack-5.png" src="../_images/fftpack-5.png" />
</div>
</div>
</div>
<div class="section" id="discrete-sine-transforms">
<h2><a class="toc-backref" href="#id19">Discrete Sine Transforms</a><a class="headerlink" href="#discrete-sine-transforms" title="Permalink to this headline">¶</a></h2>
<p>Scipy provides a DST <a class="reference internal" href="#mak" id="id6">[Mak]</a> with the function <a class="reference internal" href="../generated/scipy.fftpack.dst.html#scipy.fftpack.dst" title="scipy.fftpack.dst"><tt class="xref py py-func docutils literal"><span class="pre">dst</span></tt></a> and a corresponding IDST
with the function <a class="reference internal" href="../generated/scipy.fftpack.idst.html#scipy.fftpack.idst" title="scipy.fftpack.idst"><tt class="xref py py-func docutils literal"><span class="pre">idst</span></tt></a>.</p>
<p>There are theoretically 8 types of the DST for different combinations of
even/odd boundary conditions and boundary off sets <a class="reference internal" href="#wps" id="id7">[WPS]</a>, only the first 3
types are implemented in scipy.</p>
<div class="section" id="type-i-dst">
<h3><a class="toc-backref" href="#id20">Type I DST</a><a class="headerlink" href="#type-i-dst" title="Permalink to this headline">¶</a></h3>
<p>DST-I assumes the input is odd around n=-1 and n=N. Scipy uses the following
definition of the unnormalized DST-I (<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = 2\sum_{n=0}^{N-1} x[n]  \sin\left( \pi {(n+1) (k+1)}\over{N+1}
\right), \qquad 0 \le k &lt; N.\end{split}\]</div>
<p>Only <tt class="docutils literal"><span class="pre">None</span></tt> is supported as normalization mode for DST-I. Note also that the
DST-I is only supported for input size &gt; 1. The (unnormalized) DST-I is its
own inverse, up to a factor <em class="xref py py-obj">2(N+1)</em>.</p>
</div>
<div class="section" id="type-ii-dst">
<h3><a class="toc-backref" href="#id21">Type II DST</a><a class="headerlink" href="#type-ii-dst" title="Permalink to this headline">¶</a></h3>
<p>DST-II assumes the input is odd around n=-1/2 and even around n=N. Scipy uses
the following definition of the unnormalized DST-II (<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = 2 \sum_{n=0}^{N-1} x[n]  \sin\left( {\pi (n+1/2)(k+1)} \over N
\right), \qquad 0 \le k &lt; N.\end{split}\]</div>
</div>
<div class="section" id="type-iii-dst">
<h3><a class="toc-backref" href="#id22">Type III DST</a><a class="headerlink" href="#type-iii-dst" title="Permalink to this headline">¶</a></h3>
<p>DST-III assumes the input is odd around n=-1 and even around n=N-1. Scipy uses
the following definition of the unnormalized DST-III (<tt class="docutils literal"><span class="pre">norm='None'</span></tt>):</p>
<div class="math">
\[\begin{split}y[k] = (-1)^k x[N-1] + 2 \sum_{n=0}^{N-2} x[n] \sin \left( {\pi
(n+1)(k+1/2)} \over N \right), \qquad 0 \le k &lt; N.\end{split}\]</div>
</div>
<div class="section" id="dst-and-idst">
<h3><a class="toc-backref" href="#id23">DST and IDST</a><a class="headerlink" href="#dst-and-idst" title="Permalink to this headline">¶</a></h3>
<p>The example below shows the relation between DST and IDST for different types
and normalizations.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.fftpack</span> <span class="kn">import</span> <span class="n">dst</span><span class="p">,</span> <span class="n">idst</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*N = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idst</span><span class="p">(</span><span class="n">dst</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 10.  20.  10. -10.  15.]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># no scaling factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idst</span><span class="p">(</span><span class="n">dst</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="go">[ 1.   2.   1.  -1.   1.5]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*N = 10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idst</span><span class="p">(</span><span class="n">dst</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[ 10.  20.  10. -10.  15.]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># no scaling factor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idst</span><span class="p">(</span><span class="n">dst</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s">&#39;ortho&#39;</span><span class="p">)</span>
<span class="go">[ 1.   2.   1.  -1.   1.5]</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="c"># scaling factor 2*(N+1) = 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idst</span><span class="p">(</span><span class="n">dst</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[  8.  16.   8.  -8.  12.]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cache-destruction">
<h2><a class="toc-backref" href="#id24">Cache Destruction</a><a class="headerlink" href="#cache-destruction" title="Permalink to this headline">¶</a></h2>
<p>To accelerate repeat transforms on arrays of the same shape and dtype,
scipy.fftpack keeps a cache of the prime factorization of length of the array
and pre-computed trigonometric functions.  These caches can be destroyed by
calling the appropriate function in <tt class="xref py py-obj docutils literal"><span class="pre">scipy.fftpack._fftpack</span></tt>.
dst(type=1) and idst(type=1) share a cache (<tt class="docutils literal"><span class="pre">*dst1_cache</span></tt>).  As do dst(type=2),
dst(type=3), idst(type=3), and idst(type=3) (<tt class="docutils literal"><span class="pre">*dst2_cache</span></tt>).</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id25">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="ct65" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[CT65]</a></td><td>Cooley, James W., and John W. Tukey, 1965, &#8220;An algorithm for the
machine calculation of complex Fourier series,&#8221; <em>Math. Comput.</em>
19: 297-301.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="nr" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[NR]</a></td><td>Press, W., Teukolsky, S., Vetterline, W.T., and Flannery, B.P.,
2007, <em>Numerical Recipes: The Art of Scientific Computing</em>, ch.
12-13.  Cambridge Univ. Press, Cambridge, UK.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="mak" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Mak]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> J. Makhoul, 1980, &#8216;A Fast Cosine Transform in One and Two Dimensions&#8217;,
<em class="xref py py-obj">IEEE Transactions on acoustics, speech and signal processing</em>
vol. 28(1), pp. 27-34, <a class="reference external" href="http://dx.doi.org/10.1109/TASSP.1980.1163351">http://dx.doi.org/10.1109/TASSP.1980.1163351</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wpw" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[WPW]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Window_function">http://en.wikipedia.org/wiki/Window_function</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wpc" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[WPC]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Discrete_cosine_transform">http://en.wikipedia.org/wiki/Discrete_cosine_transform</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wps" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[WPS]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Discrete_sine_transform">http://en.wikipedia.org/wiki/Discrete_sine_transform</a></td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2014, The Scipy community.
      </li>
      <li>
      Last updated on Jul 24, 2015.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>