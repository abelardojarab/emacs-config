<html><head>
    <meta charset="utf-8">
    
    <title>numpy.cov</title>
    
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../../_static/scipy.css" type="text/css">
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css">
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.10.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/copybutton.js"></script>
    <link rel="author" title="About these documents" href="../../about.html">
    <link rel="top" title="NumPy v1.10 Manual" href="../../index.html">
    <link rel="up" title="Statistics" href="../routines.statistics.html">
    <link rel="next" title="numpy.histogram" href="numpy.histogram.html">
    <link rel="prev" title="numpy.correlate" href="numpy.correlate.html"> 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        
        <li class="active"><a href="../../index.html">NumPy v1.10 Manual</a></li>
        

          <li class="active"><a href="../index.html">NumPy Reference</a></li>
          <li class="active"><a href="../routines.html">Routines</a></li>
          <li class="active"><a href="../routines.statistics.html" accesskey="U">Statistics</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../../genindex.html" title="General Index" accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="numpy.histogram.html" title="numpy.histogram" accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="numpy.correlate.html" title="numpy.correlate" accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="numpy.correlate.html" title="previous chapter">numpy.correlate</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="numpy.histogram.html" title="next chapter">numpy.histogram</a></p>


        </div>
      </div>
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="numpy-cov">
<h1>numpy.cov<a class="headerlink" href="#numpy-cov" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<a class="dashAnchor" name="//apple_ref/Function/numpy.cov"></a><dt id="numpy.cov">
<tt class="descclassname">numpy.</tt><tt class="descname">cov</tt><big>(</big><em>m</em>, <em>y=None</em>, <em>rowvar=1</em>, <em>bias=0</em>, <em>ddof=None</em>, <em>fweights=None</em>, <em>aweights=None</em><big>)</big><a class="reference external" href="http://github.com/numpy/numpy/blob/v1.10.1/numpy/lib/function_base.py#L1891-L2087"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#numpy.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a covariance matrix, given data and weights.</p>
<p>Covariance indicates the level to which two variables vary together.
If we examine N-dimensional samples, <img class="math" src="../../_images/math/8d14fb48024fc0aaeed58a8b7e012bf142402c41.png" alt="X = [x_1, x_2, ... x_N]^T" style="vertical-align: -4px">,
then the covariance matrix element <img class="math" src="../../_images/math/7cd8b54c3097c3343ae058f6be2e7e8888f8cff8.png" alt="C_{ij}" style="vertical-align: -4px"> is the covariance of
<img class="math" src="../../_images/math/8f36430327e350fd5583002c178ca1949d485b21.png" alt="x_i" style="vertical-align: -2px"> and <img class="math" src="../../_images/math/fd3512e9f7dec13e6defb1a51b94a1e31a8eca67.png" alt="x_j" style="vertical-align: -4px">. The element <img class="math" src="../../_images/math/114c5f45409813eddd95cb59fe4d7e618f417d23.png" alt="C_{ii}" style="vertical-align: -2px"> is the variance
of <img class="math" src="../../_images/math/8f36430327e350fd5583002c178ca1949d485b21.png" alt="x_i" style="vertical-align: -2px">.</p>
<p>See the notes for an outline of the algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>m</strong> : array_like</p>
<blockquote>
<div><p>A 1-D or 2-D array containing multiple variables and observations.
Each row of <em class="xref py py-obj">m</em> represents a variable, and each column a single
observation of all those variables. Also see <em class="xref py py-obj">rowvar</em> below.</p>
</div></blockquote>
<p><strong>y</strong> : array_like, optional</p>
<blockquote>
<div><p>An additional set of variables and observations. <em class="xref py py-obj">y</em> has the same form
as that of <em class="xref py py-obj">m</em>.</p>
</div></blockquote>
<p><strong>rowvar</strong> : int, optional</p>
<blockquote>
<div><p>If <em class="xref py py-obj">rowvar</em> is non-zero (default), then each row represents a
variable, with observations in the columns. Otherwise, the relationship
is transposed: each column represents a variable, while the rows
contain observations.</p>
</div></blockquote>
<p><strong>bias</strong> : int, optional</p>
<blockquote>
<div><p>Default normalization is by <tt class="docutils literal"><span class="pre">(N</span> <span class="pre">-</span> <span class="pre">1)</span></tt>, where <tt class="docutils literal"><span class="pre">N</span></tt> corresponds to the
number of observations given (unbiased estimate). If <em class="xref py py-obj">bias</em> is 1, then
normalization is by <tt class="docutils literal"><span class="pre">N</span></tt>. These values can be overridden by using the
keyword <tt class="docutils literal"><span class="pre">ddof</span></tt> in numpy versions &gt;= 1.5.</p>
</div></blockquote>
<p><strong>ddof</strong> : int, optional</p>
<blockquote>
<div><p>If not <tt class="docutils literal"><span class="pre">None</span></tt> the default value implied by <em class="xref py py-obj">bias</em> is overridden.
Note that <tt class="docutils literal"><span class="pre">ddof=1</span></tt> will return the unbiased estimate, even if both
<em class="xref py py-obj">fweights</em> and <em class="xref py py-obj">aweights</em> are specified, and <tt class="docutils literal"><span class="pre">ddof=0</span></tt> will return
the simple average. See the notes for the details. The default value
is <tt class="docutils literal"><span class="pre">None</span></tt>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.5.</span></p>
</div>
</div></blockquote>
<p><strong>fweights</strong> : array_like, int, optional</p>
<blockquote>
<div><p>1-D array of integer freguency weights; the number of times each
observation vector should be repeated.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.10.</span></p>
</div>
</div></blockquote>
<p><strong>aweights</strong> : array_like, optional</p>
<blockquote>
<div><p>1-D array of observation vector weights. These relative weights are
typically large for observations considered “important” and smaller for
observations considered less “important”. If <tt class="docutils literal"><span class="pre">ddof=0</span></tt> the array of
weights can be used to assign probabilities to observation vectors.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.10.</span></p>
</div>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>out</strong> : ndarray</p>
<blockquote class="last">
<div><p>The covariance matrix of the variables.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="numpy.corrcoef.html#numpy.corrcoef" title="numpy.corrcoef"><tt class="xref py py-obj docutils literal"><span class="pre">corrcoef</span></tt></a></dt>
<dd>Normalized covariance matrix</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Assume that the observations are in the columns of the observation
array <em class="xref py py-obj">m</em> and let <tt class="docutils literal"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">fweights</span></tt> and <tt class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">aweights</span></tt> for brevity. The
steps to compute the weighted covariance are as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="n">v1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">v1</span> <span class="o">/</span> <span class="p">(</span><span class="n">v1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ddof</span> <span class="o">*</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that when <tt class="docutils literal"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">1</span></tt>, the normalization factor
<tt class="docutils literal"><span class="pre">v1</span> <span class="pre">/</span> <span class="pre">(v1**2</span> <span class="pre">-</span> <span class="pre">ddof</span> <span class="pre">*</span> <span class="pre">v2)</span></tt> goes over to <tt class="docutils literal"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">(np.sum(f)</span> <span class="pre">-</span> <span class="pre">ddof)</span></tt>
as it should.</p>
<p class="rubric">Examples</p>
<p>Consider two variables, <img class="math" src="../../_images/math/5e127c8b3220e24da5a3dc9bfcb5d64ca53cb594.png" alt="x_0" style="vertical-align: -2px"> and <img class="math" src="../../_images/math/9655d43328526b2b7a337dba3e45750ed2a448e6.png" alt="x_1" style="vertical-align: -3px">, which
correlate perfectly, but in opposite directions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [2, 1, 0]])</span>
</pre></div>
</div>
<p>Note how <img class="math" src="../../_images/math/5e127c8b3220e24da5a3dc9bfcb5d64ca53cb594.png" alt="x_0" style="vertical-align: -2px"> increases while <img class="math" src="../../_images/math/9655d43328526b2b7a337dba3e45750ed2a448e6.png" alt="x_1" style="vertical-align: -3px"> decreases. The covariance
matrix shows this clearly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([[ 1., -1.],</span>
<span class="go">       [-1.,  1.]])</span>
</pre></div>
</div>
<p>Note that element <img class="math" src="../../_images/math/00c3354e39e0ddafa0166158dc0d48f016b514d5.png" alt="C_{0,1}" style="vertical-align: -4px">, which shows the correlation between
<img class="math" src="../../_images/math/5e127c8b3220e24da5a3dc9bfcb5d64ca53cb594.png" alt="x_0" style="vertical-align: -2px"> and <img class="math" src="../../_images/math/9655d43328526b2b7a337dba3e45750ed2a448e6.png" alt="x_1" style="vertical-align: -3px">, is negative.</p>
<p>Further, note how <em class="xref py py-obj">x</em> and <em class="xref py py-obj">y</em> are combined:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mf">4.3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span>  <span class="mf">1.1</span><span class="p">,</span>  <span class="mf">0.12</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="go">[[ 11.71        -4.286     ]</span>
<span class="go"> [ -4.286        2.14413333]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[[ 11.71        -4.286     ]</span>
<span class="go"> [ -4.286        2.14413333]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">11.71</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        © Copyright 2008-2009, The Scipy community.
      </li>
      <li>
      Last updated on Oct 18, 2015.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  
</body></html>