<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html class="client-nojs" dir="ltr" lang="en"><head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<title>std::shared_ptr</title>
<meta charset="UTF-8">
<meta content="MediaWiki 1.21.2" name="generator">


<link href="../../../favicon.ico" rel="shortcut icon">



<link href="../../../common/ext.css" rel="stylesheet">
<meta content="" name="ResourceLoaderDynamicStyles">
<link href="../../../common/site_modules.css" rel="stylesheet">
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}#toc{display:none}.editsection{display:none}
/* cache key: mwiki1-mwiki_en_:resourceloader:filter:minify-css:7:472787eddcf4605d11de8c7ef047234f */</style>

<script src="../../../common/startup_scripts.js"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"cpp/memory/shared_ptr","wgTitle":"cpp/memory/shared ptr","wgCurRevisionId":84028,"wgArticleId":2177,"wgIsArticle":true,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"cpp/memory/shared_ptr","wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":0,"showtoolbar":1,"skin":"cppreference2","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"en","language":"en","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"gadget-ColiruCompiler":1});;},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});;},{},{});
/* cache key: mwiki1-mwiki_en_:resourceloader:filter:minify-js:7:ca03345b1e2c4d90a25d968753a73b92 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-cpp {line-height: normal;}
.source-cpp li, .source-cpp pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for cpp
 * CSS class: source-cpp, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.cpp.source-cpp .de1, .cpp.source-cpp .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.cpp.source-cpp  {font-family:monospace;}
.cpp.source-cpp .imp {font-weight: bold; color: red;}
.cpp.source-cpp li, .cpp.source-cpp .li1 {font-weight: normal; vertical-align:top;}
.cpp.source-cpp .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.cpp.source-cpp .li2 {font-weight: bold; vertical-align:top;}
.cpp.source-cpp .kw1 {color: #0000dd;}
.cpp.source-cpp .kw2 {color: #0000ff;}
.cpp.source-cpp .kw3 {color: #0000dd;}
.cpp.source-cpp .kw4 {color: #0000ff;}
.cpp.source-cpp .co1 {color: #909090;}
.cpp.source-cpp .co2 {color: #339900;}
.cpp.source-cpp .coMULTI {color: #ff0000; font-style: italic;}
.cpp.source-cpp .es0 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es1 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es2 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es3 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es4 {color: #008000; font-weight: bold;}
.cpp.source-cpp .es5 {color: #008000; font-weight: bold;}
.cpp.source-cpp .br0 {color: #008000;}
.cpp.source-cpp .sy0 {color: #008000;}
.cpp.source-cpp .sy1 {color: #000080;}
.cpp.source-cpp .sy2 {color: #000040;}
.cpp.source-cpp .sy3 {color: #000040;}
.cpp.source-cpp .sy4 {color: #008080;}
.cpp.source-cpp .st0 {color: #008000;}
.cpp.source-cpp .nu0 {color: #000080;}
.cpp.source-cpp .nu6 {color: #000080;}
.cpp.source-cpp .nu8 {color: #000080;}
.cpp.source-cpp .nu12 {color: #000080;}
.cpp.source-cpp .nu16 {color:#000080;}
.cpp.source-cpp .nu17 {color:#000080;}
.cpp.source-cpp .nu18 {color:#000080;}
.cpp.source-cpp .nu19 {color:#000080;}
.cpp.source-cpp .ln-xtra, .cpp.source-cpp li.ln-xtra, .cpp.source-cpp div.ln-xtra {background-color: #ffc;}
.cpp.source-cpp span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
.source-text {line-height: normal;}
.source-text li, .source-text pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for text
 * CSS class: source-text, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.text.source-text .de1, .text.source-text .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.text.source-text  {font-family:monospace;}
.text.source-text .imp {font-weight: bold; color: red;}
.text.source-text li, .text.source-text .li1 {font-weight: normal; vertical-align:top;}
.text.source-text .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.text.source-text .li2 {font-weight: bold; vertical-align:top;}
.text.source-text .ln-xtra, .text.source-text li.ln-xtra, .text.source-text div.ln-xtra {background-color: #ffc;}
.text.source-text span.xtra { display:block; }

/*]]>*/
</style>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/mwiki/skins/cppreference2/csshover.min.htc")}</style><![endif]-->
</head><body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-cpp_memory_shared_ptr skin-cppreference2 action-view cpp-navbar">
        <!-- header -->
        
        <!-- /header -->
        <!-- content -->
        <div id="cpp-content-base">
            <div id="content">
                <a id="top"></a>
                <div id="mw-js-message" style="display:none;"></div>
                                <!-- firstHeading -->
                <h1 class="firstHeading" id="firstHeading">
<span style="font-size:0.7em; line-height:130%">std::</span>shared_ptr</h1>
                <!-- /firstHeading -->
                <!-- bodyContent -->
                <div id="bodyContent">
                                        <!-- tagline -->
                    <div id="siteSub">From cppreference.com</div>
                    <!-- /tagline -->
                                        <!-- subtitle -->
                    <div id="contentSub"><span class="subpages">&lt; <a href="../../cpp.html" title="cpp">cpp</a>&lrm; | <a href="../memory.html" title="cpp/memory">memory</a></span></div>
                    <!-- /subtitle -->
                                                            <!-- bodycontent -->
                    <div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
<div class="t-navbar" style="">
<div class="t-navbar-sep">&nbsp;</div>
<div class="t-navbar-head">
<a href="../../cpp.html" title="cpp"> C++</a><div class="t-navbar-menu"><div>
<div><table cellpadding="0" class="t-nv-begin" style="line-height:1.1em;">
<tbody><tr class="t-nv"><td colspan="5"> <a href="../language.1.html" title="cpp/language"> Language</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../header.html" title="cpp/header"> Standard library headers</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../concept.html" title="cpp/concept"> Concepts</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../utility.html" title="cpp/utility"> Utilities library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../string.html" title="cpp/string"> Strings library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../container.html" title="cpp/container"> Containers library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../algorithm.html" title="cpp/algorithm"> Algorithms library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../iterator.html" title="cpp/iterator"> Iterators library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../numeric.html" title="cpp/numeric"> Numerics library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../io.html" title="cpp/io"> Input/output library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../locale.html" title="cpp/locale"> Localizations library</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../regex.html" title="cpp/regex"> Regular expressions library</a> <span class="t-mark-rev t-since-cxx11">(C++11)</span> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../atomic.html" title="cpp/atomic"> Atomic operations library</a> <span class="t-mark-rev t-since-cxx11">(C++11)</span> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../thread.html" title="cpp/thread"> Thread support library</a> <span class="t-mark-rev t-since-cxx11">(C++11)</span> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../filesystem.html" title="cpp/filesystem"> Filesystem library</a> <span class="t-mark-rev t-since-cxx17">(C++17)</span> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../experimental.html" title="cpp/experimental"> Technical Specifications</a> </td></tr>
</tbody></table></div>
<div></div>
</div></div>
</div>
<div class="t-navbar-sep">&nbsp;</div>
<div class="t-navbar-head">
<a href="../utility.html" title="cpp/utility"> Utilities library</a><div class="t-navbar-menu"><div>
<div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv"><td colspan="5"> <a href="../types.html" title="cpp/types"> Type support</a> (basic types, RTTI, type traits) </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../memory.html" title="cpp/memory"> Dynamic memory management</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../error.html" title="cpp/error"> Error handling</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../utility/program.html" title="cpp/utility/program"> Program utilities</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../utility/variadic.html" title="cpp/utility/variadic"> Variadic functions</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../chrono.html" title="cpp/chrono"> Date and time</a> </td></tr>
<tr class="t-nv"><td colspan="5"> <a href="../utility/functional.html" title="cpp/utility/functional"> Function objects</a> </td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/initializer_list.html" title="cpp/utility/initializer list"><span class="t-lines"><span>initializer_list</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="../utility/bitset.html" title="cpp/utility/bitset"><span class="t-lines"><span>bitset</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/hash.html" title="cpp/utility/hash"><span class="t-lines"><span>hash</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Relational operators</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="../utility/rel_ops/operator_cmp.html" title="cpp/utility/rel ops/operator cmp"><span class="t-lines"><span>rel_ops::operator!=</span><span>rel_ops::operator&gt;</span><span>rel_ops::operator&lt;=</span><span>rel_ops::operator&gt;=</span></span></a></div></div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Optional and any</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/optional.html" title="cpp/utility/optional"><span class="t-lines"><span>optional</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/any.html" title="cpp/utility/any"><span class="t-lines"><span>any</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Pairs and tuples</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="../utility/pair.html" title="cpp/utility/pair"><span class="t-lines"><span>pair</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/tuple.html" title="cpp/utility/tuple"><span class="t-lines"><span>tuple</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/apply.html" title="cpp/utility/apply"><span class="t-lines"><span>apply</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/piecewise_construct_t.html" title="cpp/utility/piecewise construct t"><span class="t-lines"><span>piecewise_construct_t</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/piecewise_construct.html" title="cpp/utility/piecewise construct"><span class="t-lines"><span>piecewise_construct</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/integer_sequence.html" title="cpp/utility/integer sequence"><span class="t-lines"><span>integer_sequence</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx14">(C++14)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Swap, forward and move</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="../algorithm/swap.html" title="cpp/algorithm/swap"><span class="t-lines"><span>swap</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/exchange.html" title="cpp/utility/exchange"><span class="t-lines"><span>exchange</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx14">(C++14)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/forward.html" title="cpp/utility/forward"><span class="t-lines"><span>forward</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/move.html" title="cpp/utility/move"><span class="t-lines"><span>move</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/move_if_noexcept.html" title="cpp/utility/move if noexcept"><span class="t-lines"><span>move_if_noexcept</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Type operations</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/declval.html" title="cpp/utility/declval"><span class="t-lines"><span>declval</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="../utility/as_const.html" title="cpp/utility/as const"><span class="t-lines"><span>as_const</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
</tbody></table></div>
<div></div>
</div></div>
</div>
<div class="t-navbar-sep">&nbsp;</div>
<div class="t-navbar-head">
<a href="../memory.html" title="cpp/memory"> Dynamic memory management</a><div class="t-navbar-menu"><div>
<div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv-col-table">
<td><div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv-h1"><td colspan="5"> Smart pointers</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="unique_ptr.html" title="cpp/memory/unique ptr"><span class="t-lines"><span>unique_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><strong class="selflink"><span class="t-lines"><span>shared_ptr</span></span></strong></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="weak_ptr.html" title="cpp/memory/weak ptr"><span class="t-lines"><span>weak_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="auto_ptr.html" title="cpp/memory/auto ptr"><span class="t-lines"><span>auto_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-until-cxx17">(until C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="owner_less.html" title="cpp/memory/owner less"><span class="t-lines"><span>owner_less</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="enable_shared_from_this.html" title="cpp/memory/enable shared from this"><span class="t-lines"><span>enable_shared_from_this</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="bad_weak_ptr.html" title="cpp/memory/bad weak ptr"><span class="t-lines"><span>bad_weak_ptr</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="default_delete.html" title="cpp/memory/default delete"><span class="t-lines"><span>default_delete</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> Allocators</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="allocator.html" title="cpp/memory/allocator"><span class="t-lines"><span>allocator</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="allocator_traits.html" title="cpp/memory/allocator traits"><span class="t-lines"><span>allocator_traits</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="allocator_arg_t.html" title="cpp/memory/allocator arg t"><span class="t-lines"><span>allocator_arg_t</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="allocator_arg.html" title="cpp/memory/allocator arg"><span class="t-lines"><span>allocator_arg</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="uses_allocator.html" title="cpp/memory/uses allocator"><span class="t-lines"><span>uses_allocator</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="scoped_allocator_adaptor.html" title="cpp/memory/scoped allocator adaptor"><span class="t-lines"><span>scoped_allocator_adaptor</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="polymorphic_allocator.html" title="cpp/memory/polymorphic allocator"><span class="t-lines"><span>pmr::polymorphic_allocator</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> Memory resources</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="memory_resource.html" title="cpp/memory/memory resource"><span class="t-lines"><span>pmr::memory_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="get_default_resource.html" title="cpp/memory/get default resource"><span class="t-lines"><span>pmr::get_default_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="set_default_resource.html" title="cpp/memory/set default resource"><span class="t-lines"><span>pmr::set_default_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="new_delete_resource.html" title="cpp/memory/new delete resource"><span class="t-lines"><span>pmr::new_delete_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="null_memory_resource.html" title="cpp/memory/null memory resource"><span class="t-lines"><span>pmr::null_memory_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="synchronized_pool_resource.html" title="cpp/memory/synchronized pool resource"><span class="t-lines"><span>pmr::synchronized_pool_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="unsynchronized_pool_resource.html" title="cpp/memory/unsynchronized pool resource"><span class="t-lines"><span>pmr::unsynchronized_pool_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="monotonic_buffer_resource.html" title="cpp/memory/monotonic buffer resource"><span class="t-lines"><span>pmr::monotonic_buffer_resource</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="pool_options.html" title="cpp/memory/pool options"><span class="t-lines"><span>pmr::pool_options</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
</tbody></table></div></td>
<td><div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv-h1"><td colspan="5"> Uninitialized storage</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="uninitialized_copy.html" title="cpp/memory/uninitialized copy"><span class="t-lines"><span>uninitialized_copy</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="uninitialized_copy_n.html" title="cpp/memory/uninitialized copy n"><span class="t-lines"><span>uninitialized_copy_n</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="uninitialized_fill.html" title="cpp/memory/uninitialized fill"><span class="t-lines"><span>uninitialized_fill</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="uninitialized_fill_n.html" title="cpp/memory/uninitialized fill n"><span class="t-lines"><span>uninitialized_fill_n</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="raw_storage_iterator.html" title="cpp/memory/raw storage iterator"><span class="t-lines"><span>raw_storage_iterator</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="get_temporary_buffer.html" title="cpp/memory/get temporary buffer"><span class="t-lines"><span>get_temporary_buffer</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="return_temporary_buffer.html" title="cpp/memory/return temporary buffer"><span class="t-lines"><span>return_temporary_buffer</span></span></a></div></div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> Garbage collection support</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/declare_reachable.html" title="cpp/memory/gc/declare reachable"><span class="t-lines"><span>declare_reachable</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/undeclare_reachable.html" title="cpp/memory/gc/undeclare reachable"><span class="t-lines"><span>undeclare_reachable</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/declare_no_pointers.html" title="cpp/memory/gc/declare no pointers"><span class="t-lines"><span>declare_no_pointers</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/undeclare_no_pointers.html" title="cpp/memory/gc/undeclare no pointers"><span class="t-lines"><span>undeclare_no_pointers</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/pointer_safety.html" title="cpp/memory/gc/pointer safety"><span class="t-lines"><span>pointer_safety</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="gc/get_pointer_safety.html" title="cpp/memory/gc/get pointer safety"><span class="t-lines"><span>get_pointer_safety</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> Miscellaneous</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="pointer_traits.html" title="cpp/memory/pointer traits"><span class="t-lines"><span>pointer_traits</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="addressof.html" title="cpp/memory/addressof"><span class="t-lines"><span>addressof</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="align.html" title="cpp/memory/align"><span class="t-lines"><span>align</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> <a href="c.html" title="cpp/memory/c">C Library</a>
</td></tr>
<tr class="t-nv-col-table">
<td><div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="c/malloc.html" title="cpp/memory/c/malloc"><span class="t-lines"><span>malloc</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="c/calloc.html" title="cpp/memory/c/calloc"><span class="t-lines"><span>calloc</span></span></a></div></div></td></tr>
</tbody></table></div></td>
<td><div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="c/realloc.html" title="cpp/memory/c/realloc"><span class="t-lines"><span>realloc</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="c/free.html" title="cpp/memory/c/free"><span class="t-lines"><span>free</span></span></a></div></div></td></tr>
</tbody></table></div></td>
</tr>
<tr class="t-nv-h1"><td colspan="5"> <a href="new.1.html" title="cpp/memory/new">Low level memory management</a>
</td></tr>
</tbody></table></div></td>
</tr>
</tbody></table></div>
<div></div>
</div></div>
</div>
<div class="t-navbar-sep">&nbsp;</div>
<div class="t-navbar-head">
<strong class="selflink"><tt>std::shared_ptr</tt></strong><div class="t-navbar-menu"><div>
<div><table cellpadding="0" class="t-nv-begin" style="">
<tbody><tr class="t-nv-h1"><td colspan="5"> Member functions</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/shared_ptr.html" title="cpp/memory/shared ptr/shared ptr"><span class="t-lines"><span>shared_ptr::shared_ptr</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/%7Eshared_ptr.html" title="cpp/memory/shared ptr/~shared ptr"><span class="t-lines"><span>shared_ptr::~shared_ptr</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/operator%3D.html" title="cpp/memory/shared ptr/operator="><span class="t-lines"><span>shared_ptr::operator=</span></span></a></div></div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Modifiers</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/reset.html" title="cpp/memory/shared ptr/reset"><span class="t-lines"><span>shared_ptr::reset</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/swap.html" title="cpp/memory/shared ptr/swap"><span class="t-lines"><span>shared_ptr::swap</span></span></a></div></div></td></tr>
<tr class="t-nv-h2"><td colspan="5"> Observers</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/get.html" title="cpp/memory/shared ptr/get"><span class="t-lines"><span>shared_ptr::get</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/operator%2A.html" title="cpp/memory/shared ptr/operator*"><span class="t-lines"><span>shared_ptr::operator*</span><span>shared_ptr::operator-&gt;</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="shared_ptr/operator_at.html" title="cpp/memory/shared ptr/operator at"><span class="t-lines"><span>shared_ptr::operator[]</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/use_count.html" title="cpp/memory/shared ptr/use count"><span class="t-lines"><span>shared_ptr::use_count</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/unique.html" title="cpp/memory/shared ptr/unique"><span class="t-lines"><span>shared_ptr::unique</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/operator_bool.html" title="cpp/memory/shared ptr/operator bool"><span class="t-lines"><span>shared_ptr::operator bool</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/owner_before.html" title="cpp/memory/shared ptr/owner before"><span class="t-lines"><span>shared_ptr::owner_before</span></span></a></div></div></td></tr>
<tr class="t-nv-h1"><td colspan="5"> Non-member functions</td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/swap2.html" title="cpp/memory/shared ptr/swap2"><span class="t-lines"><span>std::swap</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/make_shared.html" title="cpp/memory/shared ptr/make shared"><span class="t-lines"><span>make_shared</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/allocate_shared.html" title="cpp/memory/shared ptr/allocate shared"><span class="t-lines"><span>allocate_shared</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table">
<div><a href="shared_ptr/pointer_cast.html" title="cpp/memory/shared ptr/pointer cast"><span class="t-lines"><span>static_pointer_cast</span><span>dynamic_pointer_cast</span><span>const_pointer_cast</span><span>reinterpret_pointer_cast</span></span></a></div>
<div><span class="t-lines"><span></span><span></span><span></span><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/get_deleter.html" title="cpp/memory/shared ptr/get deleter"><span class="t-lines"><span>get_deleter</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/operator_cmp.html" title="cpp/memory/shared ptr/operator cmp"><span class="t-lines"><span>operator==</span><span>operator|=</span><span>operator&lt;</span><span>operator&lt;=</span><span>operator&gt;</span><span>operator&gt;=</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/operator_ltlt.html" title="cpp/memory/shared ptr/operator ltlt"><span class="t-lines"><span>operator&lt;&lt;</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/atomic.html" title="cpp/memory/shared ptr/atomic"><span class="t-lines"><span>atomic_is_lock_free</span><span>atomic_load</span><span>atomic_load_explicit</span><span>atomic_store</span><span>atomic_store_explicit</span><span>atomic_exchange</span><span>atomic_exchange_explicit</span><span>atomic_compare_exchange_weak</span><span>atomic_compare_exchange_strong</span><span>atomic_compare_exchange_weak_explicit</span><span>atomic_compare_exchange_strong_explicit</span></span></a></div></div></td></tr>
<tr class="t-nv"><td colspan="5"><div class="t-nv-ln-table"><div><a href="shared_ptr/hash.html" title="cpp/memory/shared ptr/hash"><span class="t-lines"><span>std::hash</span></span></a></div></div></td></tr>
</tbody></table></div>
<div></div>
</div></div>
</div>
<div class="t-navbar-sep">&nbsp;</div>
</div>
<table class="t-dcl-begin"><tbody>
<tr class="t-dsc-header">
<td> <div>Defined in header <code><a href="../header/memory.html" title="cpp/header/memory">&lt;memory&gt;</a></code>
 </div>
</td>
<td></td>
<td></td>
</tr>
<tr class="t-dcl t-since-cxx11">
<td> <div><span class="mw-geshi cpp source-cpp"><span class="kw1">template</span><span class="sy1">&lt;</span> <span class="kw1">class</span> T <span class="sy1">&gt;</span> <span class="kw1">class</span> shared_ptr<span class="sy4">;</span></span></div>
</td>
<td class="t-dcl-nopad">  </td>
<td> <span class="t-mark-rev t-since-cxx11">(since C++11)</span> </td>
</tr>
<tr class="t-dcl-sep">
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><code>std::shared_ptr</code> is a smart pointer that retains shared ownership of an object through a pointer. Several <code>shared_ptr</code> objects may own the same object. The object is destroyed and its memory deallocated when either of the following happens:
</p>
<ul>
<li> the last remaining <code>shared_ptr</code> owning the object is destroyed;
</li>
<li> the last remaining <code>shared_ptr</code> owning the object is assigned another pointer via <span class="t-lc"><a href="shared_ptr/operator%3D.html" title="cpp/memory/shared ptr/operator=">operator=</a></span> or <span class="t-lc"><a href="shared_ptr/reset.html" title="cpp/memory/shared ptr/reset">reset()</a></span>. 
</li>
</ul>
<p>The object is destroyed using <a href="../language/delete.html" title="cpp/language/delete"><tt>delete-expression</tt></a> or a custom deleter that is supplied to <code>shared_ptr</code> during construction.
</p>
<p>A <code>shared_ptr</code> can share ownership of an object while storing a pointer to another object. This feature can be used to point to member objects while owning the object they belong to. The stored pointer is the one accessed by <span class="t-c"><span class="mw-geshi cpp source-cpp">get<span class="br0">(</span><span class="br0">)</span></span></span>, the dereference and the comparison operators. The managed pointer is the one passed to the deleter when use count reaches zero.
</p>
<p>A <code>shared_ptr</code> may also own no objects, in which case it is called <i>empty</i> (an empty shared_ptr may have a non-null stored pointer if the aliasing constructor was used to create it).
</p>
<p>All specializations of <code>shared_ptr</code> meet the requirements of <a href="../concept/CopyConstructible.html" title="cpp/concept/CopyConstructible"><code>CopyConstructible</code></a>, <a href="../concept/CopyAssignable.html" title="cpp/concept/CopyAssignable"><code>CopyAssignable</code></a>, and <a href="../concept/LessThanComparable.html" title="cpp/concept/LessThanComparable"><code>LessThanComparable</code></a> and are <a class="mw-redirect" href="../language/implicit_cast.html" title="cpp/language/implicit cast">contextually convertible</a> to <code>bool</code>.
</p>
<p>All member functions (including copy constructor and copy assignment) can be called by multiple threads on different instances of <code>shared_ptr</code> without additional synchronization even if these instances are copies and share ownership of the same object. If multiple threads of execution access the same <code>shared_ptr</code> without synchronization and any of those accesses uses a non-const member function of <code>shared_ptr</code> then a data race will occur; the <a href="shared_ptr/atomic.html" title="cpp/memory/shared ptr/atomic">shared_ptr overloads of atomic functions</a> can be used to prevent the data race.
</p>
<table class="toc" id="toc"><tbody><tr><td>
<div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="shared_ptr.html#Member_types"><span class="tocnumber">1</span> <span class="toctext">Member types</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="shared_ptr.html#Member_functions"><span class="tocnumber">2</span> <span class="toctext">Member functions</span></a>
<ul>
<li class="toclevel-2"><a href="shared_ptr.html#Modifiers"><span class="tocnumber">2.1</span> <span class="toctext">Modifiers</span></a></li>
<li class="toclevel-2"><a href="shared_ptr.html#Observers"><span class="tocnumber">2.2</span> <span class="toctext">Observers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="shared_ptr.html#Non-member_functions"><span class="tocnumber">3</span> <span class="toctext">Non-member functions</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="shared_ptr.html#Helper_classes"><span class="tocnumber">4</span> <span class="toctext">Helper classes</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="shared_ptr.html#Notes"><span class="tocnumber">5</span> <span class="toctext">Notes</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="shared_ptr.html#Implementation_notes"><span class="tocnumber">6</span> <span class="toctext">Implementation notes</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="shared_ptr.html#Example"><span class="tocnumber">7</span> <span class="toctext">Example</span></a></li>
</ul>
</td></tr></tbody></table>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Member types">edit</a>]</span> <span class="mw-headline" id="Member_types">Member types</span>
</h3>
<table class="t-dsc-begin">

<tbody><tr class="t-dsc-hitem">
<td>  Member type
</td>
<td>  Definition
</td>
</tr>


<tr class="t-dsc">
<td>  <span class="t-c"><span class="mw-geshi cpp source-cpp">element_type</span></span>
</td>
<td>   <table class="t-rev-begin">
<tbody><tr class="t-rev t-until-cxx17">
<td><span class="t-c"><span class="mw-geshi cpp source-cpp">T</span></span></td>
<td><span class="t-mark-rev t-until-cxx17">(until C++17)</span></td>
</tr>
<tr class="t-rev t-since-cxx17">
<td><span class="t-c"><span class="mw-geshi cpp source-cpp"><a href="../types/remove_extent.html"><span class="kw598">std::<span class="me2">remove_extent_t</span></span></a><span class="sy1">&lt;</span>T<span class="sy1">&gt;</span></span></span></td>
<td><span class="t-mark-rev t-since-cxx17">(since C++17)</span></td>
</tr>
</tbody></table>
</td>
</tr>

</tbody></table>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Member functions">edit</a>]</span> <span class="mw-headline" id="Member_functions">Member functions</span>
</h3>
<table class="t-dsc-begin">

<tbody><tr id="//apple_ref/cpp/clm/%28constructor%29"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div t-dsc-member-nobold-div"><div><a name="//apple_ref/cpp/clm/%28constructor%29"></a><a name="%28constructor%29"></a><a href="shared_ptr/shared_ptr.html" title="cpp/memory/shared ptr/shared ptr"> <span class="t-lines"><span>(constructor)</span></span></a></div></div>
</td>
<td>  constructs new <code>shared_ptr</code> <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/%28destructor%29"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div t-dsc-member-nobold-div"><div><a name="//apple_ref/cpp/clm/%28destructor%29"></a><a name="%28destructor%29"></a><a href="shared_ptr/%7Eshared_ptr.html" title="cpp/memory/shared ptr/~shared ptr"> <span class="t-lines"><span>(destructor)</span></span></a></div></div>
</td>
<td>  destructs the owned object if no more <code>shared_ptr</code>s link to it <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/operator%3D"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/operator%3D"></a><a name="operator%3D"></a><a href="shared_ptr/operator%3D.html" title="cpp/memory/shared ptr/operator="> <span class="t-lines"><span>operator=</span></span></a></div></div>
</td>
<td>   assigns the <code>shared_ptr</code>  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>


<tr>
<td colspan="2"> <h5> <span class="mw-headline" id="Modifiers">  Modifiers </span>
</h5>
</td>
</tr>

<tr id="//apple_ref/cpp/clm/reset"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/reset"></a><a name="reset"></a><a href="shared_ptr/reset.html" title="cpp/memory/shared ptr/reset"> <span class="t-lines"><span>reset</span></span></a></div></div>
</td>
<td>   replaces the managed object  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/swap"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/swap"></a><a name="swap"></a><a href="shared_ptr/swap.html" title="cpp/memory/shared ptr/swap"> <span class="t-lines"><span>swap</span></span></a></div></div>
</td>
<td>   swaps the managed objects  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>


<tr>
<td colspan="2"> <h5> <span class="mw-headline" id="Observers">  Observers </span>
</h5>
</td>
</tr>

<tr id="//apple_ref/cpp/clm/get"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/get"></a><a name="get"></a><a href="shared_ptr/get.html" title="cpp/memory/shared ptr/get"> <span class="t-lines"><span>get</span></span></a></div></div>
</td>
<td>   returns the stored pointer <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/operator%2A"></tr><tr id="//apple_ref/cpp/clm/operator-%26gt%3B"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/operator%2A"></a><a name="operator%2A"></a><a name="//apple_ref/cpp/clm/operator-%26gt%3B"></a><a name="operator-%26gt%3B"></a><a href="shared_ptr/operator%2A.html" title="cpp/memory/shared ptr/operator*"> <span class="t-lines"><span>operator*</span><span>operator-&gt;</span></span></a></div></div>
</td>
<td>   dereferences the stored pointer <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/operator%5B%5D"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div">
<div><a name="//apple_ref/cpp/clm/operator%5B%5D"></a><a name="operator%5B%5D"></a><a href="shared_ptr/operator_at.html" title="cpp/memory/shared ptr/operator at"> <span class="t-lines"><span>operator[]</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div>
</td>
<td>   provides indexed access to the stored array <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/use_count"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/use_count"></a><a name="use_count"></a><a href="shared_ptr/use_count.html" title="cpp/memory/shared ptr/use count"> <span class="t-lines"><span>use_count</span></span></a></div></div>
</td>
<td>   returns the number of <code>shared_ptr</code> objects referring to the same managed object  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/unique"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/unique"></a><a name="unique"></a><a href="shared_ptr/unique.html" title="cpp/memory/shared ptr/unique"> <span class="t-lines"><span>unique</span></span></a></div></div>
</td>
<td>   checks whether the managed object is managed only by the current <code>shared_ptr</code> instance  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/operator%20bool"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/operator%20bool"></a><a name="operator%20bool"></a><a href="shared_ptr/operator_bool.html" title="cpp/memory/shared ptr/operator bool"> <span class="t-lines"><span>operator bool</span></span></a></div></div>
</td>
<td>   checks if there is associated managed object  <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/clm/owner_before"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/clm/owner_before"></a><a name="owner_before"></a><a href="shared_ptr/owner_before.html" title="cpp/memory/shared ptr/owner before"> <span class="t-lines"><span>owner_before</span></span></a></div></div>
</td>
<td>   provides owner-based ordering of shared pointers <br> <span class="t-mark">(public member function)</span> 
</td>
</tr>
</tbody></table>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Non-member functions">edit</a>]</span> <span class="mw-headline" id="Non-member_functions">Non-member functions</span>
</h3>
<table class="t-dsc-begin">

<tbody><tr id="//apple_ref/cpp/func/make_shared"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/make_shared"></a><a name="make_shared"></a><a href="shared_ptr/make_shared.html" title="cpp/memory/shared ptr/make shared"> <span class="t-lines"><span>make_shared</span></span></a></div></div>
</td>
<td>   creates a shared pointer that manages a new object <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/allocate_shared"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/allocate_shared"></a><a name="allocate_shared"></a><a href="shared_ptr/allocate_shared.html" title="cpp/memory/shared ptr/allocate shared"> <span class="t-lines"><span>allocate_shared</span></span></a></div></div>
</td>
<td>   creates a shared pointer that manages a new object allocated using an allocator <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/static_pointer_cast"></tr><tr id="//apple_ref/cpp/func/dynamic_pointer_cast"></tr><tr id="//apple_ref/cpp/func/const_pointer_cast"></tr><tr id="//apple_ref/cpp/func/reinterpret_pointer_cast"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div">
<div><a name="//apple_ref/cpp/func/static_pointer_cast"></a><a name="static_pointer_cast"></a><a name="//apple_ref/cpp/func/dynamic_pointer_cast"></a><a name="dynamic_pointer_cast"></a><a name="//apple_ref/cpp/func/const_pointer_cast"></a><a name="const_pointer_cast"></a><a name="//apple_ref/cpp/func/reinterpret_pointer_cast"></a><a name="reinterpret_pointer_cast"></a><a href="shared_ptr/pointer_cast.html" title="cpp/memory/shared ptr/pointer cast"> <span class="t-lines"><span>static_pointer_cast</span><span>dynamic_pointer_cast</span><span>const_pointer_cast</span><span>reinterpret_pointer_cast</span></span></a></div>
<div><span class="t-lines"><span></span><span></span><span></span><span><span class="t-mark-rev t-since-cxx17">(C++17)</span></span></span></div>
</div>
</td>
<td>   applies <a href="../language/static_cast.html" title="cpp/language/static cast"><tt>static_cast</tt></a>, <a href="../language/dynamic_cast.html" title="cpp/language/dynamic cast"><tt>dynamic_cast</tt></a>, <a href="../language/const_cast.html" title="cpp/language/const cast"><tt>const_cast</tt></a>, or <a href="../language/reinterpret_cast.html" title="cpp/language/reinterpret cast"><tt>reinterpret_cast</tt></a> to the stored pointer <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/get_deleter"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/get_deleter"></a><a name="get_deleter"></a><a href="shared_ptr/get_deleter.html" title="cpp/memory/shared ptr/get deleter"> <span class="t-lines"><span>get_deleter</span></span></a></div></div>
</td>
<td>   returns the deleter of specified type, if owned  <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/operator%3D%3D"></tr><tr id="//apple_ref/cpp/func/operator%21%3D"></tr><tr id="//apple_ref/cpp/func/operator%26lt%3B"></tr><tr id="//apple_ref/cpp/func/operator%26lt%3B%3D"></tr><tr id="//apple_ref/cpp/func/operator%26gt%3B"></tr><tr id="//apple_ref/cpp/func/operator%26gt%3B%3D"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/operator%3D%3D"></a><a name="operator%3D%3D"></a><a name="//apple_ref/cpp/func/operator%21%3D"></a><a name="operator%21%3D"></a><a name="//apple_ref/cpp/func/operator%26lt%3B"></a><a name="operator%26lt%3B"></a><a name="//apple_ref/cpp/func/operator%26lt%3B%3D"></a><a name="operator%26lt%3B%3D"></a><a name="//apple_ref/cpp/func/operator%26gt%3B"></a><a name="operator%26gt%3B"></a><a name="//apple_ref/cpp/func/operator%26gt%3B%3D"></a><a name="operator%26gt%3B%3D"></a><a href="shared_ptr/operator_cmp.html" title="cpp/memory/shared ptr/operator cmp"> <span class="t-lines"><span>operator==</span><span>operator!=</span><span>operator&lt;</span><span>operator&lt;=</span><span>operator&gt;</span><span>operator&gt;=</span></span></a></div></div>
</td>
<td>   compares with another <code>shared_ptr</code> or with <span class="t-c"><span class="mw-geshi cpp source-cpp">nullptr</span></span>  <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/operator%26lt%3B%26lt%3B"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/operator%26lt%3B%26lt%3B"></a><a name="operator%26lt%3B%26lt%3B"></a><a href="shared_ptr/operator_ltlt.html" title="cpp/memory/shared ptr/operator ltlt"> <span class="t-lines"><span>operator&lt;&lt;</span></span></a></div></div>
</td>
<td>   outputs the value of the stored pointer to an output stream <br> <span class="t-mark">(function template)</span> 
</td>
</tr>

<tr id="//apple_ref/cpp/func/swap"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div">
<div><a name="//apple_ref/cpp/func/swap"></a><a name="swap"></a><a href="shared_ptr/swap2.html" title="cpp/memory/shared ptr/swap2"> <span class="t-lines"><span>std::swap<span class="t-dsc-small">(std::shared_ptr)</span></span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div>
</td>
<td>   specializes the <span class="t-lc"><a href="../algorithm/swap.html" title="cpp/algorithm/swap">std::swap</a></span> algorithm  <br> <span class="t-mark">(function template)</span> 
</td>
</tr>
</tbody></table>
<table class="t-dsc-begin">


<tbody><tr id="//apple_ref/cpp/func/atomic_is_lock_free"></tr><tr id="//apple_ref/cpp/func/atomic_load"></tr><tr id="//apple_ref/cpp/func/atomic_load_explicit"></tr><tr id="//apple_ref/cpp/func/atomic_store"></tr><tr id="//apple_ref/cpp/func/atomic_store_explicit"></tr><tr id="//apple_ref/cpp/func/atomic_exchange"></tr><tr id="//apple_ref/cpp/func/atomic_exchange_explicit"></tr><tr id="//apple_ref/cpp/func/atomic_compare_exchange_weak"></tr><tr id="//apple_ref/cpp/func/atomic_compare_exchange_strong"></tr><tr id="//apple_ref/cpp/func/atomic_compare_exchange_weak_explicit"></tr><tr id="//apple_ref/cpp/func/atomic_compare_exchange_strong_explicit"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div"><div><a name="//apple_ref/cpp/func/atomic_is_lock_free"></a><a name="atomic_is_lock_free"></a><a name="//apple_ref/cpp/func/atomic_load"></a><a name="atomic_load"></a><a name="//apple_ref/cpp/func/atomic_load_explicit"></a><a name="atomic_load_explicit"></a><a name="//apple_ref/cpp/func/atomic_store"></a><a name="atomic_store"></a><a name="//apple_ref/cpp/func/atomic_store_explicit"></a><a name="atomic_store_explicit"></a><a name="//apple_ref/cpp/func/atomic_exchange"></a><a name="atomic_exchange"></a><a name="//apple_ref/cpp/func/atomic_exchange_explicit"></a><a name="atomic_exchange_explicit"></a><a name="//apple_ref/cpp/func/atomic_compare_exchange_weak"></a><a name="atomic_compare_exchange_weak"></a><a name="//apple_ref/cpp/func/atomic_compare_exchange_strong"></a><a name="atomic_compare_exchange_strong"></a><a name="//apple_ref/cpp/func/atomic_compare_exchange_weak_explicit"></a><a name="atomic_compare_exchange_weak_explicit"></a><a name="//apple_ref/cpp/func/atomic_compare_exchange_strong_explicit"></a><a name="atomic_compare_exchange_strong_explicit"></a><a href="shared_ptr/atomic.html" title="cpp/memory/shared ptr/atomic"> <span class="t-lines"><span>std::atomic_is_lock_free<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_load<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_load_explicit<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_store<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_store_explicit<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_exchange<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_exchange_explicit<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_compare_exchange_weak<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_compare_exchange_strong<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_compare_exchange_weak_explicit<span class="t-dsc-small">(std::shared_ptr)</span></span><span>std::atomic_compare_exchange_strong_explicit<span class="t-dsc-small">(std::shared_ptr)</span></span></span></a></div></div>
</td>
<td>   specializes atomic operations for <span class="t-lc"><strong class="selflink">std::shared_ptr</strong></span>  <br> <span class="t-mark">(function template)</span> 
</td>
</tr>
</tbody></table>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Helper classes">edit</a>]</span> <span class="mw-headline" id="Helper_classes">Helper classes</span>
</h3>
<table class="t-dsc-begin">

<tbody><tr id="//apple_ref/cpp/cl/hash"></tr><tr class="t-dsc">
<td>  <div class="t-dsc-member-div">
<div><a name="//apple_ref/cpp/cl/hash"></a><a name="hash"></a><a href="shared_ptr/hash.html" title="cpp/memory/shared ptr/hash"> <span class="t-lines"><span>std::hash<span class="t-dsc-small">&lt;std::shared_ptr&gt;</span></span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx11">(C++11)</span></span></span></div>
</div>
</td>
<td>   hash support for <span class="t-lc"><strong class="selflink">std::shared_ptr</strong></span>  <br> <span class="t-mark">(class template specialization)</span> 
</td>
</tr>
</tbody></table>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Notes">edit</a>]</span> <span class="mw-headline" id="Notes">Notes</span>
</h3>
<p>The ownership of an object can only be shared with another <code>shared_ptr</code> by copy constructing or copy assigning its value to another <code>shared_ptr</code>. Constructing a new <code>shared_ptr</code> using the raw underlying pointer owned by another <code>shared_ptr</code> leads to undefined behavior.
</p>
<p><code>std::shared_ptr</code> may be used with an <a class="mw-redirect" href="../language/incomplete_type.html" title="cpp/language/incomplete type">incomplete type</a> <code>T</code>. However, the constructor from a raw pointer (<span class="t-c"><span class="mw-geshi cpp source-cpp"><span class="kw1">template</span><span class="sy1">&lt;</span><span class="kw1">class</span> Y<span class="sy1">&gt;</span> shared_ptr<span class="br0">(</span>Y<span class="sy2">*</span><span class="br0">)</span></span></span>) and the <span class="t-c"><span class="mw-geshi cpp source-cpp"><span class="kw1">template</span><span class="sy1">&lt;</span><span class="kw1">class</span> Y<span class="sy1">&gt;</span> <span class="kw4">void</span> reset<span class="br0">(</span>Y<span class="sy2">*</span><span class="br0">)</span></span></span> member function may only be called with a pointer to a complete type (note that <span class="t-lc"><a href="unique_ptr.html" title="cpp/memory/unique ptr">std::unique_ptr</a></span> may be constructed from a raw pointer to an incomplete type).
</p>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Implementation notes">edit</a>]</span> <span class="mw-headline" id="Implementation_notes">Implementation notes</span>
</h3>
<p>In a typical implementation, <span class="t-lc"><strong class="selflink">std::shared_ptr</strong></span> holds only two pointers:
</p>
<ul>
<li> the stored pointer (one returned by <span class="t-c"><span class="mw-geshi cpp source-cpp">get<span class="br0">(</span><span class="br0">)</span></span></span>);
</li>
<li> a pointer to <i>control block</i>.
</li>
</ul>
<p>The control block is a dynamically-allocated object that holds:
</p>
<ul>
<li> either a pointer to the managed object or the managed object itself;
</li>
<li> the deleter (type-erased);
</li>
<li> the allocator (type-erased);
</li>
<li> the number of <code>shared_ptr</code>s that own the managed object;
</li>
<li> the number of <code>weak_ptr</code>s that refer to the managed object.
</li>
</ul>
<p>When <code>shared_ptr</code> is created by calling <span class="t-lc"><a href="shared_ptr/make_shared.html" title="cpp/memory/shared ptr/make shared">std::make_shared</a></span> or <span class="t-lc"><a href="shared_ptr/allocate_shared.html" title="cpp/memory/shared ptr/allocate shared">std::allocate_shared</a></span>, the memory for both the control block and the managed object is created with a single allocation. The managed object is constructed in-place in a data member of the control block. When <code>shared_ptr</code> is created via one of the <code>shared_ptr</code> constructors, the managed object and the control block must be allocated separately.  In this case, the control block stores a pointer to the managed object.
</p>
<p>The pointer held by the <code>shared_ptr</code> directly is the one returned by <span class="t-lc"><a href="shared_ptr/get.html" title="cpp/memory/shared ptr/get">get()</a></span>, while the pointer/object held by the control block is the one that will be deleted when the number of shared owners reaches zero.  These pointers are not necessarily equal.
</p>
<p>The destructor of <code>shared_ptr</code> decrements the number of shared owners of the control block. If that counter reaches zero, the control block calls the destructor of the managed object. The control block does not deallocate itself until the <span class="t-lc"><a href="weak_ptr.html" title="cpp/memory/weak ptr">std::weak_ptr</a></span> counter reaches zero as well. 
</p>
<p>In practical implementations, the number of weak pointers <a class="external text" href="https%3A//www.reddit.com/r/cpp/comments/3eia29/stdshared_ptrs_secret_constructor/ctfeh1p" rel="nofollow">may be incremented</a> if there is a shared pointer to the same control block.
</p>
<p>To satisfy thread safety requirements, the reference counters are typically incremented using an equivalent of <span class="t-lc"><a href="../atomic/atomic/fetch_add.html" title="cpp/atomic/atomic/fetch add">std::atomic::fetch_add</a></span> with <span class="t-lc"><a href="../atomic/memory_order.html" title="cpp/atomic/memory order">std::memory_order_relaxed</a></span> (decrementing requires release-acquire ordering to safely destroy the control block).
</p>
<h3>
<span class="editsection">[<a href="http://en.cppreference.com/mwiki/index.php" title="Edit section: Example">edit</a>]</span> <span class="mw-headline" id="Example">Example</span>
</h3>
<div class="t-example">
<div class="t-example-live-link"><div class="coliru-btn coliru-btn-run-init">Run this code</div></div>
<div class="mw-geshi" dir="ltr" style="text-align: left;"><div class="cpp source-cpp"><pre class="de1"><span class="co2">#include &lt;iostream&gt;</span>
<span class="co2">#include &lt;memory&gt;</span>
<span class="co2">#include &lt;thread&gt;</span>
<span class="co2">#include &lt;chrono&gt;</span>
<span class="co2">#include &lt;mutex&gt;</span>
&nbsp;
<span class="kw1">struct</span> Base
<span class="br0">{</span>
    Base<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  Base::Base()<span class="es1">\n</span>&quot;</span><span class="sy4">;</span> <span class="br0">}</span>
    <span class="co1">// Note: non-virtual destructor is OK here</span>
    ~Base<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  Base::~Base()<span class="es1">\n</span>&quot;</span><span class="sy4">;</span> <span class="br0">}</span>
<span class="br0">}</span><span class="sy4">;</span>
&nbsp;
<span class="kw1">struct</span> Derived<span class="sy4">:</span> <span class="kw1">public</span> Base
<span class="br0">{</span>
    Derived<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  Derived::Derived()<span class="es1">\n</span>&quot;</span><span class="sy4">;</span> <span class="br0">}</span>
    ~Derived<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  Derived::~Derived()<span class="es1">\n</span>&quot;</span><span class="sy4">;</span> <span class="br0">}</span>
<span class="br0">}</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">void</span> thr<span class="br0">(</span>std<span class="sy4">::</span><span class="me2">shared_ptr</span><span class="sy1">&lt;</span>Base<span class="sy1">&gt;</span> p<span class="br0">)</span>
<span class="br0">{</span>
    <a href="../thread/sleep_for.html"><span class="kw1898">std::<span class="me2">this_thread</span><span class="sy4">::</span><span class="me2">sleep_for</span></span></a><span class="br0">(</span><a href="../chrono/duration.html"><span class="kw949">std::<span class="me2">chrono</span><span class="sy4">::</span><span class="me2">seconds</span></span></a><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span>
    std<span class="sy4">::</span><span class="me2">shared_ptr</span><span class="sy1">&lt;</span>Base<span class="sy1">&gt;</span> lp <span class="sy1">=</span> p<span class="sy4">;</span> <span class="co1">// thread-safe, even though the</span>
                                  <span class="co1">// shared use_count is incremented</span>
    <span class="br0">{</span>
        <span class="kw4">static</span> <a href="../thread/mutex.html"><span class="kw1901">std::<span class="me2">mutex</span></span></a> io_mutex<span class="sy4">;</span>
        <a href="../thread/lock_guard.html"><span class="kw1913">std::<span class="me2">lock_guard</span></span></a><span class="sy1">&lt;</span><a href="../thread/mutex.html"><span class="kw1901">std::<span class="me2">mutex</span></span></a><span class="sy1">&gt;</span> lk<span class="br0">(</span>io_mutex<span class="br0">)</span><span class="sy4">;</span>
        <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;local pointer in a thread:<span class="es1">\n</span>&quot;</span>
                  <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  lp.get() = &quot;</span> <span class="sy1">&lt;&lt;</span> lp.<span class="me1">get</span><span class="br0">(</span><span class="br0">)</span>
                  <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;, lp.use_count() = &quot;</span> <span class="sy1">&lt;&lt;</span> lp.<span class="me1">use_count</span><span class="br0">(</span><span class="br0">)</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&#39;<span class="es1">\n</span>&#39;</span><span class="sy4">;</span>
    <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">int</span> main<span class="br0">(</span><span class="br0">)</span>
<span class="br0">{</span>
    std<span class="sy4">::</span><span class="me2">shared_ptr</span><span class="sy1">&lt;</span>Base<span class="sy1">&gt;</span> p <span class="sy1">=</span> <a href="shared_ptr/make_shared.html"><span class="kw689">std::<span class="me2">make_shared</span></span></a><span class="sy1">&lt;</span>Derived<span class="sy1">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;Created a shared Derived (as a pointer to Base)<span class="es1">\n</span>&quot;</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  p.get() = &quot;</span> <span class="sy1">&lt;&lt;</span> p.<span class="me1">get</span><span class="br0">(</span><span class="br0">)</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;, p.use_count() = &quot;</span> <span class="sy1">&lt;&lt;</span> p.<span class="me1">use_count</span><span class="br0">(</span><span class="br0">)</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&#39;<span class="es1">\n</span>&#39;</span><span class="sy4">;</span>
    <a href="../thread/thread.html"><span class="kw1895">std::<span class="me2">thread</span></span></a> t1<span class="br0">(</span>thr, p<span class="br0">)</span>, t2<span class="br0">(</span>thr, p<span class="br0">)</span>, t3<span class="br0">(</span>thr, p<span class="br0">)</span><span class="sy4">;</span>
    p.<span class="me1">reset</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> <span class="co1">// release ownership from main</span>
    <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;Shared ownership between 3 threads and released<span class="es1">\n</span>&quot;</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;ownership from main:<span class="es1">\n</span>&quot;</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;  p.get() = &quot;</span> <span class="sy1">&lt;&lt;</span> p.<span class="me1">get</span><span class="br0">(</span><span class="br0">)</span>
              <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;, p.use_count() = &quot;</span> <span class="sy1">&lt;&lt;</span> p.<span class="me1">use_count</span><span class="br0">(</span><span class="br0">)</span> <span class="sy1">&lt;&lt;</span> <span class="st0">&#39;<span class="es1">\n</span>&#39;</span><span class="sy4">;</span>
    t1.<span class="me1">join</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> t2.<span class="me1">join</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span> t3.<span class="me1">join</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <a href="../io/cout.html"><span class="kw1551">std::<span class="me2">cout</span></span></a> <span class="sy1">&lt;&lt;</span> <span class="st0">&quot;All threads completed, the last one deleted Derived<span class="es1">\n</span>&quot;</span><span class="sy4">;</span>
<span class="br0">}</span></pre></div></div>
<p>Possible output:
</p>
<div class="mw-geshi" dir="ltr" style="text-align: left;"><div class="text source-text"><pre class="de1">Base::Base()
  Derived::Derived()
Created a shared Derived (as a pointer to Base)
  p.get() = 0xc99028, p.use_count() = 1
Shared ownership between 3 threads and released
ownership from main:
  p.get() = (nil), p.use_count() = 0
local pointer in a thread:
  lp.get() = 0xc99028, lp.use_count() = 3
local pointer in a thread:
  lp.get() = 0xc99028, lp.use_count() = 4
local pointer in a thread:
  lp.get() = 0xc99028, lp.use_count() = 2
  Derived::~Derived()
  Base::~Base()
All threads completed, the last one deleted Derived</pre></div></div> 
</div>

<!-- 
NewPP limit report
Preprocessor visited node count: 10300/1000000
Preprocessor generated node count: 12631/1000000
Post‐expand include size: 330198/2097152 bytes
Template argument size: 72863/2097152 bytes
Highest expansion depth: 22/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mwiki1-mwiki_en_:pcache:idhash:2177-0!*!0!!en!*!* and timestamp 20160422221823 -->
</div>                    <!-- /bodycontent -->
                                        <!-- printfooter -->
                    <div class="printfooter">
                    Retrieved from &quot;<a href="http://en.cppreference.com/mwiki/index.php">http://en.cppreference.com/mwiki/index.php?title=cpp/memory/shared_ptr&amp;oldid=84028</a>&quot;                    </div>
                    <!-- /printfooter -->
                                                            <!-- catlinks -->
                    <div class="catlinks catlinks-allhidden" id="catlinks"></div>                    <!-- /catlinks -->
                                                            <div class="visualClear"></div>
                    <!-- debughtml -->
                                        <!-- /debughtml -->
                </div>
                <!-- /bodyContent -->
            </div>
        </div>
        <!-- /content -->
        <!-- footer -->
        
        <!-- /footer -->
        <script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script src="../../../common/skin_scripts.js"></script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest","mediawiki.hidpi","ext.gadget.ColiruCompiler"], null, true);
}</script>
<script src="../../../common/site_scripts.js"></script>

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-2828341-1']);
_gaq.push(['_setDomainName', 'cppreference.com']);
_gaq.push(['_trackPageview']);
</script><!-- Served in 3.058 secs. -->
	</body>



<!-- Cached 20160422221823 -->

</html>