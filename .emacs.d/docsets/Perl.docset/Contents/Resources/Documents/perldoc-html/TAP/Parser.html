<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>TAP::Parser</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Language" content="en-gb">
  <link rel="search" type="application/opensearchdescription+xml" title="Search perldoc.perl.org" href="/static/search.xml"/>
  <link href="../static/css-20100830.css" rel="stylesheet" rev="stylesheet" type="text/css" media="screen">
  <link href="../static/exploreperl.css" rel="stylesheet" rev="stylesheet" type="text/css">
</head>

<body onLoad="perldoc.startup();" onPageShow="if (event.persisted) perldoc.startup();">
    <div id="page">
      
      <div id="header">
	<div id="homepage_link">
	  <a href="../index.html"></a>
	</div>
	<div id="strapline">
	  Perl Programming Documentation
	</div>
	<div id="download_link" class="download">
	  <a href="http://www.perl.org/get.html">Download Perl</a>
	</div>
	<div id="explore_link" class="download">
	  <a id="explore_anchor" href="#">Explore</a>
	</div>
      </div>
      
      <div id="body">
        <div id="left_column">
          <div class="side_group">
            
	    <div class="side_panel doc_panel">
              <p>Manual</p>
              <ul>
                <li><a href="../index-overview.html">Overview</a>
                <li><a href="../index-tutorials.html">Tutorials</a>
                <li><a href="../index-faq.html">FAQs</a>
                <li><a href="../index-history.html">History / Changes</a>
                <li><a href="../index-licence.html">License</a>
              </ul>
            </div>
            <div class="side_panel doc_panel">
              <p>Reference</p>
              <ul>
                <li><a href="../index-language.html">Language</a>
                <li><a href="../index-functions.html">Functions</a>
                <li><a href="../perlop.html">Operators</a>
                <li><a href="../perlvar.html">Special Variables</a>
                <li><a href="../index-pragmas.html">Pragmas</a>
                <li><a href="../index-utilities.html">Utilities</a>
                <li><a href="../index-internals.html">Internals</a>
                <li><a href="../index-platforms.html">Platform Specific</a>
              </ul>
            </div>
            <div class="side_panel doc_panel">
              <p>Modules</p>
              <ul>
		<li>
		
                
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		    
		  
		
                  
		
                  
		
                  
		    
		  
		
                  
		
                  
		
		
                    <a href="../index-modules-A.html">A</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-B.html">B</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-C.html">C</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-D.html">D</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-E.html">E</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../index-modules-F.html">F</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-G.html">G</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-H.html">H</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-I.html">I</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-L.html">L</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../index-modules-M.html">M</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-N.html">N</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-O.html">O</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-P.html">P</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-S.html">S</a>
                    
                      
                        <li>
                      
                    
                
                    <a href="../index-modules-T.html">T</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-U.html">U</a>
                    
                      
                        &bull;
                      
                    
                
                    <a href="../index-modules-X.html">X</a>
                    
                
              </ul>
            </div>
            
	      <div class="side_panel doc_panel">
		<p>Tools</p>
		<ul>
		  <li><a href="../preferences.html">Preferences</a>
		</ul>
	      </div>
            
          </div>
        </div>
        <div id="centre_column">
          <div id="content_header">
            <div id="title_bar">
              <div id="page_name">
                <h1>TAP::Parser</h1>
              </div>
              <div id="perl_version">
                Perl 5 version 22.0 documentation
              </div>
              <div class="page_links" id="page_links_top">
                <a href="#" onClick="toolbar.goToTop();return false;">Go to top</a>
		
              </div>
	      <div class="page_links" id="page_links_bottom">
		
                  <a href="#" id="page_index_toggle">Show page index</a> &bull;
		
                <a href="#" id="recent_pages_toggle">Show recent pages</a>		
	      </div>
	      <div id="search_form">
		<form action="../search.html" method="GET" id="search">
		  <input type="text" name="q" id="search_box" alt="Search">
		</form>
	      </div>
            </div>
            <div id="breadcrumbs">
                
    <a href="../index.html">Home</a> &gt;
    
      
        <a href="../index-modules-T.html">Core modules (T)</a> &gt;
      
    
    TAP::Parser
  

            </div>
          </div>
          <div id="content_body">
	    <!--[if lt IE 7]>
 <div class="noscript">
   <p>
     <strong>It looks like you're using Internet Explorer 6. This is a very old
     browser which does not offer full support for modern websites.</strong>
   </p>
   <p>
     Unfortunately this means that this website will not work on
     your computer.
   </p>
   <p>
     Don't miss out though! To view the site (and get a better experience from
     many other websites), simply upgrade to
     <a href="http://www.microsoft.com/windows/Internet-explorer/default.aspx">Internet
Explorer 8</a>
     or download an alternative browser such as
     <a href="http://www.mozilla.com/en-US/firefox/firefox.html">Firefox</a>,
     <a href="http://www.apple.com/safari/download/">Safari</a>, or
     <a href="http://www.google.co.uk/chrome">Google Chrome</a>.
   </p>
   <p>
     All of these browsers are free. If you're using a PC at work, you may
     need to contact your IT administrator.
   </p>
 </div>
<![endif]-->
	    <noscript>
	      <div class="noscript">
	      <p>
                <strong>Please note: Many features of this site require JavaScript. You appear to have JavaScript disabled,
	        or are running a non-JavaScript capable web browser.</strong>
	      </p>
	      <p>
		To get the best experience, please enable JavaScript or download a modern web browser such as <a href="http://www.microsoft.com/windows/Internet-explorer/default.aspx">Internet Explorer 8</a>, <a href="http://www.mozilla.com/en-US/firefox/firefox.html">Firefox</a>, <a href="http://www.apple.com/safari/download/">Safari</a>, or <a href="http://www.google.co.uk/chrome">Google Chrome</a>.
              </p>
	      </div>
	    </noscript>

	    <div id="recent_pages" class="hud_container">
	      <div id="recent_pages_header" class="hud_header">
		<div id="recent_pages_close" class="hud_close"><a href="#" onClick="recentPages.hide();return false;"></a></div>
		<div id="recent_pages_title" class="hud_title"><span class="hud_span_top">Recently read</span></div>
		<div id="recent_pages_topright" class="hud_topright"></div>
	      </div>
	      <div id="recent_pages_content" class="hud_content">
	      </div>
	      <div id="recent_pages_footer" class="hud_footer">
		<div id="recent_pages_bottomleft" class="hud_bottomleft"></div>
		<div id="recent_pages_bottom" class="hud_bottom"><span class="hud_span_bottom"></span></div>
		<div id="recent_pages_resize" class="hud_resize"></div>
	      </div>
	    </div>
  
	    <div id="from_search"></div>
            <h1>TAP::Parser</h1>


  <!--    -->
<ul><li><a href="#NAME">NAME</a><li><a href="#VERSION">VERSION</a><li><a href="#SYNOPSIS">SYNOPSIS</a><li><a href="#DESCRIPTION">DESCRIPTION</a><li><a href="#METHODS">METHODS</a><ul><li><a href="#Class-Methods">Class Methods</a><li><a href="#Instance-Methods">Instance Methods</a></ul><li><a href="#INDIVIDUAL-RESULTS">INDIVIDUAL RESULTS</a><ul><li><a href="#Result-types">Result types</a><li><a href="#Common-type-methods">Common type methods</a><li><a href="#plan-methods">plan methods</a><li><a href="#pragma-methods">pragma methods</a><li><a href="#comment-methods">comment methods</a><li><a href="#bailout-methods">bailout methods</a><li><a href="#unknown-methods">unknown methods</a><li><a href="#test-methods">test methods</a></ul><li><a href="#TOTAL-RESULTS">TOTAL RESULTS</a><ul><li><a href="#Individual-Results">Individual Results</a><li><a href="#Pragmas">Pragmas</a><li><a href="#Summary-Results">Summary Results</a><li><a href="#ignore_exit">ignore_exit</a></ul><li><a href="#CALLBACKS">CALLBACKS</a><li><a href="#TAP-GRAMMAR">TAP GRAMMAR</a><li><a href="#BACKWARDS-COMPATIBILITY">BACKWARDS COMPATIBILITY</a><ul><li><a href="#Differences">Differences</a></ul><li><a href="#SUBCLASSING">SUBCLASSING</a><ul><li><a href="#Parser-Components">Parser Components</a></ul><li><a href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a><li><a href="#AUTHORS">AUTHORS</a><li><a href="#BUGS">BUGS</a><li><a href="#COPYRIGHT-%26-LICENSE">COPYRIGHT & LICENSE</a></ul><a name="NAME"></a><h1>NAME</h1>
<p>TAP::Parser - Parse <a href="http://search.cpan.org/perldoc/Test::Harness::TAP">TAP</a> output</p>
<a name="VERSION"></a><h1>VERSION</h1>
<p>Version 3.35</p>
<a name="SYNOPSIS"></a><h1>SYNOPSIS</h1>
<pre class="verbatim"><ol><li>    <a class="l_k" href="../functions/use.html">use</a> <span class="w">TAP::Parser</span><span class="sc">;</span></li><li></li><li>    <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span> <span class="s">{</span> <span class="w">source</span> <span class="cm">=&gt;</span> <span class="i">$source</span> <span class="s">}</span> <span class="s">)</span><span class="sc">;</span></li><li></li><li>    while <span class="s">(</span> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$result</span> = <span class="i">$parser</span><span class="i">-&gt;next</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="../functions/print.html">print</a> <span class="i">$result</span><span class="i">-&gt;as_string</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><a name="DESCRIPTION"></a><h1>DESCRIPTION</h1>
<p><code class="inline"><span class="w">TAP::Parser</span></code>
 is designed to produce a proper parse of TAP output. For
an example of how to run tests through this module, see the simple
harnesses <code class="inline"><span class="w">examples</span>/</code>
.</p>
<p>There's a wiki dedicated to the Test Anything Protocol:</p>
<p><a href="http://testanything.org">http://testanything.org</a></p>
<p>It includes the TAP::Parser Cookbook:</p>
<p><a href="http://testanything.org/wiki/index.php/TAP::Parser_Cookbook">http://testanything.org/wiki/index.php/TAP::Parser_Cookbook</a></p>
<a name="METHODS"></a><h1>METHODS</h1>
<a name="Class-Methods"></a><h2>Class Methods</h2>
<a name="new"></a><h3><code class="inline"><span class="w">new</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span>\<span class="i">%args</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>Returns a new <code class="inline"><span class="w">TAP::Parser</span></code>
 object.</p>
<p>The arguments should be a hashref with <i>one</i> of the following keys:</p>
<ul>
<li><a name="*-source"></a><b><code class="inline"><span class="w">source</span></code>
</b>
<p><i>CHANGED in 3.18</i></p>
<p>This is the preferred method of passing input to the constructor.</p>
<p>The <code class="inline"><span class="w">source</span></code>
 is used to create a <a href="../TAP/Parser/Source.html">TAP::Parser::Source</a> that is passed to the
<a href="#iterator_factory_class">iterator_factory_class</a> which in turn figures out how to handle the source and
creates a &lt;TAP::Parser::Iterator&gt; for it.  The iterator is used by the parser to
read in the TAP stream.</p>
<p>To configure the <i>IteratorFactory</i> use the <code class="inline"><span class="w">sources</span></code>
 parameter below.</p>
<p>Note that <code class="inline"><span class="w">source</span></code>
, <code class="inline"><span class="w">tap</span></code>
 and <code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code> are <i>mutually exclusive</i>.</p>
</li>
<li><a name="*-tap"></a><b><code class="inline"><span class="w">tap</span></code>
</b>
<p><i>CHANGED in 3.18</i></p>
<p>The value should be the complete TAP output.</p>
<p>The <i>tap</i> is used to create a <a href="../TAP/Parser/Source.html">TAP::Parser::Source</a> that is passed to the
<a href="#iterator_factory_class">iterator_factory_class</a> which in turn figures out how to handle the source and
creates a &lt;TAP::Parser::Iterator&gt; for it.  The iterator is used by the parser to
read in the TAP stream.</p>
<p>To configure the <i>IteratorFactory</i> use the <code class="inline"><span class="w">sources</span></code>
 parameter below.</p>
<p>Note that <code class="inline"><span class="w">source</span></code>
, <code class="inline"><span class="w">tap</span></code>
 and <code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code> are <i>mutually exclusive</i>.</p>
</li>
<li><a name="*-exec"></a><b><code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code></b>
<p>Must be passed an array reference.</p>
<p>The <i>exec</i> array ref is used to create a <a href="../TAP/Parser/Source.html">TAP::Parser::Source</a> that is passed
to the <a href="#iterator_factory_class">iterator_factory_class</a> which in turn figures out how to handle the
source and creates a &lt;TAP::Parser::Iterator&gt; for it.  The iterator is used by
the parser to read in the TAP stream.</p>
<p>By default the <a href="../TAP/Parser/SourceHandler/Executable.html">TAP::Parser::SourceHandler::Executable</a> class will create a
<a href="../TAP/Parser/Iterator/Process.html">TAP::Parser::Iterator::Process</a> object to handle the source.  This passes the
array reference strings as command arguments to <a href="../IPC/Open3.html">IPC::Open3::open3</a>:</p>
<pre class="verbatim"><ol><li> <span class="w">exec</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;/usr/bin/ruby&#39;</span><span class="cm">,</span> <span class="q">&#39;t/my_test.rb&#39;</span> <span class="s">]</span></li></ol></pre><p>If any <code class="inline"><span class="w">test_args</span></code>
 are given they will be appended to the end of the command
argument list.</p>
<p>To configure the <i>IteratorFactory</i> use the <code class="inline"><span class="w">sources</span></code>
 parameter below.</p>
<p>Note that <code class="inline"><span class="w">source</span></code>
, <code class="inline"><span class="w">tap</span></code>
 and <code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code> are <i>mutually exclusive</i>.</p>
</li>
</ul>
<p>The following keys are optional.</p>
<ul>
<li><a name="*-sources"></a><b><code class="inline"><span class="w">sources</span></code>
</b>
<p><i>NEW to 3.18</i>.</p>
<p>If set, <code class="inline"><span class="w">sources</span></code>
 must be a hashref containing the names of the
<a href="../TAP/Parser/SourceHandler.html">TAP::Parser::SourceHandler</a>s to load and/or configure.  The values are a
hash of configuration that will be accessible to the source handlers via
<a href="../TAP/Parser/Source.html#config_for">config_for in TAP::Parser::Source</a>.</p>
<p>For example:</p>
<pre class="verbatim"><ol><li>  <span class="w">sources</span> <span class="cm">=&gt;</span> <span class="s">{</span></li><li>    <span class="w">Perl</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">exec</span> <span class="cm">=&gt;</span> <span class="q">&#39;/path/to/custom/perl&#39;</span> <span class="s">}</span><span class="cm">,</span></li><li>    <span class="w">File</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">extensions</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;.tap&#39;</span><span class="cm">,</span> <span class="q">&#39;.txt&#39;</span> <span class="s">]</span> <span class="s">}</span><span class="cm">,</span></li><li>    <span class="w">MyCustom</span> <span class="cm">=&gt;</span> <span class="s">{</span> <span class="w">some</span> <span class="cm">=&gt;</span> <span class="q">&#39;config&#39;</span> <span class="s">}</span><span class="cm">,</span></li><li>  <span class="s">}</span></li></ol></pre><p>This will cause <code class="inline"><span class="w">TAP::Parser</span></code>
 to pass custom configuration to two of the built-
in source handlers - <a href="../TAP/Parser/SourceHandler/Perl.html">TAP::Parser::SourceHandler::Perl</a>,
<a href="../TAP/Parser/SourceHandler/File.html">TAP::Parser::SourceHandler::File</a> - and attempt to load the <code class="inline"><span class="w">MyCustom</span></code>

class.  See <a href="../TAP/Parser/IteratorFactory.html#load_handlers">load_handlers in TAP::Parser::IteratorFactory</a> for more detail.</p>
<p>The <code class="inline"><span class="w">sources</span></code>
 parameter affects how <code class="inline"><span class="w">source</span></code>
, <code class="inline"><span class="w">tap</span></code>
 and <code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code> parameters
are handled.</p>
<p>See <a href="../TAP/Parser/IteratorFactory.html">TAP::Parser::IteratorFactory</a>, <a href="../TAP/Parser/SourceHandler.html">TAP::Parser::SourceHandler</a> and subclasses for
more details.</p>
</li>
<li><a name="*-callback"></a><b><code class="inline"><span class="w">callback</span></code>
</b>
<p>If present, each callback corresponding to a given result type will be called
with the result as the argument if the <code class="inline"><span class="w">run</span></code>
 method is used:</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">%callbacks</span> = <span class="s">(</span></li><li>     <span class="w">test</span>    <span class="cm">=&gt;</span> \<span class="i">&amp;test_callback</span><span class="cm">,</span></li><li>     <span class="w">plan</span>    <span class="cm">=&gt;</span> \<span class="i">&amp;plan_callback</span><span class="cm">,</span></li><li>     <span class="w">comment</span> <span class="cm">=&gt;</span> \<span class="i">&amp;comment_callback</span><span class="cm">,</span></li><li>     <span class="w">bailout</span> <span class="cm">=&gt;</span> \<span class="i">&amp;bailout_callback</span><span class="cm">,</span></li><li>     <span class="w">unknown</span> <span class="cm">=&gt;</span> \<span class="i">&amp;unknown_callback</span><span class="cm">,</span></li><li> <span class="s">)</span><span class="sc">;</span></li><li></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$aggregator</span> = <span class="w">TAP::Parser::Aggregator</span><span class="w">-&gt;new</span><span class="sc">;</span></li><li> for <a class="l_k" href="../functions/my.html">my</a> <span class="i">$file</span> <span class="s">(</span> <span class="i">@test_files</span> <span class="s">)</span> <span class="s">{</span></li><li>     <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span></li><li>         <span class="s">{</span></li><li>             <span class="w">source</span>    <span class="cm">=&gt;</span> <span class="i">$file</span><span class="cm">,</span></li><li>             <span class="w">callbacks</span> <span class="cm">=&gt;</span> \<span class="i">%callbacks</span><span class="cm">,</span></li><li>         <span class="s">}</span></li><li>     <span class="s">)</span><span class="sc">;</span></li><li>     <span class="i">$parser</span><span class="i">-&gt;run</span><span class="sc">;</span></li><li>     <span class="i">$aggregator</span><span class="i">-&gt;add</span><span class="s">(</span> <span class="i">$file</span><span class="cm">,</span> <span class="i">$parser</span> <span class="s">)</span><span class="sc">;</span></li><li> <span class="s">}</span></li></ol></pre></li>
<li><a name="*-switches"></a><b><code class="inline"><span class="w">switches</span></code>
</b>
<p>If using a Perl file as a source, optional switches may be passed which will
be used when invoking the perl executable.</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span> <span class="s">{</span></li><li>     <span class="w">source</span>   <span class="cm">=&gt;</span> <span class="i">$test_file</span><span class="cm">,</span></li><li>     <span class="w">switches</span> <span class="cm">=&gt;</span> <span class="s">[</span> <span class="q">&#39;-Ilib&#39;</span> <span class="s">]</span><span class="cm">,</span></li><li> <span class="s">}</span> <span class="s">)</span><span class="sc">;</span></li></ol></pre></li>
<li><a name="*-test_args"></a><b><code class="inline"><span class="w">test_args</span></code>
</b>
<p>Used in conjunction with the <code class="inline"><span class="w">source</span></code>
 and <code class="inline"><a class="l_k" href="../functions/exec.html">exec</a></code> option to supply a reference
to an <code class="inline"><span class="i">@ARGV</span></code>
 style array of arguments to pass to the test program.</p>
</li>
<li><a name="*-spool"></a><b><code class="inline"><span class="w">spool</span></code>
</b>
<p>If passed a filehandle will write a copy of all parsed TAP to that handle.</p>
</li>
<li><a name="*-merge"></a><b><code class="inline"><span class="w">merge</span></code>
</b>
<p>If false, STDERR is not captured (though it is 'relayed' to keep it
somewhat synchronized with STDOUT.)</p>
<p>If true, STDERR and STDOUT are the same filehandle.  This may cause
breakage if STDERR contains anything resembling TAP format, but does
allow exact synchronization.</p>
<p>Subtleties of this behavior may be platform-dependent and may change in
the future.</p>
</li>
<li><a name="*-grammar_class"></a><b><code class="inline"><span class="w">grammar_class</span></code>
</b>
<p>This option was introduced to let you easily customize which <i>grammar</i> class
the parser should use.  It defaults to <a href="../TAP/Parser/Grammar.html">TAP::Parser::Grammar</a>.</p>
<p>See also <a href="#make_grammar">make_grammar</a>.</p>
</li>
<li><a name="*-result_factory_class"></a><b><code class="inline"><span class="w">result_factory_class</span></code>
</b>
<p>This option was introduced to let you easily customize which <i>result</i>
factory class the parser should use.  It defaults to
<a href="../TAP/Parser/ResultFactory.html">TAP::Parser::ResultFactory</a>.</p>
<p>See also <a href="#make_result">make_result</a>.</p>
</li>
<li><a name="*-iterator_factory_class"></a><b><code class="inline"><span class="w">iterator_factory_class</span></code>
</b>
<p><i>CHANGED in 3.18</i></p>
<p>This option was introduced to let you easily customize which <i>iterator</i>
factory class the parser should use.  It defaults to
<a href="../TAP/Parser/IteratorFactory.html">TAP::Parser::IteratorFactory</a>.</p>
</li>
</ul>
<a name="Instance-Methods"></a><h2>Instance Methods</h2>
<a name="next"></a><h3><code class="inline"><a class="l_k" href="../functions/next.html">next</a></code></h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span> <span class="s">{</span> <span class="w">source</span> <span class="cm">=&gt;</span> <span class="i">$file</span> <span class="s">}</span> <span class="s">)</span><span class="sc">;</span></li><li>  while <span class="s">(</span> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$result</span> = <span class="i">$parser</span><span class="i">-&gt;next</span> <span class="s">)</span> <span class="s">{</span></li><li>      <a class="l_k" href="../functions/print.html">print</a> <span class="i">$result</span><span class="i">-&gt;as_string</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></li><li>  <span class="s">}</span></li></ol></pre><p>This method returns the results of the parsing, one result at a time.  Note
that it is destructive.  You can't rewind and examine previous results.</p>
<p>If callbacks are used, they will be issued before this call returns.</p>
<p>Each result returned is a subclass of <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a>.  See that
module and related classes for more information on how to use them.</p>
<a name="run"></a><h3><code class="inline"><span class="w">run</span></code>
</h3>
<pre class="verbatim"><ol><li>  <span class="i">$parser</span><span class="i">-&gt;run</span><span class="sc">;</span></li></ol></pre><p>This method merely runs the parser and parses all of the TAP.</p>
<a name="make_grammar"></a><h3><code class="inline"><span class="w">make_grammar</span></code>
</h3>
<p>Make a new <a href="../TAP/Parser/Grammar.html">TAP::Parser::Grammar</a> object and return it.  Passes through any
arguments given.</p>
<p>The <code class="inline"><span class="w">grammar_class</span></code>
 can be customized, as described in <a href="#new">new</a>.</p>
<a name="make_result"></a><h3><code class="inline"><span class="w">make_result</span></code>
</h3>
<p>Make a new <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a> object using the parser's
<a href="../TAP/Parser/ResultFactory.html">TAP::Parser::ResultFactory</a>, and return it.  Passes through any arguments
given.</p>
<p>The <code class="inline"><span class="w">result_factory_class</span></code>
 can be customized, as described in <a href="#new">new</a>.</p>
<a name="make_iterator_factory"></a><h3><code class="inline"><span class="w">make_iterator_factory</span></code>
</h3>
<p><i>NEW to 3.18</i>.</p>
<p>Make a new <a href="../TAP/Parser/IteratorFactory.html">TAP::Parser::IteratorFactory</a> object and return it.  Passes through
any arguments given.</p>
<p><code class="inline"><span class="w">iterator_factory_class</span></code>
 can be customized, as described in <a href="#new">new</a>.</p>
<a name="INDIVIDUAL-RESULTS"></a><h1>INDIVIDUAL RESULTS</h1>
<p>If you've read this far in the docs, you've seen this:</p>
<pre class="verbatim"><ol><li>    while <span class="s">(</span> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$result</span> = <span class="i">$parser</span><span class="i">-&gt;next</span> <span class="s">)</span> <span class="s">{</span></li><li>        <a class="l_k" href="../functions/print.html">print</a> <span class="i">$result</span><span class="i">-&gt;as_string</span><span class="sc">;</span></li><li>    <span class="s">}</span></li></ol></pre><p>Each result returned is a <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a> subclass, referred to as
<i>result types</i>.</p>
<a name="Result-types"></a><h2>Result types</h2>
<p>Basically, you fetch individual results from the TAP.  The six types, with
examples of each, are as follows:</p>
<ul>
<li><a name="*-Version"></a><b>Version</b>
<pre class="verbatim"><ol><li> <span class="w">TAP</span> <span class="w">version</span> <span class="n">12</span></li></ol></pre></li>
<li><a name="*-Plan"></a><b>Plan</b>
<pre class="verbatim"><ol><li> <span class="n">1</span>..<span class="n">42</span></li></ol></pre></li>
<li><a name="*-Pragma"></a><b>Pragma</b>
<pre class="verbatim"><ol><li> <span class="w">pragma</span> +<span class="w">strict</span></li></ol></pre></li>
<li><a name="*-Test"></a><b>Test</b>
<pre class="verbatim"><ol><li> <span class="w">ok</span> <span class="n">3</span> - <span class="w">We</span> <span class="w">should</span> <span class="w">start</span> <span class="w">with</span> <span class="w">some</span> <span class="w">foobar</span>!</li></ol></pre></li>
<li><a name="*-Comment"></a><b>Comment</b>
<pre class="verbatim"><ol><li> <span class="c"># Hope we don&#39;t use up the foobar.</span></li></ol></pre></li>
<li><a name="*-Bailout"></a><b>Bailout</b>
<pre class="verbatim"><ol><li> <span class="w">Bail</span> <span class="w">out</span>!  <span class="w">We</span> <span class="w">ran</span> <span class="w">out</span> <span class="w">of</span> <span class="w">foobar</span>!</li></ol></pre></li>
<li><a name="*-Unknown"></a><b>Unknown</b>
<pre class="verbatim"><ol><li> ... <span class="w">yo</span><span class="cm">,</span> <span class="w">this</span> <span class="w">ain&#39;t</span> <span class="w">TAP</span>! ...</li></ol></pre></li>
</ul>
<p>Each result fetched is a result object of a different type.  There are common
methods to each result object and different types may have methods unique to
their type.  Sometimes a type method may be overridden in a subclass, but its
use is guaranteed to be identical.</p>
<a name="Common-type-methods"></a><h2>Common type methods</h2>
<a name="type"></a><h3><code class="inline"><span class="w">type</span></code>
</h3>
<p>Returns the type of result, such as <code class="inline"><span class="w">comment</span></code>
 or <code class="inline"><span class="w">test</span></code>
.</p>
<a name="as_string"></a><h3><code class="inline"><span class="w">as_string</span></code>
</h3>
<p>Prints a string representation of the token.  This might not be the exact
output, however.  Tests will have test numbers added if not present, TODO and
SKIP directives will be capitalized and, in general, things will be cleaned
up.  If you need the original text for the token, see the <code class="inline"><span class="w">raw</span></code>
 method.</p>
<a name="raw"></a><h3><code class="inline"><span class="w">raw</span></code>
</h3>
<p>Returns the original line of text which was parsed.</p>
<a name="is_plan"></a><h3><code class="inline"><span class="w">is_plan</span></code>
</h3>
<p>Indicates whether or not this is the test plan line.</p>
<a name="is_test"></a><h3><code class="inline"><span class="w">is_test</span></code>
</h3>
<p>Indicates whether or not this is a test line.</p>
<a name="is_comment"></a><h3><code class="inline"><span class="w">is_comment</span></code>
</h3>
<p>Indicates whether or not this is a comment. Comments will generally only
appear in the TAP stream if STDERR is merged to STDOUT. See the
<code class="inline"><span class="w">merge</span></code>
 option.</p>
<a name="is_bailout"></a><h3><code class="inline"><span class="w">is_bailout</span></code>
</h3>
<p>Indicates whether or not this is bailout line.</p>
<a name="is_yaml"></a><h3><code class="inline"><span class="w">is_yaml</span></code>
</h3>
<p>Indicates whether or not the current item is a YAML block.</p>
<a name="is_unknown"></a><h3><code class="inline"><span class="w">is_unknown</span></code>
</h3>
<p>Indicates whether or not the current line could be parsed.</p>
<a name="is_ok"></a><h3><code class="inline"><span class="w">is_ok</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_ok</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Reports whether or not a given result has passed.  Anything which is <b>not</b> a
test result returns true.  This is merely provided as a convenient shortcut
which allows you to do this:</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span> <span class="s">{</span> <span class="w">source</span> <span class="cm">=&gt;</span> <span class="i">$source</span> <span class="s">}</span> <span class="s">)</span><span class="sc">;</span></li><li> while <span class="s">(</span> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$result</span> = <span class="i">$parser</span><span class="i">-&gt;next</span> <span class="s">)</span> <span class="s">{</span></li><li>     <span class="c"># only print failing results</span></li><li>     <a class="l_k" href="../functions/print.html">print</a> <span class="i">$result</span><span class="i">-&gt;as_string</span> unless <span class="i">$result</span><span class="i">-&gt;is_ok</span><span class="sc">;</span></li><li> <span class="s">}</span></li></ol></pre><a name="plan-methods"></a><h2><code class="inline"><span class="w">plan</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_plan</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If the above evaluates as true, the following methods will be available on the
<code class="inline"><span class="i">$result</span></code>
 object.</p>
<a name="plan"></a><h3><code class="inline"><span class="w">plan</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_plan</span> <span class="s">)</span> <span class="s">{</span></li><li>     <a class="l_k" href="../functions/print.html">print</a> <span class="i">$result</span><span class="i">-&gt;plan</span><span class="sc">;</span></li><li>  <span class="s">}</span></li></ol></pre><p>This is merely a synonym for <code class="inline"><span class="w">as_string</span></code>
.</p>
<a name="directive"></a><h3><code class="inline"><span class="w">directive</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$directive</span> = <span class="i">$result</span><span class="i">-&gt;directive</span><span class="sc">;</span></li></ol></pre><p>If a SKIP directive is included with the plan, this method will return it.</p>
<pre class="verbatim"><ol><li> <span class="n">1</span>..<span class="n">0</span> <span class="c"># SKIP: why bother?</span></li></ol></pre><a name="explanation"></a><h3><code class="inline"><span class="w">explanation</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$explanation</span> = <span class="i">$result</span><span class="i">-&gt;explanation</span><span class="sc">;</span></li></ol></pre><p>If a SKIP directive was included with the plan, this method will return the
explanation, if any.</p>
<a name="pragma-methods"></a><h2><code class="inline"><span class="w">pragma</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_pragma</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If the above evaluates as true, the following methods will be available on the
<code class="inline"><span class="i">$result</span></code>
 object.</p>
<a name="pragmas"></a><h3><code class="inline"><span class="w">pragmas</span></code>
</h3>
<p>Returns a list of pragmas each of which is a + or - followed by the
pragma name.</p>
<a name="comment-methods"></a><h2><code class="inline"><span class="w">comment</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_comment</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If the above evaluates as true, the following methods will be available on the
<code class="inline"><span class="i">$result</span></code>
 object.</p>
<a name="comment"></a><h3><code class="inline"><span class="w">comment</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_comment</span> <span class="s">)</span> <span class="s">{</span></li><li>      <a class="l_k" href="../functions/my.html">my</a> <span class="i">$comment</span> = <span class="i">$result</span><span class="i">-&gt;comment</span><span class="sc">;</span></li><li>      <a class="l_k" href="../functions/print.html">print</a> <span class="q">&quot;I have something to say:  $comment&quot;</span><span class="sc">;</span></li><li>  <span class="s">}</span></li></ol></pre><a name="bailout-methods"></a><h2><code class="inline"><span class="w">bailout</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_bailout</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If the above evaluates as true, the following methods will be available on the
<code class="inline"><span class="i">$result</span></code>
 object.</p>
<a name="explanation"></a><h3><code class="inline"><span class="w">explanation</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_bailout</span> <span class="s">)</span> <span class="s">{</span></li><li>      <a class="l_k" href="../functions/my.html">my</a> <span class="i">$explanation</span> = <span class="i">$result</span><span class="i">-&gt;explanation</span><span class="sc">;</span></li><li>      <a class="l_k" href="../functions/print.html">print</a> <span class="q">&quot;We bailed out because ($explanation)&quot;</span><span class="sc">;</span></li><li>  <span class="s">}</span></li></ol></pre><p>If, and only if, a token is a bailout token, you can get an "explanation" via
this method.  The explanation is the text after the mystical "Bail out!" words
which appear in the tap output.</p>
<a name="unknown-methods"></a><h2><code class="inline"><span class="w">unknown</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_unknown</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>There are no unique methods for unknown results.</p>
<a name="test-methods"></a><h2><code class="inline"><span class="w">test</span></code>
 methods</h2>
<pre class="verbatim"><ol><li> if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_test</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If the above evaluates as true, the following methods will be available on the
<code class="inline"><span class="i">$result</span></code>
 object.</p>
<a name="ok"></a><h3><code class="inline"><span class="w">ok</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$ok</span> = <span class="i">$result</span><span class="i">-&gt;ok</span><span class="sc">;</span></li></ol></pre><p>Returns the literal text of the <code class="inline"><span class="w">ok</span></code>
 or <code class="inline">not <span class="w">ok</span></code>
 status.</p>
<a name="number"></a><h3><code class="inline"><span class="w">number</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$test_number</span> = <span class="i">$result</span><span class="i">-&gt;number</span><span class="sc">;</span></li></ol></pre><p>Returns the number of the test, even if the original TAP output did not supply
that number.</p>
<a name="description"></a><h3><code class="inline"><span class="w">description</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$description</span> = <span class="i">$result</span><span class="i">-&gt;description</span><span class="sc">;</span></li></ol></pre><p>Returns the description of the test, if any.  This is the portion after the
test number but before the directive.</p>
<a name="directive"></a><h3><code class="inline"><span class="w">directive</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$directive</span> = <span class="i">$result</span><span class="i">-&gt;directive</span><span class="sc">;</span></li></ol></pre><p>Returns either <code class="inline"><span class="w">TODO</span></code>
 or <code class="inline"><span class="w">SKIP</span></code>
 if either directive was present for a test
line.</p>
<a name="explanation"></a><h3><code class="inline"><span class="w">explanation</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$explanation</span> = <span class="i">$result</span><span class="i">-&gt;explanation</span><span class="sc">;</span></li></ol></pre><p>If a test had either a <code class="inline"><span class="w">TODO</span></code>
 or <code class="inline"><span class="w">SKIP</span></code>
 directive, this method will return
the accompanying explanation, if present.</p>
<pre class="verbatim"><ol><li>  not <span class="w">ok</span> <span class="n">17</span> - <span class="q">&#39;Pigs can fly&#39;</span> <span class="c"># TODO not enough acid</span></li></ol></pre><p>For the above line, the explanation is <i>not enough acid</i>.</p>
<a name="is_ok"></a><h3><code class="inline"><span class="w">is_ok</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_ok</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Returns a boolean value indicating whether or not the test passed.  Remember
that for TODO tests, the test always passes.</p>
<p><b>Note:</b>  this was formerly <code class="inline"><span class="w">passed</span></code>
.  The latter method is deprecated and
will issue a warning.</p>
<a name="is_actual_ok"></a><h3><code class="inline"><span class="w">is_actual_ok</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;is_actual_ok</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Returns a boolean value indicating whether or not the test passed, regardless
of its TODO status.</p>
<p><b>Note:</b>  this was formerly <code class="inline"><span class="w">actual_passed</span></code>
.  The latter method is deprecated
and will issue a warning.</p>
<a name="is_unplanned"></a><h3><code class="inline"><span class="w">is_unplanned</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$test</span><span class="i">-&gt;is_unplanned</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>If a test number is greater than the number of planned tests, this method will
return true.  Unplanned tests will <i>always</i> return false for <code class="inline"><span class="w">is_ok</span></code>
,
regardless of whether or not the test <code class="inline"><span class="w">has_todo</span></code>
 (see
<a href="../TAP/Parser/Result/Test.html">TAP::Parser::Result::Test</a> for more information about this).</p>
<a name="has_skip"></a><h3><code class="inline"><span class="w">has_skip</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;has_skip</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Returns a boolean value indicating whether or not this test had a SKIP
directive.</p>
<a name="has_todo"></a><h3><code class="inline"><span class="w">has_todo</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$result</span><span class="i">-&gt;has_todo</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Returns a boolean value indicating whether or not this test had a TODO
directive.</p>
<p>Note that TODO tests <i>always</i> pass.  If you need to know whether or not
they really passed, check the <code class="inline"><span class="w">is_actual_ok</span></code>
 method.</p>
<a name="in_todo"></a><h3><code class="inline"><span class="w">in_todo</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$parser</span><span class="i">-&gt;in_todo</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>True while the most recent result was a TODO. Becomes true before the
TODO result is returned and stays true until just before the next non-
TODO test is returned.</p>
<a name="TOTAL-RESULTS"></a><h1>TOTAL RESULTS</h1>
<p>After parsing the TAP, there are many methods available to let you dig through
the results and determine what is meaningful to you.</p>
<a name="Individual-Results"></a><h2>Individual Results</h2>
<p>These results refer to individual tests which are run.</p>
<a name="passed"></a><h3><code class="inline"><span class="w">passed</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@passed</span> = <span class="i">$parser</span><span class="i">-&gt;passed</span><span class="sc">;</span> <span class="c"># the test numbers which passed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$passed</span> = <span class="i">$parser</span><span class="i">-&gt;passed</span><span class="sc">;</span> <span class="c"># the number of tests which passed</span></li></ol></pre><p>This method lets you know which (or how many) tests passed.  If a test failed
but had a TODO directive, it will be counted as a passed test.</p>
<a name="failed"></a><h3><code class="inline"><span class="w">failed</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@failed</span> = <span class="i">$parser</span><span class="i">-&gt;failed</span><span class="sc">;</span> <span class="c"># the test numbers which failed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$failed</span> = <span class="i">$parser</span><span class="i">-&gt;failed</span><span class="sc">;</span> <span class="c"># the number of tests which failed</span></li></ol></pre><p>This method lets you know which (or how many) tests failed.  If a test passed
but had a TODO directive, it will <b>NOT</b> be counted as a failed test.</p>
<a name="actual_passed"></a><h3><code class="inline"><span class="w">actual_passed</span></code>
</h3>
<pre class="verbatim"><ol><li> <span class="c"># the test numbers which actually passed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@actual_passed</span> = <span class="i">$parser</span><span class="i">-&gt;actual_passed</span><span class="sc">;</span></li><li></li><li> <span class="c"># the number of tests which actually passed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$actual_passed</span> = <span class="i">$parser</span><span class="i">-&gt;actual_passed</span><span class="sc">;</span></li></ol></pre><p>This method lets you know which (or how many) tests actually passed,
regardless of whether or not a TODO directive was found.</p>
<a name="actual_ok"></a><h3><code class="inline"><span class="w">actual_ok</span></code>
</h3>
<p>This method is a synonym for <code class="inline"><span class="w">actual_passed</span></code>
.</p>
<a name="actual_failed"></a><h3><code class="inline"><span class="w">actual_failed</span></code>
</h3>
<pre class="verbatim"><ol><li> <span class="c"># the test numbers which actually failed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@actual_failed</span> = <span class="i">$parser</span><span class="i">-&gt;actual_failed</span><span class="sc">;</span></li><li></li><li> <span class="c"># the number of tests which actually failed</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$actual_failed</span> = <span class="i">$parser</span><span class="i">-&gt;actual_failed</span><span class="sc">;</span></li></ol></pre><p>This method lets you know which (or how many) tests actually failed,
regardless of whether or not a TODO directive was found.</p>
<a name="todo"></a><h3><code class="inline"><span class="w">todo</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@todo</span> = <span class="i">$parser</span><span class="i">-&gt;todo</span><span class="sc">;</span> <span class="c"># the test numbers with todo directives</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$todo</span> = <span class="i">$parser</span><span class="i">-&gt;todo</span><span class="sc">;</span> <span class="c"># the number of tests with todo directives</span></li></ol></pre><p>This method lets you know which (or how many) tests had TODO directives.</p>
<a name="todo_passed"></a><h3><code class="inline"><span class="w">todo_passed</span></code>
</h3>
<pre class="verbatim"><ol><li> <span class="c"># the test numbers which unexpectedly succeeded</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@todo_passed</span> = <span class="i">$parser</span><span class="i">-&gt;todo_passed</span><span class="sc">;</span></li><li></li><li> <span class="c"># the number of tests which unexpectedly succeeded</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$todo_passed</span> = <span class="i">$parser</span><span class="i">-&gt;todo_passed</span><span class="sc">;</span></li></ol></pre><p>This method lets you know which (or how many) tests actually passed but were
declared as "TODO" tests.</p>
<a name="todo_failed"></a><h3><code class="inline"><span class="w">todo_failed</span></code>
</h3>
<pre class="verbatim"><ol><li>  <span class="c"># deprecated in favor of &#39;todo_passed&#39;.  This method was horribly misnamed.</span></li></ol></pre><p>This was a badly misnamed method.  It indicates which TODO tests unexpectedly
succeeded.  Will now issue a warning and call <code class="inline"><span class="w">todo_passed</span></code>
.</p>
<a name="skipped"></a><h3><code class="inline"><span class="w">skipped</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@skipped</span> = <span class="i">$parser</span><span class="i">-&gt;skipped</span><span class="sc">;</span> <span class="c"># the test numbers with SKIP directives</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$skipped</span> = <span class="i">$parser</span><span class="i">-&gt;skipped</span><span class="sc">;</span> <span class="c"># the number of tests with SKIP directives</span></li></ol></pre><p>This method lets you know which (or how many) tests had SKIP directives.</p>
<a name="Pragmas"></a><h2>Pragmas</h2>
<a name="pragma"></a><h3><code class="inline"><span class="w">pragma</span></code>
</h3>
<p>Get or set a pragma. To get the state of a pragma:</p>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$p</span><span class="i">-&gt;pragma</span><span class="s">(</span><span class="q">&#39;strict&#39;</span><span class="s">)</span> <span class="s">)</span> <span class="s">{</span></li><li>      <span class="c"># be strict</span></li><li>  <span class="s">}</span></li></ol></pre><p>To set the state of a pragma:</p>
<pre class="verbatim"><ol><li>  <span class="i">$p</span><span class="i">-&gt;pragma</span><span class="s">(</span><span class="q">&#39;strict&#39;</span><span class="cm">,</span> <span class="n">1</span><span class="s">)</span><span class="sc">;</span> <span class="c"># enable strict mode</span></li></ol></pre><a name="pragmas"></a><h3><code class="inline"><span class="w">pragmas</span></code>
</h3>
<p>Get a list of all the currently enabled pragmas:</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">@pragmas_enabled</span> = <span class="i">$p</span><span class="i">-&gt;pragmas</span><span class="sc">;</span></li></ol></pre><a name="Summary-Results"></a><h2>Summary Results</h2>
<p>These results are "meta" information about the total results of an individual
test program.</p>
<a name="plan"></a><h3><code class="inline"><span class="w">plan</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$plan</span> = <span class="i">$parser</span><span class="i">-&gt;plan</span><span class="sc">;</span></li></ol></pre><p>Returns the test plan, if found.</p>
<a name="good_plan"></a><h3><code class="inline"><span class="w">good_plan</span></code>
</h3>
<p>Deprecated.  Use <code class="inline"><span class="w">is_good_plan</span></code>
 instead.</p>
<a name="is_good_plan"></a><h3><code class="inline"><span class="w">is_good_plan</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$parser</span><span class="i">-&gt;is_good_plan</span> <span class="s">)</span> <span class="s">{</span> ... <span class="s">}</span></li></ol></pre><p>Returns a boolean value indicating whether or not the number of tests planned
matches the number of tests run.</p>
<p><b>Note:</b>  this was formerly <code class="inline"><span class="w">good_plan</span></code>
.  The latter method is deprecated and
will issue a warning.</p>
<p>And since we're on that subject ...</p>
<a name="tests_planned"></a><h3><code class="inline"><span class="w">tests_planned</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/print.html">print</a> <span class="i">$parser</span><span class="i">-&gt;tests_planned</span><span class="sc">;</span></li></ol></pre><p>Returns the number of tests planned, according to the plan.  For example, a
plan of '1..17' will mean that 17 tests were planned.</p>
<a name="tests_run"></a><h3><code class="inline"><span class="w">tests_run</span></code>
</h3>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/print.html">print</a> <span class="i">$parser</span><span class="i">-&gt;tests_run</span><span class="sc">;</span></li></ol></pre><p>Returns the number of tests which actually were run.  Hopefully this will
match the number of <code class="inline"><span class="i">$parser</span><span class="i">-&gt;tests_planned</span></code>
.</p>
<a name="skip_all"></a><h3><code class="inline"><span class="w">skip_all</span></code>
</h3>
<p>Returns a true value (actually the reason for skipping) if all tests
were skipped.</p>
<a name="start_time"></a><h3><code class="inline"><span class="w">start_time</span></code>
</h3>
<p>Returns the wall-clock time when the Parser was created.</p>
<a name="end_time"></a><h3><code class="inline"><span class="w">end_time</span></code>
</h3>
<p>Returns the wall-clock time when the end of TAP input was seen.</p>
<a name="start_times"></a><h3><code class="inline"><span class="w">start_times</span></code>
</h3>
<p>Returns the CPU times (like <a href="../functions/times.html">times</a> when the Parser was created.</p>
<a name="end_times"></a><h3><code class="inline"><span class="w">end_times</span></code>
</h3>
<p>Returns the CPU times (like <a href="../functions/times.html">times</a> when the end of TAP
input was seen.</p>
<a name="has_problems"></a><h3><code class="inline"><span class="w">has_problems</span></code>
</h3>
<pre class="verbatim"><ol><li>  if <span class="s">(</span> <span class="i">$parser</span><span class="i">-&gt;has_problems</span> <span class="s">)</span> <span class="s">{</span></li><li>      ...</li><li>  <span class="s">}</span></li></ol></pre><p>This is a 'catch-all' method which returns true if any tests have currently
failed, any TODO tests unexpectedly succeeded, or any parse errors occurred.</p>
<a name="version"></a><h3><code class="inline"><span class="w">version</span></code>
</h3>
<pre class="verbatim"><ol><li>  <span class="i">$parser</span><span class="i">-&gt;version</span><span class="sc">;</span></li></ol></pre><p>Once the parser is done, this will return the version number for the
parsed TAP. Version numbers were introduced with TAP version 13 so if no
version number is found version 12 is assumed.</p>
<a name="exit"></a><h3><code class="inline"><a class="l_k" href="../functions/exit.html">exit</a></code></h3>
<pre class="verbatim"><ol><li>  <span class="i">$parser</span><span class="i">-&gt;exit</span><span class="sc">;</span></li></ol></pre><p>Once the parser is done, this will return the exit status.  If the parser ran
an executable, it returns the exit status of the executable.</p>
<a name="wait"></a><h3><code class="inline"><a class="l_k" href="../functions/wait.html">wait</a></code></h3>
<pre class="verbatim"><ol><li>  <span class="i">$parser</span><span class="i">-&gt;wait</span><span class="sc">;</span></li></ol></pre><p>Once the parser is done, this will return the wait status.  If the parser ran
an executable, it returns the wait status of the executable.  Otherwise, this
merely returns the <code class="inline"><a class="l_k" href="../functions/exit.html">exit</a></code> status.</p>
<a name="ignore_exit"></a><h2><code class="inline"><span class="w">ignore_exit</span></code>
</h2>
<pre class="verbatim"><ol><li>  <span class="i">$parser</span><span class="i">-&gt;ignore_exit</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span></li></ol></pre><p>Tell the parser to ignore the exit status from the test when determining
whether the test passed. Normally tests with non-zero exit status are
considered to have failed even if all individual tests passed. In cases
where it is not possible to control the exit value of the test script
use this option to ignore it.</p>
<a name="parse_errors"></a><h3><code class="inline"><span class="w">parse_errors</span></code>
</h3>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">@errors</span> = <span class="i">$parser</span><span class="i">-&gt;parse_errors</span><span class="sc">;</span> <span class="c"># the parser errors</span></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$errors</span> = <span class="i">$parser</span><span class="i">-&gt;parse_errors</span><span class="sc">;</span> <span class="c"># the number of parser_errors</span></li></ol></pre><p>Fortunately, all TAP output is perfect.  In the event that it is not, this
method will return parser errors.  Note that a junk line which the parser does
not recognize is <code class="inline">not</code>
 an error.  This allows this parser to handle future
versions of TAP.  The following are all TAP errors reported by the parser:</p>
<ul>
<li><a name="*-Misplaced-plan"></a><b>Misplaced plan</b>
<p>The plan (for example, '1..5'), must only come at the beginning or end of the
TAP output.</p>
</li>
<li><a name="*-No-plan"></a><b>No plan</b>
<p>Gotta have a plan!</p>
</li>
<li><a name="*-More-than-one-plan"></a><b>More than one plan</b>
<pre class="verbatim"><ol><li> 1..3</li><li> ok 1 - input file opened</li><li> not ok 2 - first line of the input valid # todo some data</li><li> ok 3 read the rest of the file</li><li> 1..3</li></ol></pre><p>Right.  Very funny.  Don't do that.</p>
</li>
<li><a name="*-Test-numbers-out-of-sequence"></a><b>Test numbers out of sequence</b>
<pre class="verbatim"><ol><li> 1..3</li><li> ok 1 - input file opened</li><li> not ok 2 - first line of the input valid # todo some data</li><li> ok 2 read the rest of the file</li></ol></pre><p>That last test line above should have the number '3' instead of '2'.</p>
<p>Note that it's perfectly acceptable for some lines to have test numbers and
others to not have them.  However, when a test number is found, it must be in
sequence.  The following is also an error:</p>
<pre class="verbatim"><ol><li> 1..3</li><li> ok 1 - input file opened</li><li> not ok - first line of the input valid # todo some data</li><li> ok 2 read the rest of the file</li></ol></pre><p>But this is not:</p>
<pre class="verbatim"><ol><li> 1..3</li><li> ok  - input file opened</li><li> not ok - first line of the input valid # todo some data</li><li> ok 3 read the rest of the file</li></ol></pre></li>
</ul>
<a name="get_select_handles"></a><h3><code class="inline"><span class="w">get_select_handles</span></code>
</h3>
<p>Get an a list of file handles which can be passed to <code class="inline"><a class="l_k" href="../functions/select.html">select</a></code> to
determine the readiness of this parser.</p>
<a name="delete_spool"></a><h3><code class="inline"><span class="w">delete_spool</span></code>
</h3>
<p>Delete and return the spool.</p>
<pre class="verbatim"><ol><li>  <a class="l_k" href="../functions/my.html">my</a> <span class="i">$fh</span> = <span class="i">$parser</span><span class="i">-&gt;delete_spool</span><span class="sc">;</span></li></ol></pre><a name="CALLBACKS"></a><h1>CALLBACKS</h1>
<p>As mentioned earlier, a "callback" key may be added to the
<code class="inline"><span class="w">TAP::Parser</span></code>
 constructor. If present, each callback corresponding to a
given result type will be called with the result as the argument if the
<code class="inline"><span class="w">run</span></code>
 method is used. The callback is expected to be a subroutine
reference (or anonymous subroutine) which is invoked with the parser
result as its argument.</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">%callbacks</span> = <span class="s">(</span></li><li>     <span class="w">test</span>    <span class="cm">=&gt;</span> \<span class="i">&amp;test_callback</span><span class="cm">,</span></li><li>     <span class="w">plan</span>    <span class="cm">=&gt;</span> \<span class="i">&amp;plan_callback</span><span class="cm">,</span></li><li>     <span class="w">comment</span> <span class="cm">=&gt;</span> \<span class="i">&amp;comment_callback</span><span class="cm">,</span></li><li>     <span class="w">bailout</span> <span class="cm">=&gt;</span> \<span class="i">&amp;bailout_callback</span><span class="cm">,</span></li><li>     <span class="w">unknown</span> <span class="cm">=&gt;</span> \<span class="i">&amp;unknown_callback</span><span class="cm">,</span></li><li> <span class="s">)</span><span class="sc">;</span></li><li></li><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">$aggregator</span> = <span class="w">TAP::Parser::Aggregator</span><span class="w">-&gt;new</span><span class="sc">;</span></li><li> for <a class="l_k" href="../functions/my.html">my</a> <span class="i">$file</span> <span class="s">(</span> <span class="i">@test_files</span> <span class="s">)</span> <span class="s">{</span></li><li>     <a class="l_k" href="../functions/my.html">my</a> <span class="i">$parser</span> = <span class="w">TAP::Parser</span><span class="w">-&gt;new</span><span class="s">(</span></li><li>         <span class="s">{</span></li><li>             <span class="w">source</span>    <span class="cm">=&gt;</span> <span class="i">$file</span><span class="cm">,</span></li><li>             <span class="w">callbacks</span> <span class="cm">=&gt;</span> \<span class="i">%callbacks</span><span class="cm">,</span></li><li>         <span class="s">}</span></li><li>     <span class="s">)</span><span class="sc">;</span></li><li>     <span class="i">$parser</span><span class="i">-&gt;run</span><span class="sc">;</span></li><li>     <span class="i">$aggregator</span><span class="i">-&gt;add</span><span class="s">(</span> <span class="i">$file</span><span class="cm">,</span> <span class="i">$parser</span> <span class="s">)</span><span class="sc">;</span></li><li> <span class="s">}</span></li></ol></pre><p>Callbacks may also be added like this:</p>
<pre class="verbatim"><ol><li> <span class="i">$parser</span><span class="i">-&gt;callback</span><span class="s">(</span> <span class="w">test</span> <span class="cm">=&gt;</span> \<span class="i">&amp;test_callback</span> <span class="s">)</span><span class="sc">;</span></li><li> <span class="i">$parser</span><span class="i">-&gt;callback</span><span class="s">(</span> <span class="w">plan</span> <span class="cm">=&gt;</span> \<span class="i">&amp;plan_callback</span> <span class="s">)</span><span class="sc">;</span></li></ol></pre><p>The following keys allowed for callbacks. These keys are case-sensitive.</p>
<ul>
<li><a name="*-test"></a><b><code class="inline"><span class="w">test</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_test</span></code>
 returns true.</p>
</li>
<li><a name="*-version"></a><b><code class="inline"><span class="w">version</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_version</span></code>
 returns true.</p>
</li>
<li><a name="*-plan"></a><b><code class="inline"><span class="w">plan</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_plan</span></code>
 returns true.</p>
</li>
<li><a name="*-comment"></a><b><code class="inline"><span class="w">comment</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_comment</span></code>
 returns true.</p>
</li>
<li><a name="*-bailout"></a><b><code class="inline"><span class="w">bailout</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_unknown</span></code>
 returns true.</p>
</li>
<li><a name="*-yaml"></a><b><code class="inline"><span class="w">yaml</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_yaml</span></code>
 returns true.</p>
</li>
<li><a name="*-unknown"></a><b><code class="inline"><span class="w">unknown</span></code>
</b>
<p>Invoked if <code class="inline"><span class="i">$result</span><span class="i">-&gt;is_unknown</span></code>
 returns true.</p>
</li>
<li><a name="*-ELSE"></a><b><code class="inline"><span class="w">ELSE</span></code>
</b>
<p>If a result does not have a callback defined for it, this callback will
be invoked. Thus, if all of the previous result types are specified as
callbacks, this callback will <i>never</i> be invoked.</p>
</li>
<li><a name="*-ALL"></a><b><code class="inline"><span class="w">ALL</span></code>
</b>
<p>This callback will always be invoked and this will happen for each
result after one of the above callbacks is invoked.  For example, if
<a href="../Term/ANSIColor.html">Term::ANSIColor</a> is loaded, you could use the following to color your
test output:</p>
<pre class="verbatim"><ol><li> <a class="l_k" href="../functions/my.html">my</a> <span class="i">%callbacks</span> = <span class="s">(</span></li><li>     <span class="w">test</span> <span class="cm">=&gt;</span> <a class="l_k" href="../functions/sub.html">sub</a> <span class="s">{</span></li><li>         <a class="l_k" href="../functions/my.html">my</a> <span class="i">$test</span> = <a class="l_k" href="../functions/shift.html">shift</a><span class="sc">;</span></li><li>         if <span class="s">(</span> <span class="i">$test</span><span class="i">-&gt;is_ok</span> &amp;&amp; not <span class="i">$test</span><span class="i">-&gt;directive</span> <span class="s">)</span> <span class="s">{</span></li><li>             <span class="c"># normal passing test</span></li><li>             <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;green&#39;</span><span class="sc">;</span></li><li>         <span class="s">}</span></li><li>         elsif <span class="s">(</span> !<span class="i">$test</span><span class="i">-&gt;is_ok</span> <span class="s">)</span> <span class="s">{</span>    <span class="c"># even if it&#39;s TODO</span></li><li>             <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;white on_red&#39;</span><span class="sc">;</span></li><li>         <span class="s">}</span></li><li>         elsif <span class="s">(</span> <span class="i">$test</span><span class="i">-&gt;has_skip</span> <span class="s">)</span> <span class="s">{</span></li><li>             <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;white on_blue&#39;</span><span class="sc">;</span></li><li></li><li>         <span class="s">}</span></li><li>         elsif <span class="s">(</span> <span class="i">$test</span><span class="i">-&gt;has_todo</span> <span class="s">)</span> <span class="s">{</span></li><li>             <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;white&#39;</span><span class="sc">;</span></li><li>         <span class="s">}</span></li><li>     <span class="s">}</span><span class="cm">,</span></li><li>     <span class="w">ELSE</span> <span class="cm">=&gt;</span> <a class="l_k" href="../functions/sub.html">sub</a> <span class="s">{</span></li><li>         <span class="c"># plan, comment, and so on (anything which isn&#39;t a test line)</span></li><li>         <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;black on_white&#39;</span><span class="sc">;</span></li><li>     <span class="s">}</span><span class="cm">,</span></li><li>     <span class="w">ALL</span> <span class="cm">=&gt;</span> <a class="l_k" href="../functions/sub.html">sub</a> <span class="s">{</span></li><li>         <span class="c"># now print them</span></li><li>         <a class="l_k" href="../functions/print.html">print</a> <a class="l_k" href="../functions/shift.html">shift</a><span class="i">-&gt;as_string</span><span class="sc">;</span></li><li>         <a class="l_k" href="../functions/print.html">print</a> <span class="i">color</span> <span class="q">&#39;reset&#39;</span><span class="sc">;</span></li><li>         <a class="l_k" href="../functions/print.html">print</a> <span class="q">&quot;\n&quot;</span><span class="sc">;</span></li><li>     <span class="s">}</span><span class="cm">,</span></li><li> <span class="s">)</span><span class="sc">;</span></li></ol></pre></li>
<li><a name="*-EOF"></a><b><code class="inline"><span class="w">EOF</span></code>
</b>
<p>Invoked when there are no more lines to be parsed. Since there is no
accompanying <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a> object the <code class="inline"><span class="w">TAP::Parser</span></code>
 object is
passed instead.</p>
</li>
</ul>
<a name="TAP-GRAMMAR"></a><h1>TAP GRAMMAR</h1>
<p>If you're looking for an EBNF grammar, see <a href="../TAP/Parser/Grammar.html">TAP::Parser::Grammar</a>.</p>
<a name="BACKWARDS-COMPATIBILITY"></a><h1>BACKWARDS COMPATIBILITY</h1>
<p>The Perl-QA list attempted to ensure backwards compatibility with
<a href="../Test/Harness.html">Test::Harness</a>.  However, there are some minor differences.</p>
<a name="Differences"></a><h2>Differences</h2>
<ul>
<li><a name="*-TODO-plans"></a><b>TODO plans</b>
<p>A little-known feature of <a href="../Test/Harness.html">Test::Harness</a> is that it supported TODO
lists in the plan:</p>
<pre class="verbatim"><ol><li> 1..2 todo 2</li><li> ok 1 - We have liftoff</li><li> not ok 2 - Anti-gravity device activated</li></ol></pre><p>Under <a href="../Test/Harness.html">Test::Harness</a>, test number 2 would <i>pass</i> because it was
listed as a TODO test on the plan line. However, we are not aware of
anyone actually using this feature and hard-coding test numbers is
discouraged because it's very easy to add a test and break the test
number sequence. This makes test suites very fragile. Instead, the
following should be used:</p>
<pre class="verbatim"><ol><li> 1..2</li><li> ok 1 - We have liftoff</li><li> not ok 2 - Anti-gravity device activated # TODO</li></ol></pre></li>
<li><a name="*-'Missing'-tests"></a><b>'Missing' tests</b>
<p>It rarely happens, but sometimes a harness might encounter
'missing tests:</p>
<pre class="verbatim"><ol><li> ok 1</li><li> ok 2</li><li> ok 15</li><li> ok 16</li><li> ok 17</li></ol></pre><p><a href="../Test/Harness.html">Test::Harness</a> would report tests 3-14 as having failed. For the
<code class="inline"><span class="w">TAP::Parser</span></code>
, these tests are not considered failed because they've
never run. They're reported as parse failures (tests out of sequence).</p>
</li>
</ul>
<a name="SUBCLASSING"></a><h1>SUBCLASSING</h1>
<p>If you find you need to provide custom functionality (as you would have using
<a href="http://search.cpan.org/perldoc/Test::Harness::Straps">Test::Harness::Straps</a>), you're in luck: <code class="inline"><span class="w">TAP::Parser</span></code>
 and friends are
designed to be easily plugged-into and/or subclassed.</p>
<p>Before you start, it's important to know a few things:</p>
<dl>
<dt>1</dt><dd>
<p>All <code class="inline"><span class="w">TAP::</span>*</code>
 objects inherit from <a href="../TAP/Object.html">TAP::Object</a>.</p>
</dd>
<dt>2</dt><dd>
<p>Many <code class="inline"><span class="w">TAP::</span>*</code>
 classes have a <i>SUBCLASSING</i> section to guide you.</p>
</dd>
<dt>3</dt><dd>
<p>Note that <code class="inline"><span class="w">TAP::Parser</span></code>
 is designed to be the central "maker" - ie: it is
responsible for creating most new objects in the <code class="inline"><span class="w">TAP::Parser::</span>*</code>
 namespace.</p>
<p>This makes it possible for you to have a single point of configuring what
subclasses should be used, which means that in many cases you'll find
you only need to sub-class one of the parser's components.</p>
<p>The exception to this rule are <i>SourceHandlers</i> &amp; <i>Iterators</i>, but those are
both created with customizable <i>IteratorFactory</i>.</p>
</dd>
<dt>4</dt><dd>
<p>By subclassing, you may end up overriding undocumented methods.  That's not
a bad thing per se, but be forewarned that undocumented methods may change
without warning from one release to the next - we cannot guarantee backwards
compatibility.  If any <i>documented</i> method needs changing, it will be
deprecated first, and changed in a later release.</p>
</dd>
</dl>
<a name="Parser-Components"></a><h2>Parser Components</h2>
<a name="Sources"></a><h3>Sources</h3>
<p>A TAP parser consumes input from a single <i>raw source</i> of TAP, which could come
from anywhere (a file, an executable, a database, an IO handle, a URI, etc..).
The source gets bundled up in a <a href="../TAP/Parser/Source.html">TAP::Parser::Source</a> object which gathers some
meta data about it.  The parser then uses a <a href="../TAP/Parser/IteratorFactory.html">TAP::Parser::IteratorFactory</a> to
determine which <a href="../TAP/Parser/SourceHandler.html">TAP::Parser::SourceHandler</a> to use to turn the raw source
into a stream of TAP by way of <a href="#Iterators">Iterators</a>.</p>
<p>If you simply want <code class="inline"><span class="w">TAP::Parser</span></code>
 to handle a new source of TAP you probably
don't need to subclass <code class="inline"><span class="w">TAP::Parser</span></code>
 itself.  Rather, you'll need to create a
new <a href="../TAP/Parser/SourceHandler.html">TAP::Parser::SourceHandler</a> class, and just plug it into the parser using
the <i>sources</i> param to <a href="#new">new</a>.  Before you start writing one, read through
<a href="../TAP/Parser/IteratorFactory.html">TAP::Parser::IteratorFactory</a> to get a feel for how the system works first.</p>
<p>If you find you really need to use your own iterator factory you can still do
so without sub-classing <code class="inline"><span class="w">TAP::Parser</span></code>
 by setting <a href="#iterator_factory_class">iterator_factory_class</a>.</p>
<p>If you just need to customize the objects on creation, subclass <a href="../TAP/Parser.html">TAP::Parser</a>
and override <a href="#make_iterator_factory">make_iterator_factory</a>.</p>
<p>Note that <code class="inline"><span class="w">make_source</span></code>
 &amp; <code class="inline"><span class="w">make_perl_source</span></code>
 have been <i>DEPRECATED</i> and
are now removed.</p>
<a name="Iterators"></a><h3>Iterators</h3>
<p>A TAP parser uses <i>iterators</i> to loop through the <i>stream</i> of TAP read in
from the <i>source</i> it was given.  There are a few types of Iterators available
by default, all sub-classes of <a href="../TAP/Parser/Iterator.html">TAP::Parser::Iterator</a>.  Choosing which
iterator to use is the responsibility of the <i>iterator factory</i>, though it
simply delegates to the <i>Source Handler</i> it uses.</p>
<p>If you're writing your own <a href="../TAP/Parser/SourceHandler.html">TAP::Parser::SourceHandler</a>, you may need to
create your own iterators too.  If so you'll need to subclass
<a href="../TAP/Parser/Iterator.html">TAP::Parser::Iterator</a>.</p>
<p>Note that <a href="#make_iterator">make_iterator</a> has been <i>DEPRECATED</i> and is now removed.</p>
<a name="Results"></a><h3>Results</h3>
<p>A TAP parser creates <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a>s as it iterates through the
input <i>stream</i>.  There are quite a few result types available; choosing
which class to use is the responsibility of the <i>result factory</i>.</p>
<p>To create your own result types you have two options:</p>
<ul>
<li><a name="option-1"></a><b>option 1</b>
<p>Subclass <a href="../TAP/Parser/Result.html">TAP::Parser::Result</a> and register your new result type/class with
the default <a href="../TAP/Parser/ResultFactory.html">TAP::Parser::ResultFactory</a>.</p>
</li>
<li><a name="option-2"></a><b>option 2</b>
<p>Subclass <a href="../TAP/Parser/ResultFactory.html">TAP::Parser::ResultFactory</a> itself and implement your own
<a href="../TAP/Parser/Result.html">TAP::Parser::Result</a> creation logic.  Then you'll need to customize the
class used by your parser by setting the <code class="inline"><span class="w">result_factory_class</span></code>
 parameter.
See <a href="#new">new</a> for more details.</p>
</li>
</ul>
<p>If you need to customize the objects on creation, subclass <a href="../TAP/Parser.html">TAP::Parser</a> and
override <a href="#make_result">make_result</a>.</p>
<a name="Grammar"></a><h3>Grammar</h3>
<p><a href="../TAP/Parser/Grammar.html">TAP::Parser::Grammar</a> is the heart of the parser.  It tokenizes the TAP
input <i>stream</i> and produces results.  If you need to customize its behaviour
you should probably familiarize yourself with the source first.  Enough
lecturing.</p>
<p>Subclass <a href="../TAP/Parser/Grammar.html">TAP::Parser::Grammar</a> and customize your parser by setting the
<code class="inline"><span class="w">grammar_class</span></code>
 parameter.  See <a href="#new">new</a> for more details.</p>
<p>If you need to customize the objects on creation, subclass <a href="../TAP/Parser.html">TAP::Parser</a> and
override <a href="#make_grammar">make_grammar</a></p>
<a name="ACKNOWLEDGMENTS"></a><h1>ACKNOWLEDGMENTS</h1>
<p>All of the following have helped. Bug reports, patches, (im)moral
support, or just words of encouragement have all been forthcoming.</p>
<ul>
<li><a name="*-Michael-Schwern"></a><b>Michael Schwern</b>
</li>
<li><a name="*-Andy-Lester"></a><b>Andy Lester</b>
</li>
<li><a name="*-chromatic"></a><b>chromatic</b>
</li>
<li><a name="*-GEOFFR"></a><b>GEOFFR</b>
</li>
<li><a name="*-Shlomi-Fish"></a><b>Shlomi Fish</b>
</li>
<li><a name="*-Torsten-Schoenfeld"></a><b>Torsten Schoenfeld</b>
</li>
<li><a name="*-Jerry-Gay"></a><b>Jerry Gay</b>
</li>
<li><a name="*-Aristotle"></a><b>Aristotle</b>
</li>
<li><a name="*-Adam-Kennedy"></a><b>Adam Kennedy</b>
</li>
<li><a name="*-Yves-Orton"></a><b>Yves Orton</b>
</li>
<li><a name="*-Adrian-Howard"></a><b>Adrian Howard</b>
</li>
<li><a name="*-Sean-%26-Lil"></a><b>Sean &amp; Lil</b>
</li>
<li><a name="*-Andreas-J.-Koenig"></a><b>Andreas J. Koenig</b>
</li>
<li><a name="*-Florian-Ragwitz"></a><b>Florian Ragwitz</b>
</li>
<li><a name="*-Corion"></a><b>Corion</b>
</li>
<li><a name="*-Mark-Stosberg"></a><b>Mark Stosberg</b>
</li>
<li><a name="*-Matt-Kraai"></a><b>Matt Kraai</b>
</li>
<li><a name="*-David-Wheeler"></a><b>David Wheeler</b>
</li>
<li><a name="*-Alex-Vandiver"></a><b>Alex Vandiver</b>
</li>
<li><a name="*-Cosimo-Streppone"></a><b>Cosimo Streppone</b>
</li>
<li><a name="*-Ville-Skytt&#xe4;"></a><b>Ville Skytt&#xe4;</b>
</li>
</ul>
<a name="AUTHORS"></a><h1>AUTHORS</h1>
<p>Curtis "Ovid" Poe &lt;ovid@cpan.org&gt;</p>
<p>Andy Armstong &lt;andy@hexten.net&gt;</p>
<p>Eric Wilhelm @ &lt;ewilhelm at cpan dot org&gt;</p>
<p>Michael Peters &lt;mpeters at plusthree dot com&gt;</p>
<p>Leif Eriksen &lt;leif dot eriksen at bigpond dot com&gt;</p>
<p>Steve Purkis &lt;spurkis@cpan.org&gt;</p>
<p>Nicholas Clark &lt;nick@ccl4.org&gt;</p>
<p>Lee Johnson &lt;notfadeaway at btinternet dot com&gt;</p>
<p>Philippe Bruhat &lt;book@cpan.org&gt;</p>
<a name="BUGS"></a><h1>BUGS</h1>
<p>Please report any bugs or feature requests to
<code class="inline"><span class="w">bug</span>-<span class="w">test</span>-<span class="w">harness</span><span class="i">@rt</span>.<span class="w">cpan</span>.<span class="w">org</span></code>
, or through the web interface at
<a href="http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Test-Harness">http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Test-Harness</a>.
We will be notified, and then you'll automatically be notified of
progress on your bug as we make changes.</p>
<p>Obviously, bugs which include patches are best. If you prefer, you can
patch against bleed by via anonymous checkout of the latest version:</p>
<pre class="verbatim"><ol><li> <span class="w">git</span> <span class="w">clone</span> <span class="w">git</span><span class="co">:</span><span class="q">//github</span>.<span class="w">com</span>/<span class="w">Perl</span>-<span class="w">Toolchain</span>-<span class="w">Gang</span>/<span class="w">Test</span>-<span class="w">Harness</span>.<span class="w">git</span></li></ol></pre><a name="COPYRIGHT-%26-LICENSE"></a><h1>COPYRIGHT &amp; LICENSE</h1>
<p>Copyright 2006-2008 Curtis "Ovid" Poe, all rights reserved.</p>
<p>This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>




  <div id="page_index" class="hud_container">
    <div id="page_index_header" class="hud_header">
      <div id="page_index_close" class="hud_close"><a href="#" onClick="pageIndex.hide();return false;"></a></div>
      <div id="page_index_title" class="hud_title"><span class="hud_span_top">Page index</span></div>
      <div id="page_index_topright" class="hud_topright"></div>
    </div>
    <div id="page_index_content" class="hud_content">
      <ul><li><a href="#NAME">NAME</a><li><a href="#VERSION">VERSION</a><li><a href="#SYNOPSIS">SYNOPSIS</a><li><a href="#DESCRIPTION">DESCRIPTION</a><li><a href="#METHODS">METHODS</a><ul><li><a href="#Class-Methods">Class Methods</a><li><a href="#Instance-Methods">Instance Methods</a></ul><li><a href="#INDIVIDUAL-RESULTS">INDIVIDUAL RESULTS</a><ul><li><a href="#Result-types">Result types</a><li><a href="#Common-type-methods">Common type methods</a><li><a href="#plan-methods">plan methods</a><li><a href="#pragma-methods">pragma methods</a><li><a href="#comment-methods">comment methods</a><li><a href="#bailout-methods">bailout methods</a><li><a href="#unknown-methods">unknown methods</a><li><a href="#test-methods">test methods</a></ul><li><a href="#TOTAL-RESULTS">TOTAL RESULTS</a><ul><li><a href="#Individual-Results">Individual Results</a><li><a href="#Pragmas">Pragmas</a><li><a href="#Summary-Results">Summary Results</a><li><a href="#ignore_exit">ignore_exit</a></ul><li><a href="#CALLBACKS">CALLBACKS</a><li><a href="#TAP-GRAMMAR">TAP GRAMMAR</a><li><a href="#BACKWARDS-COMPATIBILITY">BACKWARDS COMPATIBILITY</a><ul><li><a href="#Differences">Differences</a></ul><li><a href="#SUBCLASSING">SUBCLASSING</a><ul><li><a href="#Parser-Components">Parser Components</a></ul><li><a href="#ACKNOWLEDGMENTS">ACKNOWLEDGMENTS</a><li><a href="#AUTHORS">AUTHORS</a><li><a href="#BUGS">BUGS</a><li><a href="#COPYRIGHT-%26-LICENSE">COPYRIGHT & LICENSE</a></ul>
    </div>
    <div id="page_index_footer" class="hud_footer">
      <div id="page_index_bottomleft" class="hud_bottomleft"></div>
      <div id="page_index_bottom" class="hud_bottom"><span class="hud_span_bottom"></span></div>
      <div id="page_index_resize" class="hud_resize"></div>
    </div>
  </div>


	    &nbsp;
          </div>
          <div id="content_footer">
          </div>
        </div>
        <div class="clear"></div>
      </div>
      
    <div id="footer">
      <div id="footer_content">
        <div id="footer_strapline">
          perldoc.perl.org - Official documentation for the Perl programming language
        </div>
        <div id="footer_links">
          <div id="address">
            <p class="name">Contact details</p>
            <p class="address">
	      Site maintained by <a href="mailto:jj@jonallen.info">Jon Allen (JJ)</a><br>
	    </p>
            <p class="contact">
              Documentation maintained by the <a href="http://lists.cpan.org/showlist.cgi?name=perl5-porters">Perl 5 Porters</a>
            </p>
          </div>
          <ul class="f1">
            <li>Manual
              <ul class="f2">
                <li><a href="../index-overview.html">Overview</a>
                <li><a href="../index-tutorials.html">Tutorials</a>
                <li><a href="../index-faq.html">FAQs</a>
                <li><a href="../index-history.html">Changes</a>
              </ul>
            <li>Reference
              <ul class="f2">
                <li><a href="../index-language.html">Language</a>
                <li><a href="../index-functions.html">Functions</a>
                <li><a href="../perlop.html">Operators</a>
                <li><a href="../perlvar.html">Variables</a>
              </ul>
            <li>Modules
              <ul class="f2">
                <li><a href="../index-modules-A.html">Modules</a>
                <li><a href="../index-pragmas.html">Pragmas</a>
                <li><a href="../index-utilities.html">Utilities</a>
              </ul>
            <li>Misc
              <ul class="f2">
                <li><a href="../index-licence.html">License</a>
                <li><a href="../index-internals.html">Internals</a>
                <li><a href="../index-platforms.html">Platforms</a>
              </ul>          </ul>
          <div class="clear"></div>
        </div>
      </div>
      <div id="footer_end">
      </div>
    </div>
      
    </div>
      <script language="JavaScript" type="text/javascript" src="../static/exploreperl.js"></script>
      <script language="JavaScript" src="../static/combined-20100403.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
  perldoc.setPath(1);
  perldoc.pageName    = 'TAP::Parser';
  perldoc.pageAddress = 'TAP/Parser.html';
  perldoc.contentPage = 1;
  explorePerl.render();
  explorePerl.addEvents('explore_anchor');
</script>
    
  </body>
</html>
