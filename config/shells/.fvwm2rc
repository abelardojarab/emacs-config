# .fvwm/.fvwm2rc

SetEnv fvwm_wallpaper $[HOME]/Downloads/Wallpapers/1468177.png

# Viewport and Virtual Desktop Setup
DeskTopSize 4x4
EdgeScroll 0 0
EwmhBaseStruts 0 128 0 20
OpaqueMoveSize -1
TitleStyle Height 13
WindowFont -misc-fixed-medium-r-normal-*-10-*-*-*-*-*-iso10646-1

# Transient Windows
# By default FVWM will not put any decorations (borders) around transient
# popup windows (such as FileChooser dialogs).  It is useful to have such
# decorations, as without them you cannot grab the window to move it
# (sometimes a dialog window pops up in the wrong place and you do want
# to move it).  See http://fvwm.org/doc/unstable/commands/Style.html

# These set the colors for my FvwmScript-DayDate script.
# For reasons I don't understand, setting ForeColor and BackColor in the
# widgets in the script itself doesn't work.
*FvwmScript: DefaultFore blue
*FvwmScript: DefaultBack black

# Note: FvwmPager will be swallowed by FvwmButtons (below)
*FvwmPager: Fore blue
*FvwmPager: Back black
*FvwmPager: Hilight gray
*FvwmPager: SolidSeparators
*FvwmPager: Label 0 "0: General"
*FvwmPager: Label 1 "1: Graphein"
*FvwmPager: Label 2 "2: OpenSCAD"
*FvwmPager: Label 3 "3: other"

# See: http://www.fvwm.org/documentation/manpages/unstable/fvwm.php
AddToFunc StartFunction
+ I FvwmButtons
+ I FvwmTaskBar
+ I FvwmAuto FvwmAutohide -menter FuncAutoEnter
+ I Test (Init) Exec exec fvwm-root --dither --retain-pixmap $[fvwm_wallpaper]
+ I Test (Init) StartHiddenConsole

# Window Decor
DestroyDecor MyDecor
AddToDecor   MyDecor
+ TitleStyle LeftJustified Height 14
+ ButtonStyle 1 ActiveUp Vector 4 30x30@3 60x60@3 60x30@4 30x60@3 -- Flat
+ ButtonStyle 1 ActiveDown Vector 4 30x30@3 60x60@3 60x30@4 30x60@3 -- Flat
+ ButtonStyle 1 Inactive Vector 4 30x30@3 60x60@3 60x30@4 30x60@3 -- Flat
+ ButtonStyle 4 ActiveUp Vector 5 30x60@3 60x60@3 60x50@3 30x50@3 30x60@3 -- Flat
+ ButtonStyle 4 ActiveDown Vector 5 30x60@3 60x60@3 60x50@3 30x50@3 30x60@3 -- Flat
+ ButtonStyle 4 Inactive Vector 5 30x60@3 60x60@3 60x50@3 30x50@3 30x60@3 -- Flat
+ ButtonStyle 2 ActiveUp Vector 7 30x30@3 30x60@3 60x60@3 60x30@3 30x30@3 30x35@3 60x35@3 -- Flat
+ ButtonStyle 2 ActiveDown Vector 7 30x30@3 30x60@3 60x60@3 60x30@3 30x30@3 30x35@3 60x35@3 -- Flat
+ ButtonStyle 2 Inactive Vector 7 30x30@3 30x60@3 60x60@3 60x30@3 30x30@3 30x35@3 60x35@3 -- Flat
+ TitleStyle -- Flat
+ BorderStyle Simple -- NoInset Flat
+ ButtonStyle All -- UseTitleStyle

#styles
Style "*" Icon xlogo32, BorderWidth 2, SloppyFocus
Style "*" DecorateTransient, IconBox -132 110 -8 -8
Style FvwmButtons NeverFocus, NoHandles, NoTitle, StaysOnTop, Sticky
Style FvwmPager NeverFocus, NoHandles, NoTitle, StaysOnTop, Sticky
Style "*" UseDecor MyDecor
Style "*" BorderWidth 0, HandleWidth 2
Style "*" MWMBorder, FirmBorder
Style "*" DecorateTransient
Style "*" SnapAttraction 3
Style FvwmTaskBar NoTitle, WindowListSkip, CirculateSkip, Sticky, BorderWidth 0, NoHandles, StaysOnBottom
Style FvwmTaskBar NeverFocus, Layer 0

# Set up the geometry so that the buttons stack vertically on the left.
*FvwmButtonsFont -adobe-helvetica-bold-r-*-*-10-*
*FvwmButtons: ButtonGeometry 100x50+0+0
*FvwmButtonsFore blick
*FvwmButtons: BoxSize fixed
*FvwmButtons: Rows 8
*FvwmButtons: Columns 1
*FvwmButtons: Frame 1
*FvwmButtons: (1x2+0+0, Swallow "FvwmPager" 'FvwmPager *')
*FvwmButtons(Title XTerm, Icon xterm.xpm, Action 'Exec "xterm" xterm -ls &')
*FvwmButtons(Title Emacs, Icon emacs.xpm, Action 'Exec "Emacs Server" emacs &')
*FvwmButtons(Title Emacs Client, Icon emacs.xpm, Action 'Exec "Emacs Client" emacsclient --server-file ~/.emacs.cache/server/server -c &')
*FvwmButtons(Title Glade, Icon glade.xpm, Action 'Exec "Glade" glade-3 &')
# *FvwmButtons: (1x2+0+2, Back #dedbde, Frame 1, Action (Mouse 1) `Nop`)
# *FvwmButtons: (Id AnalogDial, 1x2+0+4, Swallow (NoClose, UseOld) "xclock" 'Exec xclock &')

# Key Bindings: ctrl-arrow shifts viewports, alt-arrow shifts desktops
#               A = All contexts
#               M = meta = alt key
#               C = control key
# Do not wrap viewports.  Do wrap desktops.

Key Left  A C GotoPage -1p +0p
Key Right A C GotoPage +1p +0p
Key Up    A C GotoPage +0p -1p
Key Down  A C GotoPage +0p +1p
Key Left  A M GotoDesk -1 0 3
Key Right A M GotoDesk 1 0 3

# AutoHiding Console
Style HiddenConsole Sticky, WindowListSkip, Notitle, StaysOnTop, NoHandles
Style HiddenConsole WindowShadeSteps 100

DestroyMenu GraphicsCADSubMenu
AddToMenu GraphicsCADSubMenu "Graphics/CAD" Title
+ "dia"   Exec exec dia
+ "Glade"   Exec exec glade-3

DestroyMenu NetSubMenu
AddToMenu NetSubMenu "Net" Title
+ "firefox"  Exec exec firefox

DestroyMenu OfficeTextSubMenu
AddToMenu OfficeTextSubMenu "Office/Text" Title
+ "Emacs Client"  Exec exec emacsclient
+ "Emacs Server"  Exec exec emacs
+ "LibreOffice"  Exec exec soffice

# Fvwm ships with a hardcoded "Builtin" menu linked to mouse button 0.
# Replace Mouse Button 0 with my main ("start button") menu.
Mouse 0 R N Menu MainMenu

AddToMenu MainMenu "Main Menu" Title
+ "xterm" Exec exec xterm -fg green -bg black -vb
+ "Net" Popup NetSubMenu
+ "Graphics/CAD" Popup GraphicsCADSubMenu
+ "Office/Text" Popup OfficeTextSubMenu
+ "" Nop
+ "RestartFvwm" Restart
+ "Quit Fvwm" Quit

# FvwmIdent is an xwininfo replacement.
DestroyModuleConfig FvwmIdent: *
*FvwmIdent: Back MidnightBlue
*FvwmIdent: Fore #f6f6f6
*FvwmIdent: Font "xft:snap"

# FvwmScroll swallows applications into smaller containers.
DestroyModuleConfig FvwmScroll: *
*FvwmScroll: Back #f6f6f6
*FvwmScroll: Fore #f6f6f6

DestroyFunc Thumbnail
AddToFunc Thumbnail
+ I Raise
+ I SetEnv Icon-$[w.id] $[w.iconfile]
+ I ThisWindow (!Shaded Iconifiable !Iconic) PipeRead \
    "xwd -silent -id $[w.id] | convert -scale $$(($[w.width]/5)) -frame 1x1 \
    -mattecolor black -quality 0 xwd:- png:$[fvwm_tmp]/icon.tmp.$[w.id].png \
    && echo Nop"
+ I TestRc (Match) Test (f $[fvwm_icon]/$[w.iconfile], f $[fvwm_tmp]/icon.tmp.$[w.id].png) \
    PipeRead "composite -geometry +2+4 \
    $[fvwm_icon]/$[w.iconfile] $[fvwm_tmp]/icon.tmp.$[w.id].png \
    $[fvwm_tmp]/icon.tmp.$[w.id].png && \
    echo WindowStyle IconOverride, Icon $[fvwm_tmp]/icon.tmp.$[w.id].png || echo Nop"
+ I TestRc (NoMatch) WindowStyle IconOverride, Icon $[fvwm_tmp]/icon.tmp.$[w.id].png
+ I Iconify

DestroyFunc DeThumbnail
AddToFunc DeThumbnail
+ I PipeRead "echo WindowStyle Icon \\$\\[Icon-$[w.id]\\]"
+ I UnsetEnv Icon-$[w.id]
+ I Exec rm -f $[fvwm_tmp]/icon.tmp.$[w.id].png

# FvwmEvent
DestroyModuleConfig FvwmEvent: *
*FvwmEvent: deiconify DeThumbnail

DestroyFunc ReThumbnail
AddToFunc   ReThumbnail
+ I Iconify
+ I Thumbnail

# FvwmExpose
DestroyFunc FvwmExpose
AddToFunc FvwmExpose
+ I AddToMenu FvwmExposeMenu "e x p o s e" Title
+ I + DynamicPopDownAction DestroyMenu FvwmExposeMenu
+ I All (!Iconic !Shaded AcceptsFocus)\
    PipeRead "echo Raise; \
        xwd -silent -id $[w.id] | convert -scale $$(($[w.width]/10)) -quality 0 xwd:- \
        png:$[fvwm_home]/tmp/icon.exp.$[w.id].png \
    && echo AddToMenu FvwmExposeMenu \
    %$[fvwm_home]/tmp/icon.exp.$[w.id].png%\\\'\"$[w.name]\"\\\' WindowID $[w.id] WarpToWindow 50 50 \
        && echo AddToMenu FvwmExposeMenu \\\"\\\" Nop \
    || Nop"
+ I Popup FvwmExposeMenu
+ I Exec exec rm -f $[fvwm_home]/tmp/icon.exp.*

# Screenshot Functions (uses ImageMagick)
DestroyFunc FvwmWindowScreenshot
AddToFunc   FvwmWindowScreenshot
+ I ThisWindow (!Shaded !Iconic Iconifiable) \
  Exec import -window $[w.id] -quality 100 -silent \
  "$[fvwm_home]/screenshot/screenshot-`date +%F[%R]`.$[w.id].jpg"

DestroyFunc FvwmDesktopScreenshot
AddToFunc   FvwmDesktopScreenshot
+ I Exec sleep $0; import -window root -quality 100 -silent \
  "$[fvwm_home]/screenshot/screenshot-`date +%F[%R]`.jpg"

# Autohide console example: [4]http://dev.gentoo.org/~taviso/autohide_console.png
DestroyFunc StartHiddenConsole
AddToFunc StartHiddenConsole
+ I Exec exec rxvt +sb -geometry 144x8+2+0 -name HiddenConsole
+ I Wait HiddenConsole
+ I Autohide HiddenConsole 250 0 N

# These functions modified from the functions provided in the fvwm FAQ.
# [8]http://www.fvwm.org/documentation/faq/#7.17
AddToFunc Autohide
+ I ThisWindow ($0) Deschedule $[w.id]
+ I TestRc (!Match) Deschedule -$[w.id]
+ I ThisWindow ($0) ThisWindow (shaded) AutohideShow $1 $3
+ I TestRc (!Match) All ($0, !shaded) AutohideHide $2 $3

AddToFunc AutohideShow
+ I Schedule $0 -$[w.id] WindowShade $1 off
+ I Schedule $0 -$[w.id] Raise
+ I Schedule $0 -$[w.id] Deschedule $[w.id]
+ I Schedule $0 -$[w.id] Deschedule -$[w.id]

AddToFunc AutohideHide
+ I Schedule $0 $[w.id] WindowShade $1 on
+ I Schedule $0 $[w.id] Deschedule $[w.id]
+ I Schedule $0 $[w.id] Deschedule -$[w.id]

AddToFunc WindowListFunc I WarpToWindow 50 50
DestroyFunc FuncAutoEnter
AddToFunc FuncAutoEnter I Autohide HiddenConsole 250 500 N

# Window Operation Menu
DestroyMenu Window-Ops
AddToMenu Window-Ops "Window Operations" Title
+ "Move%menu/window-move.xpm%"  Move
+ "Resize%menu/window-resize.xpm%"  Resize
+ "(De)Iconify%menu/window-iconify.xpm%"  Iconify
+ "(Un)Maximize%menu/window-maximize.xpm%"  Maximize
+ "(Un)Shade%menu/window-shade.xpm%"  WindowShade
+ "(Un)Stick%menu/window-stick.xpm%"  Stick
+ "" Nop
+ "Close%menu/window-close.xpm%"  Close
+ "Delete%menu/window-delete.xpm%"  Delete
+ "Destroy%menu/window-destroy.xpm%"  Destroy
+ "" Nop
+ "StaysOnTop%menu/window-raise.xpm%"  Pick (CirculateHit) Layer 0 6
+ "Layer +1%menu/window-raise.xpm%"  Pick (CirculateHit) Layer +1
+ "StaysPut%menu/window.xpm%"  Pick (CirculateHit) Layer 0 4
+ "Layer -1%menu/window-lower.xpm%"  Pick (CirculateHit) Layer -1
+ "StaysOnBottom%menu/window-lower.xpm%"  Pick (CirculateHit) Layer 0 2
+ "" Nop
+ "%menu/window.xpm%Window Screenshot"  Pick (CirculateHit) FvwmWindowScreenshot
+ "%menu/display.xpm%Screenshot" FvwmDesktopScreenshot 5
+ "" Nop
+ "Identify%menu/window-identify.xpm%"  Module FvwmIdent

DestroyMenu MenuFvwmModules
AddToMenu MenuFvwmModules
+   "Animation          "   Module FvwmAnimate
+   "Button-Bar         "   Module FvwmButtons
+   "Identify           "   Module FvwmIdent
+   "IconMan            "   Module FvwmIconMan
+   "Banner             "   Module FvwmBanner
+   "Console            "   Module FvwmConsole -terminal rxvt
+   "Pager              "   Module FvwmPager 0 1
+   "Backer             "   Module FvwmBacker
+   "ScrollBar          "   Module FvwmScroll 50 50
+   "FvwmTaskBar        "   Module FvwmTaskBar
+   "AutoRaise          "   Module FvwmAuto 200 Raise Nop
+   "WinList            "   Module FvwmWinList
+   ""                      Nop
+   "Stop Module        "   Popup  MenuFvwmStopModule

DestroyMenu MenuFvwmStopModule
AddToMenu MenuFvwmStopModule
+   "Stop Button-Bar    "   KillModule FvwmButtons
+   "Stop IconMan       "   KillModule FvwmIconMan
+   "Stop Pager         "   KillModule FvwmPager
+   "Stop Backer        "   KillModule FvwmBacker
+   "Stop ScrollBar     "   KillModule FvwmScroll
+   "Stop FvwmTaskBar   "   KillModule FvwmTaskBar
+   "Stop AutoRaise     "   KillModule FvwmAuto
+   "Stop WinList       "   KillModule FvwmWinList

DestroyMenu MenuPageList
AddToMenu MenuPageList
+ "1"   Pick MoveToPage 0 0
+ "2"   Pick MoveToPage 1 0
+ "3"   Pick MoveToPage 2 0
+ "4"   Pick MoveToPage 0 1
+ "5"   Pick MoveToPage 1 1
+ "6"   Pick MoveToPage 2 1
+ "7"   Pick MoveToPage 0 2
+ "8"   Pick MoveToPage 1 2
+ "9"   Pick MoveToPage 2 2

DestroyFunc         TopHalfMix
AddToFunc           TopHalfMix
+ "I" Maximize          100 50

DestroyFunc                     LeftHalfMix
AddToFunc                       LeftHalfMix
+ "I" Maximize                  50 100

DestroyFunc         FullScreen
AddToFunc           FullScreen
+ "I" Maximize          100 100

# Valid Contexts...combinations of:
# R=root window
# W=application window
# T=titlebar
# S=side, top, or bottom bar
# F=frame (corners)
# I=icon window
#
# Valid Modifiers...any combination of:
# N=no modifiers
# C=control
# S=shift
# M=meta
# L=caps lock
# A=any modifier

# widows close,max,mini
Mouse 1 4   A       Iconify
Mouse 1 2   A       Maximize-func
Mouse 1 1   A       Menu Window-Ops Nop

# main pop-up menus
Mouse 0 R       A       Menu MainMenu Nop
Mouse 1 R       A       Menu MainMenu Nop
Mouse 2 R       A       Menu Other-Logins Nop
Mouse 3 R       A       Menu Utilities Nop

# title bar buttons
Mouse 0 1       A       Menu Window-Ops Nop
Mouse 0 2       A       Resize
Mouse 0 4       A       Iconify

# for when you click the edge of a window
Mouse 1 F   A   Resize-or-Raise
Mouse 1 TS  A   Move-or-Raise
Mouse 1 I   A   Move-or-Iconify
Mouse 2 I   A   Iconify
Mouse 2 FST A   Menu Window-Ops Nop
Mouse 3 TSIF    A   RaiseLower

# raise or lower window with alt-mousebutton1
Mouse 1 W   M   Move-or-Raise

# window move/resize
DestroyFunc drag-n-move
AddToFunc drag-n-move M move
DestroyFunc drag-n-resize
AddToFunc drag-n-resize M resize

Mouse 1 W HM drag-n-move
Mouse 3 W HM drag-n-resize

AddToFunc MailFunction     "I" Next [$0] Iconify -1
+              "I" Next [$0] focus
+              "I" None [$0] Exec $0 $1

AddToFunc Move-or-Raise     "I" Raise
+               "M" Move
+               "D" Lower

AddToFunc Move-or-Raise2    "M" Raise
+               "M" Move
+               "D" Lower

AddToFunc Maximize-Func     "M" Maximize     0 100
+               "C" Maximize     0 80
+               "D" Maximize     100 100

AddToFunc Move-or-Iconify   "I" Raise
+               "M" Move
+               "C" Iconify

AddToFunc Resize-or-Raise   "I" Raise
+               "M" Resize
+               "D" Lower

AddToFunc Resize-or-Raise2  "M" Raise
+               "M" Resize
+               "D" Lower

AddToFunc PrintFunction     "I" Raise
+               "I" Exec xdpr -id $w

AddToFunc Iconify-and-Raise     "I" Iconify
+                               "I" Raise

DestroyModuleConfig FvwmTaskBar: *
*FvwmTaskBar: Geometry +0-0
*FvwmTaskBar: Rows 1
*FvwmTaskBar: AutoStick
*FvwmTaskBar: UseSkipList
*FvwmTaskBar: PageOnly
*FvwmTaskBar: ShowTips
*FvwmTaskBar: NoDefaultStartButton
*FvwmTaskBar: NoBrightFocus
*FvwmTaskBar: 3DFvwm
*FvwmTaskBar: MailCheck 0
*FvwmTaskBar: IconColorset 11
*FvwmTaskBar: FocusColorset 11
*FvwmTaskBar: ClockFormat
*FvwmTaskBar: WindowButtonsRightMargin 124
